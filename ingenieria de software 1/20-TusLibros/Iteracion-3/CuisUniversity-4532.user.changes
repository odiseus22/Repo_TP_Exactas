

----QUIT----(9 March 2021 14:58:42) CuisUniversity-4532.image priorSource: 13044060!

----STARTUP---- (9 March 2021 14:58:43) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4532.image!


----QUIT----(9 March 2021 14:58:43) CuisUniversity-4532.image priorSource: 16885479!

----STARTUP---- (7 June 2021 20:20:50) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/TDDStateIcon-setBalloonText.st----!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/7/2021 20:31:04'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

TestCase subclass: #TestXXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #TestXXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/7/2021 20:31:20'!
TestCase subclass: #TestXXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classRenamed: #TestXXX as: #XXXTest stamp: 'G.L.S 6/7/2021 20:31:35'!
Smalltalk renameClassNamed: #TestXXX as: #XXXTest!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:31:50'!
test01! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:38:42' prior: 50859369!
test01

	| badRequest result sistema |
	sistema := XXX start.
	
	result := sistema request: ''.
	
	badRequest := 0.
	
	self assert: result equals: badRequest
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:40:10' prior: 50859372!
test01

	| badRequest result sistema |
	
	sistema := XXX start.
	
	result := sistema request: ''.
	
	badRequest := 400.
	
	self assert: result equals: badRequest
	! !

----QUIT----(7 June 2021 22:51:48) CuisUniversity-4532.image priorSource: 16885703!

----STARTUP---- (9 June 2021 17:05:28) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 17:14:22'!
Object subclass: #Carrito
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:14:28' prior: 50859380!
test01

	| carrito aPassword idCliente |
	
	idCliente := 0.
	aPassword := '1234'.
	
	carrito := Carrito forClient: idCliente withPassword: aPassword.
	
	self assert: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:25:44' prior: 50859401!
test01

	| carrito |
	
	carrito := Carrito createNew.
	
	self assert: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:33:25' prior: 50859410!
test01

	| carrito |
	
	carrito := Carrito createNew.
	
	self assert: carrito isEmpty.
	! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:33:28'!
ERROR!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 17:33:35'!
createNew
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeCreateNew! !
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 17:33:44' prior: 50859424!
createNew
	^self new initialize.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:33:45'!
ERROR!
!Carrito methodsFor: 'no messages' stamp: 'G.L.S 6/9/2021 17:33:55' overrides: 16896425!
initialize! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:34:10'!
ERROR!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:05'!
ERROR!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:36:17'!
isEmpty
	self shouldBeImplemented.! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:36:29' prior: 50859446!
isEmpty
	^true.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:30'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:30'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:33'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:33'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:37:04'!
test02

	| carrito |
	
	carrito := Carrito createNew.
	
	carrito add: 'libro'.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:38:35' prior: 50859462!
test02

	| carrito |
	
	carrito := Carrito createNew.
	
	carrito add: '978-3-16-148410-0'.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:39:18' prior: 50859469!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '978-3-16-148410-0'.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:39:21' prior: 50859476!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '978-3-16-148410-0'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:42:53' prior: 50859484!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:44:43'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 17:44:57'!
add: aString 
	self shouldBeImplemented.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 17:45:23'!
Object subclass: #Carrito
	instanceVariableNames: 'libro'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 17:45:21' prior: 50859502!
add: aString 
	libro := aString.! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:45:29'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:45:52' prior: 50859450!
isEmpty
	^libro isNil.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:48:24'!
test03

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	carrito add: unLibro.
	carrito add: unLibro.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	self assert: 4 equals: carrito size.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:50:24' prior: 50859492!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro amount: 1.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:50:28'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:51:06' prior: 50859541!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:56:53' prior: 50859530!
test03

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	
	self deny: carrito isEmpty.
	self assert: 4 equals: carrito listItems size.! !

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/TerseGuide.pck.st----!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:07:10' prior: 50859559!
test03

	| carrito unLibro tuplaLibroCant |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	carrito add: unLibro amount: 4.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:07:27'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:07:37'!
add: aString amount: aSmallInteger 
	self shouldBeImplemented.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:08:50'!
Object subclass: #Carrito
	instanceVariableNames: 'libro libros'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:09:00' prior: 50862511!
add: aString amount: aSmallInteger 
	| tuplaLibroCant |
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aString.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:09:08' prior: 50862524!
add: aString amount: aSmallInteger 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aString.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:09:39'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:04' prior: 50859439 overrides: 16896425!
initialize
	libros := OrderedCollection new.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:10:06'!
FAILURE!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:10:06'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:10:27' prior: 50859520!
isEmpty
	^libros isEmpty .! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:10:28' prior: 50862555!
isEmpty
	^libros isEmpty.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:46' prior: 50859514!
add: aString 
	self add: aString amount: 1.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:55' prior: 50862563!
add: aLibro 
	self add: aLibro amount: 1.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:05' prior: 50862534!
add: aLibro amount: aSmallInteger 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aLibro.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:14' prior: 50862573!
add: aLibro amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aLibro.
	tuplaLibroCant add: anAmount.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:20' prior: 50862583!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:29' prior: 50862568!
add: aBook 
	self add: aBook amount: 1.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:11:38'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862592!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862559!
isEmpty
	^books isEmpty.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862546 overrides: 16896425!
initialize
	books := OrderedCollection new.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:11:50'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:12:05'!
listItems
	^books! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:12:06' prior: 50862634!
listItems
	^books.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:13:51'!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:14:05' prior: 50862650!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:15:14' prior: 50862669!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:15:36' prior: 50862688!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := '9780201184624'.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:16:57' prior: 50862494!
test03

	| carrito unLibro tuplaLibroCant |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	carrito add: unLibro amount: 4.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!methodRemoval: XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:17:02'!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := '9780201184624'.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:19:00' prior: 50862758!
test03

	| carrito unLibro tuplaLibroCant unLibro2 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:19:34' prior: 50862813!
test03

	| carrito unLibro tuplaLibroCant unLibro2 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:23:18'!
test04

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:24:47' prior: 50862861!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	
	
	carrito := Carrito createNewWithValidList: 12.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:25:15' prior: 50862869!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: ''.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:25:39' prior: 50862879!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:26:14' prior: 50862890!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:26:15' prior: 50862902!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	
	
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:27:00' prior: 50862913!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:12' prior: 50862924!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := ''.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			] 
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:26' prior: 50862935!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			] 
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:30' prior: 50862949!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:31:35'!
ERROR!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:31:42'!
createNewWithAllowedList: anOrderedCollection 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeCreateNewWithAllowedList: anOrderedCollection ! !
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:31:57' prior: 50862981!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection ! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:32:00'!
ERROR!

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:32:10'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books orderedCollection'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:32:10'!
initializeWith: anOrderedCollection 
	self shouldBeImplemented.
	orderedCollection := anOrderedCollection.! !
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:32:19' prior: 50863007!
initializeWith: anOrderedCollection
	orderedCollection := anOrderedCollection.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:32:26'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books allowedBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:32:26' prior: 50863014!
initializeWith: anOrderedCollection
	allowedBooks := anOrderedCollection.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:32:30'!
FAILURE!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:32:52' prior: 50862991!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:33:12' prior: 50862964!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:33:14'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:33:57' prior: 50862613!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:34:17' prior: 50863028!
initializeWith: anOrderedCollection
	allowedBooks := anOrderedCollection.
	books := OrderedCollection new.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:34:33'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:34:33'!
ERROR!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/9/2021 18:34:46'!
errorBookNotInAllowedList
	self shouldBeImplemented.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/9/2021 18:35:13' prior: 50863079!
errorBookNotInAllowedList
	^'Error - El Libro no está en la lista de productos permitidos'.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:14'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:19'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:35:57'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:35:57'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:36:03'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:03'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:37:07' prior: 50863042!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message == Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:10'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:20'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:37:25' prior: 50863110!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:38:59'!
PASSED!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:40:39'!
assertBookIsAllowed: aBook

	(allowedBooks includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:40:44'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:40:44'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:19' prior: 50863129!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:41:20'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:41:20'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:25'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:42' prior: 50862830!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	carrito := Carrito createNew.
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:54' prior: 50863186!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	carrito := Carrito createNew.
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	librosValidos add: '9780201113723'.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:42:37' prior: 50863211!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.	
	
	librosValidos := OrderedCollection new.
	librosValidos add: unLibro.
	librosValidos add: unLibro2.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:42:42'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:42:42'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:43:16'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:43:16'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:43:51' prior: 50859551!
test02

	| carrito unLibro librosValidos |
	
	unLibro := '9780201113723'.
	
	librosValidos := OrderedCollection new.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:44:08' prior: 50863291!
test02

	| carrito unLibro librosValidos |
	
	unLibro := '9780201113723'.
	
	librosValidos := OrderedCollection new.
	librosValidos add: unLibro.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:44:27' prior: 50859416!
test01

	| carrito |
	
	carrito := Carrito createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!methodRemoval: Carrito #initialize stamp: 'G.L.S 6/9/2021 18:44:39'!
initialize
	books := OrderedCollection new.!

!methodRemoval: Carrito class #createNew stamp: 'G.L.S 6/9/2021 18:44:44'!
createNew
	^self new initialize.!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:48:07' overrides: 16927572!
setUp! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:39'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:40'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1 libro2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:41'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1 libro2 libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:48:36' prior: 50863356 overrides: 16927572!
setUp

	libro1 := 0.
	libro2 := 0.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:49:13' prior: 50863382 overrides: 16927572!
setUp

	libro1 := '9780201113723'.
	libro2 := 0.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:49:23'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 libro2 libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:49:23' prior: 50863387 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	libro2 := 0.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:49:50' prior: 50863401 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	libro2 := '9780201184624'.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:06'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatters libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:06' prior: 50863407 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatters := '9780201184624'.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:16'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatterns libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:16' prior: 50863422 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:50:27' prior: 50863437 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	libro3 := '9780735619654'.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:37'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:37' prior: 50863444 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:51:05' prior: 50863301!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:51:59' prior: 50863238!
test03

	| carrito tuplaLibroCant unLibro2 librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:52:23' prior: 50863488!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:52:47' prior: 50863157!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := smalltalk80.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:53:03' prior: 50863551!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

----QUIT----(9 June 2021 18:55:59) CuisUniversity-4532.image priorSource: 16887590!

----STARTUP---- (10 June 2021 13:32:39) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:34:03'!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountNotInteger.
			].
	! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:34:09'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:34:42' prior: 50863059!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:34:49'!
ERROR!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:35:06'!
errorAmountNotInteger
	self shouldBeImplemented.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:35:33' prior: 50863638!
errorAmountNotInteger
	^'Error - La cantidad tiene que ser un número entero'.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:35:36'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:37:08'!
assertAmountIsValid: anAmount.

	anAmount isInteger ifFalse: [self error: self class errorAmountNotInteger].! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:37:13'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:37:17'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:37:40'!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountNegative.
			].
	! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:37:47'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:38:29' prior: 50863650!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:39:15' prior: 50863677!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifFalse: [self error: self class errorAmountNegative]. ! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:39:19' prior: 50863684!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifFalse: [self error: self class errorAmountNegative].! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:39:25'!
FAILURE!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:39:58'!
errorAmountNegative
	^'Error - '.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:40:37' prior: 50863704!
errorAmountNegative
	^'Error - La cantidad no puede ser negativa'.! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:48'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:48'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:55'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:07'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:07'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:47:49' prior: 50863693!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifTrue: [self error: self class errorAmountNegative].! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:54'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:48:15'!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountZero.
			].
	! !

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:48:32'!
FAILURE!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:49:02'!
errorAmountZero
	^'Error - La cantidad de libros no puede ser 0'.! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:49:35' prior: 50863725!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifTrue: [self error: self class errorAmountNegative].
	(anAmount = 0) ifTrue: [self error: self class errorAmountZero].! !

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!classRenamed: #XXXTest as: #CarritoTest stamp: 'G.L.S 6/10/2021 13:49:54'!
Smalltalk renameClassNamed: #XXXTest as: #CarritoTest!

Object subclass: #ItemCarrito
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #ItemCarrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 13:51:48'!
Object subclass: #ItemCarrito
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 13:52:04'!
Object subclass: #Carrito
	instanceVariableNames: 'books allowedBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!ItemCarrito class methodsFor: 'no messages' stamp: 'G.L.S 6/10/2021 14:01:18'!
for: aBook amount: anAmount

	^self initializeFor: aBook withAmount: anAmount.! !
!ItemCarrito methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 14:01:46'!
initializeFor: aBook withAmount: anAmount! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:02:13' prior: 50863814!
initializeFor: aBook withAmount: anAmount
	book = aBook.
	amount = anAmount.! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:02:16' prior: 50863819!
initializeFor: aBook withAmount: anAmount

	book = aBook.
	amount = anAmount.! !
!ItemCarrito methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 14:03:46'!
book
	^book.! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:03:55'!
amount
	^amount! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:03:56' prior: 50863834!
amount
	^amount.! !

!classRenamed: #Carrito as: #Cart stamp: 'G.L.S 6/10/2021 14:05:03'!
Smalltalk renameClassNamed: #Carrito as: #Cart!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863608!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863660!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863514!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863467!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863323!
test01

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863577!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863736!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !

!testRun: #CarritoTest #test01 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test02 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test03 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test04 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test06 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test07 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!classRenamed: #CarritoTest as: #CartTest stamp: 'G.L.S 6/10/2021 14:05:22'!
Smalltalk renameClassNamed: #CarritoTest as: #CartTest!

!testRun: #CartTest #test01 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test02 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test03 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test04 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test05 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test06 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test07 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!classRenamed: #ItemCarrito as: #CartItem stamp: 'G.L.S 6/10/2021 14:05:39'!
Smalltalk renameClassNamed: #ItemCarrito as: #CartItem!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:06:27'!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !

!methodRemoval: CartTest #test01 stamp: 'G.L.S 6/10/2021 14:06:27'!
test01

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:07:00'!
test02CartWithAnItemIsNotEmpty

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!methodRemoval: CartTest #test02 stamp: 'G.L.S 6/10/2021 14:07:00'!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:12:05'!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!methodRemoval: CartTest #test03 stamp: 'G.L.S 6/10/2021 14:12:05'!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:17:49'!
test04CartCannotAddItemsThatAreNotAllowed

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	! !

!methodRemoval: CartTest #test04 stamp: 'G.L.S 6/10/2021 14:17:49'!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:18:31'!
test05CartCannotAddANonIntegerAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	! !

!methodRemoval: CartTest #test05 stamp: 'G.L.S 6/10/2021 14:18:31'!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	!

!classRemoval: #XXX stamp: 'G.L.S 6/10/2021 14:18:47'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:19:33'!
test06CartCannotAddANegativeAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	! !

!methodRemoval: CartTest #test06 stamp: 'G.L.S 6/10/2021 14:19:33'!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:20:05'!
test07CartCannotAddAZeroAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !

!methodRemoval: CartTest #test07 stamp: 'G.L.S 6/10/2021 14:20:05'!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!classRemoval: #CartItem stamp: 'G.L.S 6/10/2021 14:52:12'!
Object subclass: #CartItem
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:55:51'!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: aBook amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:56:14' prior: 50864222!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:16' prior: 50864164!
test07CartCannotAddAZeroAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero. 
	! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:28' prior: 50864258!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero. 
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:29' prior: 50864305!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:57' prior: 50864135!
test06CartCannotAddANegativeAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNegative.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:07' prior: 50864323!
test06CartCannotAddANegativeAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNegative.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:34' prior: 50864100!
test05CartCannotAddANonIntegerAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:42' prior: 50864379!
test05CartCannotAddANonIntegerAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 15:00:13' prior: 50864072!
test04CartCannotAddItemsThatAreNotAllowed

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			]."
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: {designPatterns.}  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 15:00:22' prior: 50864435!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: {designPatterns.}  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

----QUIT----(10 June 2021 15:03:38) CuisUniversity-4532.image priorSource: 17022446!

----STARTUP---- (10 June 2021 15:13:46) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

----QUIT----(10 June 2021 15:19:09) CuisUniversity-4532.image priorSource: 17050885!

----STARTUP---- (10 June 2021 15:27:47) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


pepe _ Dictionary new.!

pepe add: 'jorge'->5.!

pepe add: 'jorge'->5.!

pepe at: 'jorge'.!

----QUIT----(10 June 2021 15:30:31) CuisUniversity-4532.image priorSource: 17051833!

----STARTUP---- (10 June 2021 17:47:27) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 17:48:49' prior: 50864021!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !

!methodRemoval: Cart #listItems stamp: 'G.L.S 6/10/2021 17:48:59'!
listItems
	^books.!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:14' overrides: 16880927!
size
	^books size.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:24'!
first
	^books first.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:35'!
second
	^books second.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

----QUIT----(10 June 2021 18:15:03) CuisUniversity-4532.image priorSource: 17052120!

----STARTUP---- (10 June 2021 19:39:29) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 19:42:00'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:42:19'!
test01! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:47:05'!
test01CashierCannotCheckoutWithAnEmptyCart! !

!methodRemoval: CashierTest #test01 stamp: 'G.L.S 6/10/2021 19:47:13'!
test01!

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 19:52:27'!
Object subclass: #Cashier
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:52:16' prior: 50864623!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:52:49' prior: 50864637!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:56:32' prior: 50864650!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier card |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	card := '0000000000000000'.
	
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:57:31' prior: 50864663!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:57:42' prior: 50864677!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 19:58:20'!
ERROR!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 19:58:37'!
errorCannotCheckoutEmptyCart
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 20:01:29' prior: 50864706!
errorCannotCheckoutEmptyCart
	^'Error - No se puede hacer checkout de un carrito vacío'.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:31'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:31'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:42'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:42'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:02:08' prior: 50864690!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:09:16'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:09:16'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:20:12'!
test02
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:22:13' prior: 50864774!
test02
	
	| cart cashier catalog |
	
	catalog := Dictionary new.
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

pepe _ Dictionary new.!

pepe add: 'jorge' -> 5.!

pepe at: 'jorge'.!

 5 !

 5 !

 5 !

pepe at: 'jorge'.!

 5 !

pepe add: 'jorge' -> 2324254.!

pepe at: 'jorge'.!

 2324254 !

 2324254 !

 2324254 !

pepe at: 'jorge' put: 10.!

pepe at: 'jorge'.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:23:45' prior: 50864785!
test02
	
	| cart cashier catalog |
	
	catalog := Dictionary new.
	catalog add: '' -> 10.
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:09'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:10'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:11'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:24:05' overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:24:50' prior: 50864806!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:25:28'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking aCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:25:26' prior: 50864844 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	aCatalog := Dictionary new.
	aCatalog add: smalltalk80 -> 10.
	aCatalog add: designPatterns -> 100.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:25:44' prior: 50864872 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	aCatalog := Dictionary new.
	aCatalog add: smalltalk80 -> 10.
	aCatalog add: designPatterns -> 100.
	aCatalog add: objectThinking -> 50.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:26:00'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:26:00' prior: 50864883 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:26:19'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:26:17' prior: 50864904 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	emptyCatalog := Dictionary new.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:26:37' prior: 50864851!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:27:31' prior: 50864937!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:31:02' prior: 50864949!
test02
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]."! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:31:09' prior: 50864731!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:31:10'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:31:22'!
FAILURE!
!Cashier methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 20:31:50'!
checkout: aCart! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:32:19' prior: 50864998!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:32:42'!
assertCartIsNotEmpty: aCart
	
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:33:20' prior: 50865007!
assertCartIsNotEmpty: aCart
	
	aCart isEmpty ifTrue: [self error: self class errorCannotCheckoutEmptyCart].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:33:23'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:33:41' prior: 50864964!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:37:27' prior: 50865022!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:10' prior: 50864925 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:13' prior: 50865053 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:40:39'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:35' prior: 50865066 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:41:47'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:41:52' prior: 50865088 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:42:16' prior: 50865112 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:42:33' prior: 50865037!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:43:16'!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!methodRemoval: CashierTest #test02 stamp: 'G.L.S 6/10/2021 20:43:16'!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:43:55' prior: 50865155!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:44:13' prior: 50865187!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:44:17'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'G.L.S 6/10/2021 20:44:26'!
withCatalog: aDictionary 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithCatalog: aDictionary ! !
!Cashier class methodsFor: 'instance creation' stamp: 'G.L.S 6/10/2021 20:44:34' prior: 50865222!
withCatalog: aDictionary 
	^self new initializeWithCatalog: aDictionary. ! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:44:36'!
ERROR!

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:44:46'!
Object subclass: #Cashier
	instanceVariableNames: 'dictionary'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:44:46'!
initializeWithCatalog: aDictionary 
	self shouldBeImplemented.
	dictionary := aDictionary.! !
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:44:56' prior: 50865248!
initializeWithCatalog: aDictionary 
	dictionary := aDictionary.! !

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:45:01'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:45:01' prior: 50865254!
initializeWithCatalog: aDictionary 
	catalog := aDictionary.! !
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:45:21' prior: 50865267!
initializeWithCatalog: aCatalog 
	catalog := aCatalog.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:45:24'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:46:27' prior: 50865002!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:46:38'!
assertCartHasTheSameCatalog: aCart

	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:47:45' prior: 50865288!
assertCartHasTheSameCatalog: aCart

	aCart hasCatalog: catalog.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:48:20' prior: 50865293!
assertCartHasTheSameCatalog: aCart

	(aCart hasCatalog: catalog) ifFalse: [self error: self class].! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 20:48:53'!
errorCannotCheckoutACartWithADifferentCatalog
	^'Error - No se puede hacer checkout de un carrito con un catálogo diferente'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:49:32' prior: 50865299!
assertCartHasTheSameCatalog: aCart

	(aCart hasCatalog: catalog) ifFalse: [self error: self class errorCannotCheckoutACartWithADifferentCatalog].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:49:42'!
FAILURE!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:49:42'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 20:50:27'!
hasCatalog: aCatalog
	^allowedBooks = aCatalog.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

----QUIT----(10 June 2021 21:23:14) CuisUniversity-4532.image priorSource: 17054443!

----STARTUP---- (14 June 2021 17:15:25) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:01:44'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:01:45'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:34:59' prior: 50864979!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog .
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:35:00' prior: 50865359!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:43:09'!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:44:32' prior: 50865202!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote}.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:44:58' prior: 50865127 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:45:15' prior: 50865410!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:45:21'!
ERROR!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:45:21'!
ERROR!

pepe keys.!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/14/2021 18:45:59' prior: 50863146!
assertBookIsAllowed: aBook

	(allowedBooks keys includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:46:06'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:46:08'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:27' prior: 50865396!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:41' prior: 50865482!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 30.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:53' prior: 50865496!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:47:15' prior: 50865510!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:50:32' prior: 50865524!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 18:50:39'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:52:33' prior: 50865282!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^530.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:53:07' prior: 50865554!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:54:48' prior: 50865561!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 18:55:00'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:55:47'!
totalItemPrice
	self shouldBeImplemented.! !

pepe2 _ OrderedCollection new.!

pepe2 add: 2.!

pepe2 add: 5.!

pepe2 add: 6.!

pepe2!

pepe2 sum: [:val | val*2]!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:59:43' prior: 50865577!
totalItemPrice
	
	^books sum: [:bookAmountTuple | allowedBooks at: bookAmountTuple first].! !

!classDefinition: #Cart category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:00:17'!
Object subclass: #Cart
	instanceVariableNames: 'books catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865585!
totalItemPrice
	
	^books sum: [:bookAmountTuple | catalog at: bookAmountTuple first].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865328!
hasCatalog: aCatalog
	^catalog = aCatalog.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50863069!
initializeWith: anOrderedCollection
	catalog := anOrderedCollection.
	books := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865467!
assertBookIsAllowed: aBook

	(catalog keys includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:01:17' prior: 50865598!
totalItemPrice
	
	^books sum: [:bookAmountTuple | catalog at: bookAmountTuple first * bookAmountTuple second].! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:01:30'!
ERROR!

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:01:30'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:02:09' prior: 50865623!
totalItemPrice
	
	^books sum: [:bookAmountTuple | (catalog at: bookAmountTuple first) * bookAmountTuple second].! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:02:43'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:04:53'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:05:57' prior: 50865539!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:06:18'!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!methodRemoval: CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:06:18'!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.!

!classDefinition: #Cart category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:08:23'!
Object subclass: #Cart
	instanceVariableNames: 'cartItems catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864571!
second
	^cartItems second.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864565 overrides: 16880927!
size
	^cartItems size.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864568!
first
	^cartItems first.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50865609!
initializeWith: anOrderedCollection
	catalog := anOrderedCollection.
	cartItems := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50865635!
totalItemPrice
	
	^cartItems sum: [:bookAmountTuple | (catalog at: bookAmountTuple first) * bookAmountTuple second].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50863625!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	cartItems add: tuplaLibroCant.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50862622!
isEmpty
	^cartItems isEmpty.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:10:40'!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:10:53' prior: 50865731!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:12:30'!
Object subclass: #CreditCard
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:12:50' prior: 50865744!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:13:27' prior: 50865764!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:14:05' prior: 50865781!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:34'!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:34' prior: 50865657!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865798!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865372!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865442!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!methodRemoval: Cashier #checkout: stamp: 'G.L.S 6/14/2021 19:22:35'!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:24:08'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:06' prior: 50865427 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:23' prior: 50865853!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:31' prior: 50865868!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard ]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:32' prior: 50865932!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:39' prior: 50865822!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard .
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:40' prior: 50865966!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:55' prior: 50865836!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	"creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''."
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:25:23'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:25:18' prior: 50865994!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	"creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''."
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:25:34' prior: 50865902 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := nil.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:25:36'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:25:39'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:26:11' prior: 50866022!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:28:47' prior: 50866039 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:28:58' prior: 50866078 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:29:35' prior: 50866099 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !

FixedGregorianDate today.!

FixedGregorianDate yesterday .!

FixedGregorianDate yesterday. !

FixedGregorianDate tomorrow.!

FixedGregorianDate theBeginningOfTime .!

12/05/2021!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:26' prior: 50866120 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marcos' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:27' prior: 50866150 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:45' prior: 50866063!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:52' prior: 50866198!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: expiredCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:34:39' prior: 50866211!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:38:52'!
forOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeForOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:10' prior: 50866240!
forOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:19' prior: 50866252!
forOwner: anOwner withNumber: aString2 withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: anOwner withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:35' prior: 50866261!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:49' prior: 50866270!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^self new initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate ! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:13'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:13'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:14'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber date'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 19:40:14'!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	self shouldBeImplemented.
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	date := aDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 19:40:27' prior: 50866311!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	date := aDate.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:40:47'!
FAILURE!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/14/2021 19:41:47'!
errorExpiredCard
	^'Error - No se puede hacer checkout con una tarjeta de crédito vacía'.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:42:03'!
FAILURE!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:42:03'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:47:55' prior: 50865814!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:48:51' prior: 50866344!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!CreditCard methodsFor: 'nil' stamp: 'G.L.S 6/14/2021 19:49:09'!
isExpiredOn: aDate
! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:49:26' prior: 50866365!
isExpiredOn: aDate
	^ true.! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:49:48'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:49:48' prior: 50866320!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:50:01' prior: 50866369!
isExpiredOn: aDate
	^ expirationDate < aDate.! !

FixedGregorianDate yesterday < FixedGregorianDate today.!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:50:47'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:01'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:01' prior: 50866223!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865918!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865980!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865949!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!methodRemoval: Cashier #checkout:withCreditCard: stamp: 'G.L.S 6/14/2021 19:52:02'!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:13' prior: 50866401!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:53:26' prior: 50866491!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCardHasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:53:30' prior: 50866517!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCardHasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:02'!
assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:14' prior: 50866527!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:19' prior: 50866547!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:34'!
assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:34' prior: 50866560!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !

!methodRemoval: Cashier #assertCard:HasNotExpiredOn: stamp: 'G.L.S 6/14/2021 19:54:34'!
assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:54:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCardTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 21:19:44'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:20:12'!
test01! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:25'!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:22:32'!
FAILURE!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:54' prior: 50866646!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:56' prior: 50866661!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:22:57'!
FAILURE!
!CreditCard class methodsFor: 'nil' stamp: 'G.L.S 6/14/2021 21:23:40'!
errorOwnerEmpty
	^'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío'! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:24:13' prior: 50866382!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 

	self assertNameNotEmpty: anOwner.

	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:24:30'!
assertNameNotEmpty: anOwner
	
	anOwner! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:25:06' prior: 50866705!
assertNameNotEmpty: anOwner
	
	anOwner withBlanksTrimmed isEmpty ifTrue: [self error: self class errorOwnerEmpty].! !

!methodRemoval: CreditCardTest #test01 stamp: 'G.L.S 6/14/2021 21:26:36'!
test01!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:26:40'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:26:40'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:27:27'!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:27:54' prior: 50866726!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorNumberFormatNotCorrect].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:28:17' prior: 50866739!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:28:26'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:28:55'!
errorCardNumberLessThan16Digits
	^'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos'! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:28:57' prior: 50866771!
errorCardNumberLessThan16Digits
	^'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos'.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:30:19' prior: 50866696!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 

	self assertNameNotEmpty: anOwner.
	self assertCardNumberIsCorrect: aCreditCardNumber.

	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !

'jorge' length .!

'jorge' size!
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:31:29'!
assertCardNumberIsCorrect: aCreditCardNumber

	(aCreditCardNumber size < 16) ifTrue: [self error: self class errorCardNumberLessThan16Digits].! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:31:36'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:31:50'!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:32:06' prior: 50866809!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:32:19' prior: 50866823!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits].! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:32:28'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:32:51'!
errorCardNumberMoreThan16Digits
	^'Error - El número de la tarjeta de crédito tiene más de 16 dígitos'.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:35:08' prior: 50866797!
assertCardNumberIsCorrect: aCreditCardNumber

	(aCreditCardNumber size < 16) ifTrue: [self error: self class errorCardNumberLessThan16Digits].
	(aCreditCardNumber size > 16) ifTrue: [self error: self class errorCardNumberMoreThan16Digits].! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

----QUIT----(14 June 2021 21:36:35) CuisUniversity-4532.image priorSource: 17078199!

----STARTUP---- (14 June 2021 21:36:47) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----QUIT----(14 June 2021 21:46:54) CuisUniversity-4532.image priorSource: 17127600!

----STARTUP---- (15 June 2021 17:04:11) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:49:07'!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:53:27' prior: 50866900!
test05CashierCheckoutRegistersSale
	
	| cart cashier sales|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:53:52' prior: 50866918!
test05CashierCheckoutRegistersSale
	
	| cart cashier sales|
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:27' prior: 50866936!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	"sales := OrderedCollection new."
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 17:54:32'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:31' prior: 50866955!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:57' prior: 50866985!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866462!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866413!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866431!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866447!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50867004!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!methodRemoval: Cashier #checkout:withCreditCard:onDate: stamp: 'G.L.S 6/15/2021 17:55:35'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:56:17' prior: 50867103!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:56:39' prior: 50867132!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:57:21' prior: 50867147!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 17:57:25'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:58:23' prior: 50867022!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	aSalesBook add: aCart totalItemPrice.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:58:52' prior: 50867184!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:59:02' prior: 50867196!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:01:39' prior: 50866174 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:01:49' prior: 50867163!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:05:43'!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:07:18'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:07:24'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:07:17' prior: 50867222 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcesor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:08:55' prior: 50867283!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:10:09'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor stolenCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:10:07' prior: 50867321 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcesor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867347!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867247!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867052!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867087!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867033!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867071!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!methodRemoval: Cashier #checkout:withCreditCard:onDate:registerOn: stamp: 'G.L.S 6/15/2021 18:11:53'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:12:03'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor stolenCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:12:01' prior: 50867378 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcessor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:12:28'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:12:41' prior: 50867422!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:13:09'!
ERROR!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:13:23'!
errorStolenCard
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:14:00' prior: 50867626!
errorStolenCard
	^'Error - No se puede realizar una transacción con una tarjeta robada'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:14:08' prior: 50867631!
errorStolenCard
	^'Error - No se puede realizar una transacción con una tarjeta robada'.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:14:10'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:15:15' prior: 50867408!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:15:25'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:15:25'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:15:45'!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor

	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:16:42' prior: 50867669!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor

	(aMerchantProcessor isCardStolen: aCreditCard) ifTrue: [self error: self class errorStolenCard].! !
!MockMerchantProcesor methodsFor: 'no messages' stamp: 'G.L.S 6/15/2021 18:17:01'!
isCardStolen: aCreditCard

	! !

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:17:18'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: 'stolenCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:17:16' prior: 50867682!
isCardStolen: aCreditCard

	^stolenCards includes: aCreditCard.! !
!MockMerchantProcesor methodsFor: 'nil' stamp: 'G.L.S 6/15/2021 18:17:35' overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.! !
!MockMerchantProcesor methodsFor: 'nil' stamp: 'G.L.S 6/15/2021 18:18:55'!
registerStolenCard: aCreditCard! !
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:19:08' prior: 50867706!
registerStolenCard: aCreditCard
	
	stolenCards add: aCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:19:34' prior: 50867560 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: '1234567891011120'.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:03'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:03'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:37'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:21:33' prior: 50867603!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:36'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:36'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:43'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:43'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:22:58' prior: 50867717 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:23:04'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:24:48'!
test06CashierCannotCheckoutAStolenCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!methodRemoval: CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:24:48'!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	!

----QUIT----(15 June 2021 18:37:18) CuisUniversity-4532.image priorSource: 17127794!

----STARTUP---- (16 June 2021 15:52:48) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:07:12'!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:08:17'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:15' prior: 50867793 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:32' prior: 50867895!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:59' prior: 50867929 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:09:25' prior: 50867965!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardNotRegistered.
			]
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:16:25'!
FAILURE!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:16:25'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:17:47' prior: 50868022!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog .
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:18:07' prior: 50868049!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 16:18:52'!
errorNotARegisteredCard
	^'Error - La tarjeta utilizada no se encuentra registrada'.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:19:04' prior: 50868070!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:19:04'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:19:46' prior: 50867986 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard.
	! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:20:11'!
registerCard: aCreditCard 
	self shouldBeImplemented.! !

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:20:36'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: 'stolenCards registeredCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:20:34' prior: 50868158!
registerCard: aCreditCard 
	registeredCards add: aCreditCard.! !
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:20:59' prior: 50867701 overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.
	registeredCards := OrderedCollection new.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:22:02' prior: 50867647!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:22:12'!
FAILURE!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:22:12'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:23:13'!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	(aMerchantProcessor isCardRegistered: aCreditCard) ifFalse: [self error: self class errorNotARegisteredCard].! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:23:39'!
isCardRegistered: aCreditCard
	^registeredCards includes: aCreditCard.! !
!Cashier methodsFor: 'private' stamp: 'G.L.S 6/16/2021 16:25:06' prior: 50868209!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	
	(aMerchantProcessor isCardRegistered: aCreditCard) ifFalse: [self error: self class errorNotARegisteredCard].! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:25:18'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:26:37'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:40:18'!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:44:48'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:44:42' prior: 50868120 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:45:00' prior: 50868262!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:52:09' prior: 50868339!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughMoney.
			]
	! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 16:53:01'!
errorCardDoesNotHaveEnoughMoney

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 16:53:18'!
FAILURE!
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:55:17' prior: 50868184!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	self assertCard: aCreditCard hasEnoughMoneyOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:02:31' prior: 50868391!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	
	self assertCard: aCreditCard canSpend: total on: aMerchantProcessor.
	
	aSalesBook add: total.
	
	^total.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:03:49'!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards add: aCreditCard.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 17:03:49' prior: 50868297 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!methodRemoval: MockMerchantProcesor #registerCard: stamp: 'G.L.S 6/16/2021 17:03:49'!
registerCard: aCreditCard 
	registeredCards add: aCreditCard.!
!MockMerchantProcesor methodsFor: 'initialization' stamp: 'G.L.S 6/16/2021 17:04:23' prior: 50868178 overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.
	registeredCards := Dictionary new.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:04:41' prior: 50868431!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards at: aCreditCard -> aBalance.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:04:50' prior: 50868492!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards add: aCreditCard -> aBalance.! !

pepe _ Dictionary new.!

pepe add: 'jorge' -> 2324254.!

pepe at: 'jorge'.!

 2324254 !

 2324254 !

 2324254 !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:05:25' prior: 50868217!
isCardRegistered: aCreditCard
	^registeredCards keys includes: aCreditCard.! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:06:00'!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:06:50' prior: 50868514!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	
	(aMerchantProcessor can: aCreditCard spend: aTotal) ifFalse: [self error: self class errorCardDoesNotHaveEnoughMoney]! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 17:07:06'!
errorCardDoesNotHaveEnoughBalance

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 17:07:06' prior: 50868360!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughBalance.
			]
	! !

!methodRemoval: Cashier class #errorCardDoesNotHaveEnoughMoney stamp: 'G.L.S 6/16/2021 17:07:06'!
errorCardDoesNotHaveEnoughMoney

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:07:19'!
FAILURE!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:08:12'!
can: aCreditCard spend: aTotal

	^ (registeredCards at:aCreditCard) >= aTotal.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:33'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:33'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:38'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:38'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:43'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:43'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:09:26' prior: 50868438 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:29'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:29'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:43'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:43'!
FAILURE!

(registeredCards at:aCreditCard) >= aTotal!
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:21:01' prior: 50868519!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	
	(aMerchantProcessor can: aCreditCard spend: aTotal) ifFalse: [self error: self class errorCardDoesNotHaveEnoughBalance]! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:06'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:30:56'!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:31:24' prior: 50868774!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: aBlockToFail 
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = anErrorMessage].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:31:36' prior: 50868788!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: aBlockToFail 
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = anErrorMessage].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:12' prior: 50866674!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:23' prior: 50868808!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
		
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:25' prior: 50868826!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:31' prior: 50868844!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:43' prior: 50868862!
test01CreditCardCannotHaveEmptyOwner
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:33:28' prior: 50866753!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today] 
		 withErrorMessage: CreditCard errorCardNumberLessThan16Digits! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:33:30' prior: 50868905!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today] 
		 withErrorMessage: CreditCard errorCardNumberLessThan16Digits.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:40' prior: 50866837!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	"self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits]."
		
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits ! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:42' prior: 50868943!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	"self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits]."
		
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:49' prior: 50868964!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:44:32' prior: 50867517!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog .
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:44:33' prior: 50869012!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:45:46' prior: 50869030!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:46:03' prior: 50867497!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:46:45' prior: 50867480!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:47:04' prior: 50867460!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:47:28' prior: 50867442!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:53:12'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:54:37' prior: 50869206!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 17:55:03'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:02' prior: 50868644 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	listToAdd := Dictionary new.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:17' prior: 50869268 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	listToAdd := Dictionary new.
	listToAdd add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 17:55:44'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd emptyListToAdd'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:42' prior: 50869314 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:57:21'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCart:withCatalog:withItems:withCreditCard:ThrowingError: stamp: 'G.L.S 6/16/2021 17:57:28'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:58:33' prior: 50869080!
test01CashierCannotCheckoutWithAnEmptyCart
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]."
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutWithCartwithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:58:57' prior: 50869476!
test01CashierCannotCheckoutWithAnEmptyCart
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutWithCartwithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:00:37' prior: 50869099!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: ''
		withCreditCard:  '' 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:00:56' prior: 50869376 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:01:26'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd emptyListToAdd listToAdd2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:24' prior: 50869603 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:46' prior: 50869576!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:54' prior: 50869716!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:03:56' prior: 50869169!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			].
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:03' prior: 50869788!
test04CashierCannotCheckOutWithAnExpiredCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]."
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:23' prior: 50869666 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:36' prior: 50869814!
test04CashierCannotCheckOutWithAnExpiredCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:05:45' prior: 50867849!
test06CashierCannotCheckoutAStolenCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]"
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:05:59' prior: 50869967!
test06CashierCannotCheckoutAStolenCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:32' prior: 50868096!
test07CashierCannotCheckoutWithAFakeCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]"
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:41' prior: 50870035!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:53' prior: 50870093!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorStolenCard .
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:54'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:59' prior: 50870104!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:00' prior: 50870118!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:03' prior: 50870129!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:54' prior: 50868535!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughBalance.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance .
	! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:08:04' prior: 50870182!
test08CashierCannotCheckoutWithACardWithoutMoney
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:08:57'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	cashier checkout: cart 
			withCreditCard: aCreditCard
			onDate: FixedGregorianDate today 
			registerOn: sales 
			forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:09:02' prior: 50870253!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:09:40' prior: 50870274!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:10:04' prior: 50870295!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:10:34' prior: 50870316!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:11:38' prior: 50869120!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:12:43'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCartwithCatalog:withItems:withCreditCard:Asserting: stamp: 'G.L.S 6/16/2021 18:12:50'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:13:22'!
testCashierWithCatalog: aCatalog cannotCheckoutCartWithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870140!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870025!
test06CashierCannotCheckoutAStolenCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870242!
test08CashierCannotCheckoutWithACardWithoutMoney
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance.
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869533!
test01CashierCannotCheckoutWithAnEmptyCart
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutCartWithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869776!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869956!
test04CashierCannotCheckOutWithAnExpiredCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCartwithCatalog:withItems:withCreditCard:ThrowingError: stamp: 'G.L.S 6/16/2021 18:13:22'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:13:29'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:14:14' prior: 50870359!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [self assert: 530 equals: result.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:14:52' prior: 50870572!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	"cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [self assert: 530 equals: result.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:20' prior: 50870376!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:27' prior: 50870617!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:45' prior: 50870594!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	"cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:54' prior: 50870659!
test03CheckoutReturnsTheRightAmount
	
	"| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:16:03' prior: 50870682!
test03CheckoutReturnsTheRightAmount
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:17:35' prior: 50869189!
test05CashierCheckoutRegistersSale
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1)."
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:18:05'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:18:05' prior: 50870736!
test03CheckoutReturnsTheRightAmount
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:18:05' prior: 50870746!
test05CashierCheckoutRegistersSale
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1)."
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !

!methodRemoval: CashierTest #testCashierWithCatalog:checkoutCartWithItems:withCreditCard:Asserting: stamp: 'G.L.S 6/16/2021 18:18:05'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:19:13' prior: 50870832!
test05CashierCheckoutRegistersSale
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
createNewWithAllowedList: anOrderedCollection
	^ [
	([
	(self coverAll:
		{50 to: 53}) new ] valueCoveringAll:
		{55 to: 57}) initializeWith:
		(anOrderedCollection
			cover: (75 to: 93)
			declaredAt: (27 to: 45)) ] valueCoveringAll:
		{59 to: 73}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
createNewWithAllowedList: anOrderedCollection
	^ [
	([
	(self coverAll:
		{50 to: 53}) new ] valueCoveringAll:
		{55 to: 57}) initializeWith:
		(anOrderedCollection
			cover: (75 to: 93)
			declaredAt: (27 to: 45)) ] valueCoveringAll:
		{59 to: 73}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:20:45'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:20:45'!
ERROR!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:21:01'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:21:01'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:21:01'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:10'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:11'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:13'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:20'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 catalog2 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:09' prior: 50863460 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:45' prior: 50872100 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:57' prior: 50863989!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithAllowedList: emptyCatalog.
	
	self assert: carrito isEmpty.
	! !
!Cart class methodsFor: 'instance creation' stamp: 'G.L.S 6/16/2021 18:26:27'!
createNewWithCatalog: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50870801!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithCatalog: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50870419!
testCashierWithCatalog: aCatalog cannotCheckoutCartWithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithCatalog: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864536!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithCatalog: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864001!
test02CartWithAnItemIsNotEmpty

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithCatalog: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50872130!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithCatalog: emptyCatalog.
	
	self assert: carrito isEmpty.
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864240!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithCatalog: librosValidos.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !

!methodRemoval: Cart class #createNewWithAllowedList: stamp: 'G.L.S 6/16/2021 18:26:27'!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:26:35'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:35'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:26:35'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:26:53' prior: 50872217!
test02CartWithAnItemIsNotEmpty

	| carrito |
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:26:57'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:27:10' prior: 50872115 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:27:24'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:28:50' prior: 50872190!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant |
	
	carrito := Cart createNewWithCatalog: catalog1.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:29:34' prior: 50872236!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito |
	
	carrito := Cart createNewWithCatalog: aBookList.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:29:55' prior: 50864482!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:29:57'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:26' prior: 50872446!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: emptyCatalog 
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:36' prior: 50864426!
test05CartCannotAddANonIntegerAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:40' prior: 50864370!
test06CartCannotAddANegativeAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountNegative.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:46' prior: 50864314!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountZero.
	! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:31:30' prior: 50872359 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:31:37'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:32:27'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!

----QUIT----(16 June 2021 20:12:33) CuisUniversity-4532.image priorSource: 17159611!

----STARTUP---- (17 June 2021 20:37:52) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/17/2021 20:52:45'!
TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'no messages' stamp: 'G.L.S 6/17/2021 20:52:59'!
test01
! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 20:59:52' prior: 50873901!
test01

	| invalidID |
	invalidID := '00000000' ! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:00:00' prior: 50873904!
test01

	| invalidID |
	
	invalidID := '00000000' ! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:00:52' prior: 50873909!
test01

	| invalidID |
	
	invalidID := '0000000000'.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:02:19' prior: 50873914!
test01

	| invalidID |
	
	invalidID := '0000000000'.
	
	self should: [] 
		raise: Error  
		withExceptionDo: [
			:anError |
			] ! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/17/2021 21:21:12'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:22:44' prior: 50873919!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError errorMessage = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:23:15'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:23:35' prior: 50873933!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:23:37'!
ERROR!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/17/2021 21:23:58'!
errorWrongUserCredentials
	self shouldBeImplemented.! !
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/17/2021 21:24:23' prior: 50873963!
errorWrongUserCredentials
	^'Error - Las credenciales del usuario no son correctas'.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:24:30'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:24:45' prior: 50873948!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:24:46'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:24:56'!
createCartUser: aString password: aString2 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:25:11' prior: 50873992!
createCartUser: aUser password: aPassword 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:29:28' prior: 50873998!
createCartUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:29:40'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:30:15'!
createCartForUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:30:15' prior: 50873976!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXX #createCartUser:password: stamp: 'G.L.S 6/17/2021 21:30:15'!
createCartUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:30:23'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:32:02' prior: 50874019!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:32:02'!
FAILURE!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:32:20'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:33:23' prior: 50874012!
createCartForUser: aUser password: aPassword 
	
	self error: self class errorWrongUserCredentials.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:33:27'!
PASSED!

----QUIT----(17 June 2021 22:08:36) CuisUniversity-4532.image priorSource: 17351466!

----STARTUP---- (20 June 2021 16:49:08) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 16:51:31'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 16:51:32'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:52:03'!
test02

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:53:37' prior: 50874078!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 16:53:45'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:55:36' prior: 50874092!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 16:56:55'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:56:53' prior: 50874060!
createCartForUser: aUser password: aPassword 
	
	(datosUsuarios at:aUser = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 16:57:13' overrides: 16896425!
initialize

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:57:37' prior: 50874127!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios at:aUser) = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:58:09' prior: 50874135 overrides: 16896425!
initialize

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:59:26'!
initializeWith: aUserDataDictionary

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:59:31' prior: 50874153!
initializeWith: aUserDataDictionary

	datosUsuarios := aUserDataDictionary.! !

!methodRemoval: XXX #initialize stamp: 'G.L.S 6/20/2021 16:59:39'!
initialize

	datosUsuarios := Dictionary new.!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 17:00:55'!
createWith: aUserDataDictionary

	^self initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:01:43' prior: 50874041!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:01:52' prior: 50874107!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 17:02:17'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 17:02:16' overrides: 16927572!
setUp
	
	mockXXX := XXX new.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:02:43' prior: 50874174!
test01

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:02:52' prior: 50874187!
test02

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 17:03:19'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 17:03:25' prior: 50874206 overrides: 16927572!
setUp
	
	userData := Dictionary new.
	
	mockXXX := XXX createWith: userData.! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 17:04:06' prior: 50874242 overrides: 16927572!
setUp
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 'jorge'!

pepe at: 'jorge' ifAbsent: [nil.] !

nil = nil.!

 true !

 true !

nil = 0.!

nil = nil.!

nil = 0.!

nil = 0.!

nil !

nil = 0.!

nil = 0.
!

nil!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:10:51' prior: 50874140!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [datosUsuarios at:aUser = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:11:22' prior: 50874262!
createCartForUser: aUser password: aPassword 
	
	(datosUsuarios at:aUser = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 17:12:00' prior: 50874168!
createWith: aUserDataDictionary

	^self new initializeWith: aUserDataDictionary.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:06'!
FAILURE!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:06'!
FAILURE!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:15'!
FAILURE!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:15'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:12:33' prior: 50874271!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios at:aUser) = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:35'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:37'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:13:02'!
test03

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/20/2021 17:13:04'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:13:50'!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:13:50'!
test01

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:14:28'!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!methodRemoval: XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:14:28'!
test02

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:14:53'!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXXTest #test03 stamp: 'G.L.S 6/20/2021 17:14:53'!
test03

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:15:07' prior: 50874294!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [datosUsuarios at:aUser = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:15:11'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:16'!
FAILURE!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:15:16'!
FAILURE!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:15:16'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:23'!
FAILURE!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:23'!
FAILURE!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 'jorge' -> 2324254.!

pepe add: 'jorge' -> 2324254.!

pepe includesKey: 'jorge'.!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:16:17' prior: 50874392!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:16:22'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:16:24'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:16:26'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:20:17' prior: 50874366!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:32:09'!
test04CannotAddItemToAnUnexistentCart

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:33:09' prior: 50874472!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX addItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:40:29' prior: 50874487!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX addItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:41:06' prior: 50874498!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: '' ofItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:41:14' prior: 50874509!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:48:42' prior: 50874520!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:57:28' prior: 50874531!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:58:25'!
ERROR!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:58:35'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:58:46'!
add: aSmallInteger ofItem: aString toCart: aString3 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:59:10' prior: 50874561!
add: anAmount ofItem: anItemID toCart: aCartID 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:59:56' prior: 50874567!
add: anAmount ofItem: anItemID toCart: aCartID 
	self error: self class errorCartIdDoesntExist.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:59:59'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:00:18' prior: 50874573!
add: anAmount ofItem: anItemID toCart: aCartID 
	self error: self class errorCartIdDoesNotExist.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:00:27'!
ERROR!
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:01:09'!
errorCartIdDoesNotExist
	self shouldBeImplemented.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:01:47' prior: 50874592!
errorCartIdDoesNotExist
	^'Error - No existe un carrito con esa ID'.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:06:28' prior: 50874583!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self error: self class errorCartIdDoesNotExist.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:01'!
test05
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:08' prior: 50874675!
test05
	
	
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:21' prior: 50874686!
test05
	
	| password usuario |
	usuario := 'pepe'.
	password := '5678'.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:47' prior: 50874697!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:10:23' prior: 50874710!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:10:40' prior: 50874725!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	mockXXX add: 17 ofItem: '9780201113723' toCart: cartId.
		! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:11:00' prior: 50874740!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:48'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:50'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:51'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:52'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:53'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:54'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:56'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:57'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 19:13:26' prior: 50874248 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 19:14:00' prior: 50874837 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:15:17' prior: 50874750!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		! !

!methodRemoval: XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:15:38'!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:17:21'!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:00' prior: 50874902!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000'] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:10' prior: 50874913!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:23' prior: 50874926!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:18:41'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:19:12' prior: 50874345!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:15'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:15'!
FAILURE!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:20'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:23'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:23'!
FAILURE!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 19:20:38'!
createWith: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:20:38' prior: 50874857 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData withCatalog: catalog1.
	! !

!methodRemoval: XXX class #createWith: stamp: 'G.L.S 6/20/2021 19:20:38'!
createWith: aUserDataDictionary

	^self new initializeWith: aUserDataDictionary.!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 19:21:06'!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:21:06' prior: 50875002 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createFor: userData withCatalog: catalog1.
	! !

!methodRemoval: XXX class #createWith:withCatalog: stamp: 'G.L.S 6/20/2021 19:21:06'!
createWith: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:21:10'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:21:12'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:21:14'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:21:16'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:21:20'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:33'!
initializeWith: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:33' prior: 50875027!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary withCatalog: aCatalog.! !

!methodRemoval: XXX #initializeWith: stamp: 'G.L.S 6/20/2021 19:22:33'!
initializeWith: aUserDataDictionary

	datosUsuarios := aUserDataDictionary.!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:56'!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:56' prior: 50875083!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.! !

!methodRemoval: XXX #initializeWith:withCatalog: stamp: 'G.L.S 6/20/2021 19:22:56'!
initializeWith: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.!

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:23:12'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:23:11' prior: 50875094!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog .! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:23:13' prior: 50875121!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:23:27'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:23:29'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:23:31'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:23:32'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:23:41'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:24:54' prior: 50874939!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty. ! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:24:57'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:25:13' prior: 50875214!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:31:22' prior: 50874428!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:31:45'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:31:43' prior: 50875128!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:32:20'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog carts lastId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:32:13' prior: 50875263!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !

pepe add: 23 -> 25.!

pepe at:23.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:33:34' prior: 50874543!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:33:35'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:33:35'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:33:47' prior: 50875279!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:33:51' prior: 50875321!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:34:34' prior: 50875288!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:36'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:36'!
FAILURE!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:34:42'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:44'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:47'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:47'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:35:41' prior: 50875246!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1)! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:36:21' prior: 50875381!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1) -> (Cart createNewWithCatalog: catalog)
	lastId = lastId +1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:36:28' prior: 50875391!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1) -> (Cart createNewWithCatalog: catalog).
	lastId = lastId +1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:27' prior: 50875403!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:1000 -> (Cart createNewWithCatalog: catalog).! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:34' prior: 50875329!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new..! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:36' prior: 50875426!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:49:55' prior: 50874669!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:00' prior: 50875442!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	
	
	self error: self class errorCartIdDoesNotExist.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:09'!
assertCartExists: aCartID. 

	self error: self class errorCartIdDoesNotExist.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:20' prior: 50875448!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:50' prior: 50875455!
assertCartExists: aCartID. 

	(carts includesKey: aCartID) ifFalse: [self error: self class errorCartIdDoesNotExist.]! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:53' prior: 50875467!
assertCartExists: aCartID. 

	(carts includesKey: aCartID) ifFalse: [self error: self class errorCartIdDoesNotExist.].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:51:22' prior: 50875415!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:1000 -> (Cart createNewWithCatalog: catalog).
	
	^1000.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:02' prior: 50875461!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID. 
	
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:23' prior: 50875493!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID. 
	cart add: anItemID amount: anAmount.
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:24' prior: 50875500!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:32' prior: 50875509!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:33' prior: 50875518!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:45'!
listCart: aCartID 

	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:53:15' prior: 50875534!
listCart: aCartID 

	^(carts at: aCartID)
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:55:26' prior: 50875538!
listCart: aCartID 

	^(carts at: aCartID) itemListFor: self.
	! !
!Cart methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 19:57:06'!
itemListFor: aXXX! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:57:53'!
itemList
	^cartItems! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:58:02' prior: 50875543!
listCart: aCartID 

	^(carts at: aCartID) itemList.
	! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:58:12'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:58:14'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 20:00:07'!
test06

	| password usuario huboError cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	huboError := #No.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 20:00:22' prior: 50875564!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 20:00:46' prior: 50875034 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockXXX := XXX createFor: userData withCatalog: catalog1.
	! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/20/2021 20:00:52'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:01' prior: 50875481!
createCartForUser: aUser password: aPassword 
	
	| newId |
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	newId := lastId+1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := lastId + 1.
	
	^newId.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:19' prior: 50875616!
createCartForUser: aUser password: aPassword 
	
	| newId |
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:38' prior: 50875434!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/20/2021 20:02:43'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 20:02:46'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 20:02:47'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 20:02:49'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 20:02:51'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 20:02:52'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!methodRemoval: Cart #itemListFor: stamp: 'G.L.S 6/20/2021 20:04:06'!
itemListFor: aXXX!

----QUIT----(20 June 2021 20:06:33) CuisUniversity-4532.image priorSource: 17357356!

----STARTUP---- (21 June 2021 15:17:56) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:21:53' prior: 50875578!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:22:13'!
test06DifferentCartsCannotHaveTheSameId

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !

!methodRemoval: XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:22:13'!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:23:08'!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !

!methodRemoval: XXXTest #test05 stamp: 'G.L.S 6/21/2021 15:23:08'!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:29:13'!
test07

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:18' prior: 50875828!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:30' prior: 50875842!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:52'!
test07CannotListItemsOfUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !

!methodRemoval: XXXTest #test07 stamp: 'G.L.S 6/21/2021 15:30:52'!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].!

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:30:58'!
ERROR!
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:31:07'!
errorCartDoesNotExist
	self shouldBeImplemented.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:31:28' prior: 50875882!
errorCartDoesNotExist
	^'Error - No existe un carrito con ese Id'.! !

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:31:29'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:32:20' prior: 50875554!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self class errorCartDoesNotExist]) itemList.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:32:28' prior: 50875896!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartDoesNotExist]) itemList.
	! !

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:36'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:34:08'!
test07CannotListCartAnUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !

!methodRemoval: XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:34:08'!
test07CannotListItemsOfUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:34:18'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:35:44' prior: 50875800!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:36:54' prior: 50875958!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: 17 equals: cartList first first.
	self assert: smalltalk80 equals: cartList first second.! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:36:56'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:09' prior: 50875975!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:48' prior: 50875999!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:49' prior: 50876046!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:52' prior: 50876066!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.
	! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:38:00' prior: 50876086!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:38:19' prior: 50876132!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:12'!
itemListFor: aXXX
	^aXXX listCartItemsFor: cartItems.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:30' prior: 50875902!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartDoesNotExist]) itemListFor: self.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:57'!
listCartItemsFor: aCartItemList
	^aCartItemList
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:58' prior: 50876210!
listCartItemsFor: aCartItemList
	^aCartItemList.
	! !

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!methodRemoval: Cart #itemList stamp: 'G.L.S 6/21/2021 15:43:33'!
itemList
	^cartItems!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!classRenamed: #XXX as: #MockRestInterface stamp: 'G.L.S 6/21/2021 15:46:00'!
Smalltalk renameClassNamed: #XXX as: #MockRestInterface!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875337!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50874320!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50874458!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875592 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockXXX := MockRestInterface createFor: userData withCatalog: catalog1.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875934!
test07CannotListCartAnUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !

!classRenamed: #XXXTest as: #MockRestInterfaceTest stamp: 'G.L.S 6/21/2021 15:46:26'!
Smalltalk renameClassNamed: #XXXTest as: #MockRestInterfaceTest!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:50' prior: 50876198!
itemListFor: aMockRestInterface
	^aMockRestInterface listCartItemsFor: cartItems.! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 15:47:11'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876285!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876300!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50874954!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876273!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876338!
test07CannotListCartAnUnexistentCart
	
	self should: [mockInterface listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876316 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50875774!
test06DifferentCartsCannotHaveTheSameId

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockInterface createCartForUser: usuario password: password.
	cartId2 := mockInterface createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876152!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	[mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog
	^ [
	([
	(self coverAll:
		{58 to: 61}) new ] valueCoveringAll:
		{63 to: 65})
		initializeFor:
			(aUserDataDictionary
				cover: (82 to: 100)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (115 to: 122)
				declaredAt: (45 to: 52)) ] valueCoveringAll:
		{67 to: 80. 102 to: 113}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog
	(datosUsuarios _ aUserDataDictionary
		cover: (78 to: 96)
		declaredAt: (16 to: 34))
		cover: (61 to: 73)
		declaredAt: (61 to: 73).
	(catalog _ aCatalog
		cover: (111 to: 118)
		declaredAt: (49 to: 56))
		cover: (100 to: 106)
		declaredAt: (100 to: 106).
	(carts _ [
	(Dictionary
		cover: (131 to: 140)
		declaredAt: (131 to: 140)) new ] valueCoveringAll:
		{142 to: 144})
		cover: (122 to: 126)
		declaredAt: (122 to: 126).
	(lastId _ 0 coverAll:
		{158 to: 158})
		cover: (148 to: 153)
		declaredAt: (148 to: 153).! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	([
	([
	(datosUsuarios
		cover: (63 to: 75)
		declaredAt: (63 to: 75)) includesKey:
		(aUser
			cover: (90 to: 94)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{77 to: 88}) and: [
		[
		([
		(datosUsuarios
			cover: (104 to: 116)
			declaredAt: (63 to: 75)) at:
			(aUser
				cover: (121 to: 125)
				declaredAt: (20 to: 24)) ] valueCoveringAll:
			{118 to: 120}) =
			(aPassword
				cover: (130 to: 138)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
			{128 to: 128} ]] valueCoveringAll:
		{97 to: 100}) ifFalse: [
		[
		(self coverAll:
			{152 to: 155}) error:
			([
			([
			(self coverAll:
				{164 to: 167}) class ] valueCoveringAll:
				{169 to: 173}) errorWrongUserCredentials ] valueCoveringAll:
				{175 to: 199}) ] valueCoveringAll:
			{157 to: 162} ]] valueCoveringAll:
		{142 to: 149}.
	(newId _ [
	(lastId
		cover: (215 to: 220)
		declaredAt: (215 to: 220)) +
		(1 coverAll:
			{224 to: 224}) ] valueCoveringAll:
		{222 to: 222})
		cover: (206 to: 210)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (228 to: 232)
		declaredAt: (228 to: 232)) add:
		([
		(newId
			cover: (239 to: 243)
			declaredAt: (52 to: 56)) ->
			([
			(Cart
				cover: (250 to: 253)
				declaredAt: (250 to: 253)) createNewWithCatalog:
				(catalog
					cover: (277 to: 283)
					declaredAt: (277 to: 283)) ] valueCoveringAll:
				{255 to: 275}) ] valueCoveringAll:
			{246 to: 247}) ] valueCoveringAll:
		{234 to: 237}.
	(lastId _ newId
		cover: (300 to: 304)
		declaredAt: (52 to: 56))
		cover: (290 to: 295)
		declaredAt: (215 to: 220).
	^ newId
		cover: (311 to: 315)
		declaredAt: (52 to: 56).! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	[
	(self coverAll:
		{62 to: 65}) assertCartExists:
		(aCartID
			cover: (85 to: 91)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{67 to: 83}.
	(cart _ [
	(carts
		cover: (105 to: 109)
		declaredAt: (105 to: 109)) at:
		(aCartID
			cover: (115 to: 121)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{111 to: 113})
		cover: (97 to: 100)
		declaredAt: (54 to: 57).
	[
	(cart
		cover: (125 to: 128)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (135 to: 142)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (152 to: 159)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{130 to: 133. 144 to: 150}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
listCart: aCartID
	^ [
	([
	(carts
		cover: (24 to: 28)
		declaredAt: (24 to: 28))
		at:
			(aCartID
				cover: (34 to: 40)
				declaredAt: (11 to: 17))
		ifAbsent: [
			[
			(self coverAll:
				{53 to: 56}) error:
				([
				([
				(self coverAll:
					{65 to: 68}) class ] valueCoveringAll:
					{70 to: 74}) errorCartDoesNotExist ] valueCoveringAll:
					{76 to: 96}) ] valueCoveringAll:
				{58 to: 63} ]] valueCoveringAll:
		{30 to: 32. 42 to: 50}) itemListFor:
		(self coverAll:
			{113 to: 116}) ] valueCoveringAll:
		{100 to: 111}.! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCartDoesNotExist
	^ 'Error - No existe un carrito con ese Id' coverAll:
		{25 to: 65}.! !

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:55:13'!
assertUser: aUser existsWithPassword: aPassword.

	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:55:46' prior: 50875629!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:02:38'!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:03:17' prior: 50877430!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:16:13' prior: 50877445!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:14'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 16:16:24'!
listPurchasesForUser: aString withPassword: aString2 
	self shouldBeImplemented.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 16:16:55' prior: 50877480!
listPurchasesForUser: aUser withPassword: aPassword 
	
	self assertUser: aUser existsWithPassword: aPassword.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:17:42'!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:18:08' prior: 50877561!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:10'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:18:38' prior: 50877577!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!methodRemoval: MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:44'!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:22:46' prior: 50876403!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:48:00'!
test09

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:48:24' prior: 50877677!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '5678'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:03:57' prior: 50877684!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '1234'.
	
	
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:11' prior: 50877690!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:45' prior: 50877696!
test09

	| password |
	
	self should: [mockInterface ] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:52' prior: 50877710!
test09

	self should: [mockInterface ] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:06:16' prior: 50877720!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:07:50'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:07:51'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/21/2021 17:07:43' prior: 50876441 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:08:32'!
ERROR!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:08:32'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:08:41'!
checkOutCart: aSmallInteger withCreditCard: aString withExpirationDate: aString3 withOwner: aString4 
	self shouldBeImplemented.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:09:23' prior: 50877802!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	self assertCartExists: aCartId.! !

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:09:27'!
FAILURE!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:10:32' prior: 50876203!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartIdDoesNotExist]) itemListFor: self.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:10:37' prior: 50876429!
test07CannotListCartAnUnexistentCart
	
	self should: [mockInterface listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:10:42' prior: 50877730!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface class #errorCartDoesNotExist stamp: 'G.L.S 6/21/2021 17:10:47'!
errorCartDoesNotExist
	^'Error - No existe un carrito con ese Id'.!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:10:51'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:11:24'!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:11:24'!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:22:49'!
test10
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 17:22:53'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:23:51' prior: 50877916!
test10
	
	| password usuario|
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:01' prior: 50877926!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:31' prior: 50877935!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:49' prior: 50877946!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:26:11' prior: 50877957!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:27:24' prior: 50877969!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError = #No.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:27:50' prior: 50877982!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:02' prior: 50877996!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self assert: (mockInterface listPurchasesForUser: usuario withPassword: password) ! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe isEmpty .!

pepe isEmpty.!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:40' prior: 50878012!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty ! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:43' prior: 50878037!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty. ! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:56' prior: 50878056!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 17:32:10'!
ERROR!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:33:51'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:33:33' prior: 50877486!
listPurchasesForUser: aUser withPassword: aPassword 
	
	self assertUser: aUser existsWithPassword: aPassword.
	
	^userPurchases at: aUser.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:34:45' prior: 50875642!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [:aUser | userPurchases add: aUser -> Dictionary new.]! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:34:46' prior: 50878114!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [:aUser | userPurchases add: aUser -> Dictionary new.].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:38:20' prior: 50878075!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 17:38:29'!
FAILURE!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:41:02' prior: 50878126!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUser | 
			userPurchases add: aUser -> Dictionary new.
			aCatalog do:[
				:aCatalogItem |			
				(userPurchases at: aUser).
				]
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:42:24' prior: 50878162!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUser | 
			userPurchases add: aUser -> Dictionary new.
			(userPurchases at: aUser) add: 'total' -> 0.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:42:44' prior: 50878177!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'total' -> 0.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:43:11' prior: 50878191!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'total' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:46:54' prior: 50878138!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'total') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:47:00' prior: 50878220!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'total') = 0.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:48:13' prior: 50878206!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:48:20' prior: 50878241!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBook') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:48:21' prior: 50878277!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:48:36' prior: 50877810!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	
	self assertCartExists: aCartId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	self assertCartExists: aCartId.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32' prior: 50878298!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco' aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32' prior: 50877892!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' aMerchantProcesor: merchantProcessor] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner: stamp: 'G.L.S 6/21/2021 17:51:32'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	
	self assertCartExists: aCartId.!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 17:51:41'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:52:01' prior: 50878337!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:52:15' prior: 50878387!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:53:41' prior: 50878328!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:54:22' prior: 50878434!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:54:43' prior: 50878445!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01' prior: 50878410!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01' prior: 50878360!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:aMerchantProcesor: stamp: 'G.L.S 6/21/2021 17:55:01'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:56:15' prior: 50878474!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:57:21' prior: 50878543!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:58:46' prior: 50878558!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49' prior: 50878489!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor registerOn: salesbook.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49' prior: 50878513!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: salesbook] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor: stamp: 'G.L.S 6/21/2021 18:00:49'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:56' prior: 50878596!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:10' prior: 50878642!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:17' prior: 50878618!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:22' prior: 50878717!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:03:04' prior: 50878680!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:04:21' prior: 50878765!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:10:15' prior: 50877420!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> OrderedCollection new.
	
	(carts at: newId).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:10:27' prior: 50878813!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> OrderedCollection new.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:12:23' prior: 50878824!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21'!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21' prior: 50878702!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 forUser: usuario withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21' prior: 50878741!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor:registerOn: stamp: 'G.L.S 6/21/2021 18:13:21'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:13:31' prior: 50878872!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 forUser: '' withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:13:38' prior: 50878888!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 18:13:40'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:56' prior: 50878847!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases at: aUser
		].! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 put: 20.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 put: 20.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:17:39' prior: 50878983!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first put: ((userPurchases at: aUser) at: aBookAmountTuple ifAbsent:[0]) + aBookAmountTuple second)
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:18:07' prior: 50879015!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first 
			put: ((userPurchases at: aUser) at: aBookAmountTuple first ifAbsent:[0]) + aBookAmountTuple second)
		].! !

pepe _ Dictionary new.!

pepe at: 10 
	put: (pepe at:10 ifAbsent: [0] + (pepe at:10)).
!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:20:23' prior: 50879044!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first ifAbsentPut: aBookAmountTuple second). 
		].! !

pepe _ Dictionary new.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe !

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe !

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 10 ->0.!

pepe add: 10 ->0.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 10 -> 0.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe add: 10 -> 0.!

pepe at: 10 
	ifPresent: [:v | pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe at: 10.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:30:31' prior: 50879076!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:32:34' prior: 50879160!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:33:05' prior: 50879193!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:33:37'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:36:01' prior: 50878954!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:46:14' prior: 50879230!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	aMerchantProcessor registerCard: creditCard withBalance: 1000. 
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 18:47:23' prior: 50868509!
isCardRegistered: aCreditCard

	^registeredCards keys includes: aCreditCard.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:47:51' prior: 50879294!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!CreditCard methodsFor: 'nil' stamp: 'G.L.S 6/21/2021 18:48:15' overrides: 16881029!
= aCreditCard
	
	! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:49:48' prior: 50879374 overrides: 16881029!
= aCreditCard
	
	^ aCreditCard isNumber: creditCardNumber.! !
!CreditCard methodsFor: 'private' stamp: 'G.L.S 6/21/2021 18:50:24'!
isNumber: aCreditCardNumber.
	
	aCreditCardNumber = creditCardNumber.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:50:45'!
FAILURE!

registeredCards keys!

self at: 1!

registeredCards keys includes: aCreditCard!

registeredCards keys!

self at: 1.!

(self at: 1) includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today)!

self includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today)!
!CreditCard methodsFor: 'private' stamp: 'G.L.S 6/21/2021 18:58:58' prior: 50879384!
isNumber: aCreditCardNumber.
	
	^ aCreditCardNumber = creditCardNumber.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:03'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:03'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:16'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:16'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:19'!
FAILURE!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:23'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:23'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:35'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:35'!
FAILURE!

self listCart: aCartId!

userPurchases at: aUser!

aBookAmountTuple first !

userPurchases at:aUser!

(mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks'!

((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:32'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:32'!
FAILURE!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:03:45'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:03:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:04:26'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:04:26'!
FAILURE!

----QUIT----(21 June 2021 19:06:45) CuisUniversity-4532.image priorSource: 17410667!

----STARTUP---- (21 June 2021 19:06:50) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:06:53'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:07:15' prior: 50879269!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	"self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0."
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:07:16'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:07:23' prior: 50879510!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:08:48' prior: 50879538!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #No].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:08:57' prior: 50879563!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:08' prior: 50879588!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] value
		"on: Error 
		do: [huboError := #Si]."
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:09:10'!
ERROR!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:26' prior: 50879613!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.]
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:42' prior: 50879641!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:09:46'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:10:52'!
ERROR!

registeredCards at:aCreditCard!

registeredCards!

self keys.!

self keys at: 1!

self keys at: 1!

(self keys at: 1) = (CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: '')!

(self keys at: 1) = (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: '')!

self keys includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: '').!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:25'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:40'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:40'!
ERROR!

aMerchantProcessor isCardRegistered: aCreditCard!

aMerchantProcessor isCardRegistered: aCreditCard!

CreditCard!

(registeredCards keys at:1)!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:26:03'!
ERROR!

self at:(CreditCard forOwner: 't' withNumber: '0000000000000000' withExpirationDate: 'e')!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 19:30:40' prior: 50879338!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	aMerchantProcessor registerCard: creditCard withBalance: 1000. 
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:30:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:34:40' prior: 50868566!
can: aCreditCard spend: aTotal
	
	| storedCard |
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard  = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:34:46' prior: 50879802!
can: aCreditCard spend: aTotal
	
	| storedCard |
	
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard  = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:35:03' prior: 50879813!
can: aCreditCard spend: aTotal
	
	| storedCard |
	
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 19:36:40' prior: 50879724!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:36:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

----QUIT----(21 June 2021 19:42:16) CuisUniversity-4532.image priorSource: 17531182!

----STARTUP---- (22 June 2021 16:11:06) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:00:01' prior: 50879835!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:09:32' prior: 50879981!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:14' prior: 50880018!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:26' prior: 50880056!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	self updatePurchasesFor: cartUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:33' prior: 50880082!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:55'!
updatePurchasesFor: aUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:11:26' prior: 50880122!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:23:33' prior: 50880178!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:24:12'!
userOfCart: aCartId
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:25:18' prior: 50878837!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:28:25' prior: 50880266!
userOfCart: aCartId

	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:28:46' prior: 50877821!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartIdDoesNotExist]) first itemListFor: self.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:06' prior: 50880240!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := (carts at: aCartId) first.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:29' prior: 50880296!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:47'!
cartForId: aCartId

	^(carts at: aCartId) first.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:33' prior: 50880323!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:38' prior: 50880283!
userOfCart: aCartId
	self assertCartExists: aCartId.
	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:39' prior: 50880379!
userOfCart: aCartId

	self assertCartExists: aCartId.
	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:45' prior: 50880349!
cartForId: aCartId
	
	self assertCartExists: aCartId.
	^(carts at: aCartId) first.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:32:34' prior: 50880288!
listCart: aCartID 

	^(self cartForId: aCartID) itemListFor: self.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:32:38' prior: 50880397!
listCart: aCartId 

	^(self cartForId: aCartId) itemListFor: self.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:00'!
FAILURE!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:00'!
ERROR!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:15'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:15'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:33:43' prior: 50875526!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:33:49' prior: 50880458!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:35:41'!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal .
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:35:41' prior: 50880354!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: total.
! !

!methodRemoval: MockRestInterface #updatePurchasesFor:withCart: stamp: 'G.L.S 6/22/2021 17:35:41'!
updatePurchasesFor: aUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:36:29' prior: 50880531!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:36:43' prior: 50880576!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:40:06'!
test10CheckoutWorksAsExpected
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:40:06'!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:42:38'!
test11CannotUseACartAfterItExpired

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:44:16'!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterfaceTest #test10CheckoutWorksAsExpected stamp: 'G.L.S 6/22/2021 17:44:16'!
test10CheckoutWorksAsExpected
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:44:50' prior: 50880707!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:47:55' prior: 50880764!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:49:36' prior: 50880773!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:50:00' prior: 50880782!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:50:17' prior: 50880792!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:25'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard merchantProcessor timer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockTimer category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:30'!
Object subclass: #MockTimer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/22/2021 17:52:23' prior: 50877767 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := MockTimer new.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !
!MockTimer methodsFor: 'no messages' stamp: 'G.L.S 6/22/2021 17:52:39' overrides: 16896425!
initialize! !

!classDefinition: #MockTimer category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:50'!
Object subclass: #MockTimer
	instanceVariableNames: 'currentTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:52:49' prior: 50880878 overrides: 16896425!
initialize

	currentTime := 0.! !
!MockTimer methodsFor: 'nil' stamp: 'G.L.S 6/22/2021 17:53:37'!
passTime: anAmontOfTime

	currentTime + anAmontOfTime.! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:54:03'!
currentTime

	^currentTime.! !
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/22/2021 17:55:24'!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:55:24' prior: 50880847 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := MockTimer new.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!methodRemoval: MockRestInterface class #createFor:withCatalog: stamp: 'G.L.S 6/22/2021 17:55:24'!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.!
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:56:19'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterface class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:56:19' prior: 50880903!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer.! !

!methodRemoval: MockRestInterface #initializeFor:withCatalog: stamp: 'G.L.S 6/22/2021 17:56:19'!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:56:41'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:56:34' prior: 50880950!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:57:03' prior: 50880809!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 30.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:58:14' prior: 50880467!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:58:46' prior: 50881031!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	
	self updateCartTimerFor: aCartID.
	! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:59:17'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:59:15' prior: 50880270!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	cartTimer add: newId -> timer currentTime.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:59:33' prior: 50880998!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimer := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:59:38'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:59:38' prior: 50881060!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	cartTimers add: newId -> timer currentTime.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:59:38' prior: 50881075!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:02:24'!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	cartTimer := cartTimers at: aCartID.
	
	^ timer isDifferenceWith: cartTimer biggerThan: 30.
! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:02:35' prior: 50881132!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	
	cartTimer := cartTimers at: aCartID.
	
	^ timer isDifferenceWith: cartTimer biggerThan: 30.
! !
!MockTimer methodsFor: 'nil' stamp: 'G.L.S 6/22/2021 18:03:03'!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:04:53' prior: 50881147!
isDifferenceWith: aTime biggerThan: anAmountOfTime

	^ (currentTime - aTime) abs > anAmountOfTime.! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:05:01' prior: 50881152!
isDifferenceWith: aTime biggerThan: anAmountOfTime

	^ ((currentTime - aTime) abs > anAmountOfTime).! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:05:33' prior: 50881014!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:05:42'!
ERROR!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:05:42'!
ERROR!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:06:33'!
updateCartTimerFor: aCartID

	cartTimers at: aCartID put: timer currentTime.
	! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:06:45'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:06:45'!
FAILURE!
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/22/2021 18:07:18'!
errorCartExpired
	^ 'Error - El carrito utilizado expiró'.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:07:55' prior: 50881140!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	
	cartTimer := cartTimers at: aCartID.
	
	(timer isDifferenceWith: cartTimer biggerThan: 30) ifTrue: [self error: self class errorCartExpired].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:07:59'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:07:59'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:08:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:08:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:08:08'!
FAILURE!
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:09:16' prior: 50880894!
passTime: anAmontOfTime

	currentTime := currentTime + anAmontOfTime.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:09:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:09:22'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:09:47' prior: 50881166!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
		
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:10:31' prior: 50881249!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
		
	self should: [mockInterface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:10:32'!
FAILURE!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 18:11:20'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers itemList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:11:18' prior: 50880403!
listCart: aCartId 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	itemList := (self cartForId: aCartId) itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^itemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:12:35' prior: 50881311!
listCart: aCartId 
	
	| cartItemList |
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 18:12:50'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:12:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:13:01'!
FAILURE!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:13:01'!
FAILURE!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:14:16' prior: 50881040!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart add: anItemID amount: anAmount.
	
	self updateCartTimerFor: aCartID.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:14:31' prior: 50881320!
listCart: aCartId 
	
	| cartItemList |
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:18:12' prior: 50880719!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:18:16'!
FAILURE!

((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks')!
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/22/2021 18:19:07' prior: 50880511!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal .
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aTotal.
		].
! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:20:29' prior: 50881396!
listCart: aCartId 
	
	| cartItemList |
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:21:19' prior: 50881541!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := (self cartForId: aCartId). 
	
	cartItemList := cart itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:21:52' prior: 50881551!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := (self cartForId: aCartId). 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:23:13' prior: 50881562!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := self cartForId: aCartId. 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

----QUIT----(22 June 2021 18:32:30) CuisUniversity-4532.image priorSource: 17546330!

----STARTUP---- (24 June 2021 15:09:22) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:17:53'!
testFail: aBlock withErrorMessage: anErrorMessage

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:18:12' prior: 50881631!
testFail: aBlock withErrorMessage: anErrorMessage
	
	self should: aBlock 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:18:27' prior: 50881646!
testFail: aBlock withErrorMessage: anErrorMessage
	
	self should: aBlock 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:19:09' prior: 50876372!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self testFail: [mockInterface createCartForUser: usuario password: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:19:38' prior: 50876387!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
		
	self testFail: [mockInterface createCartForUser: usuarioNoExistente password: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:20:41' prior: 50876416!
test04CannotAddItemToAnUnexistentCart

	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]  withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:20:49' prior: 50881737!
test04CannotAddItemToAnUnexistentCart

	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:23:55' prior: 50877828!
test07CannotListCartAnUnexistentCart

	self testFail: [mockInterface listCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:24:35' prior: 50877460!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self testFail: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.
			! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:25:18' prior: 50878938!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 forUser: '' withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales]  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:26:11' prior: 50881274!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:26:12'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:26:12'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:33:45' prior: 50881448!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:35:08' prior: 50881970!
test11CannotUseACartAfterItExpired

	| password usuario cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	cartList := mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:36:17' prior: 50882146!
test11CannotUseACartAfterItExpired

	| password usuario cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	cartList := mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:36:27' prior: 50882210!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/24/2021 15:37:38' prior: 50880602!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:38:09' prior: 50882231!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:39:17' prior: 50882366!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:39:21' prior: 50882386!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:59:42' prior: 50882074!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/24/2021 16:00:44'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50881912!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales]  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50884869!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50882416!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!methodRemoval: MockRestInterface #checkOutCart:forUser:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor:registerOn: stamp: 'G.L.S 6/24/2021 16:00:44'!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{240 to: 243}) cartForId:
		(aCartId
			cover: (256 to: 262)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{245 to: 254})
		cover: (222 to: 235)
		declaredAt: (174 to: 187).
	(cartUser _ [
	(self coverAll:
		{278 to: 281}) userOfCart:
		(aCartId
			cover: (295 to: 301)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{283 to: 293})
		cover: (266 to: 273)
		declaredAt: (208 to: 215).
	(creditCard _ [
	(CreditCard
		cover: (319 to: 328)
		declaredAt: (319 to: 328))
		forOwner:
			(anOwner
				cover: (340 to: 346)
				declaredAt: (94 to: 100))
		withNumber:
			(aCreditCardNumber
				cover: (360 to: 376)
				declaredAt: (39 to: 55))
		withExpirationDate:
			(aDate
				cover: (398 to: 402)
				declaredAt: (77 to: 81)) ] valueCoveringAll:
		{330 to: 338. 348 to: 358. 378 to: 396})
		cover: (305 to: 314)
		declaredAt: (189 to: 198).
	(cashier _ [
	(Cashier
		cover: (419 to: 425)
		declaredAt: (419 to: 425)) withCatalog:
		(catalog
			cover: (440 to: 446)
			declaredAt: (440 to: 446)) ] valueCoveringAll:
		{427 to: 438})
		cover: (408 to: 414)
		declaredAt: (200 to: 206).
	[
	(self coverAll:
		{452 to: 455}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (489 to: 495)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{457 to: 487}.
	[
	(cashier
		cover: (501 to: 507)
		declaredAt: (200 to: 206))
		checkout:
			(cartToCheckout
				cover: (519 to: 532)
				declaredAt: (174 to: 187))
		withCreditCard:
			(creditCard
				cover: (553 to: 562)
				declaredAt: (189 to: 198))
		onDate:
			([
			(FixedGregorianDate
				cover: (575 to: 592)
				declaredAt: (575 to: 592)) today ] valueCoveringAll:
				{594 to: 598})
		registerOn:
			(aSalesBook
				cover: (614 to: 623)
				declaredAt: (155 to: 164))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (649 to: 666)
				declaredAt: (124 to: 141)) ] valueCoveringAll:
		{509 to: 517. 537 to: 551. 567 to: 573. 602 to: 612. 627 to: 647}.
	[
	(self coverAll:
		{672 to: 675})
		updatePurchasesFor:
			(cartUser
				cover: (697 to: 704)
				declaredAt: (208 to: 215))
		withCart:
			(aCartId
				cover: (716 to: 722)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (735 to: 748)
				declaredAt: (174 to: 187)) totalItemPrice ] valueCoveringAll:
				{750 to: 763}) ] valueCoveringAll:
		{677 to: 695. 706 to: 714. 724 to: 733}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!