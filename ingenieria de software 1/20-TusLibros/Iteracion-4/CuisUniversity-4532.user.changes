

----QUIT----(9 March 2021 14:58:42) CuisUniversity-4532.image priorSource: 13044060!

----STARTUP---- (9 March 2021 14:58:43) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4532.image!


----QUIT----(9 March 2021 14:58:43) CuisUniversity-4532.image priorSource: 16885479!

----STARTUP---- (7 June 2021 20:20:50) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/TDDStateIcon-setBalloonText.st----!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/7/2021 20:31:04'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

TestCase subclass: #TestXXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #TestXXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/7/2021 20:31:20'!
TestCase subclass: #TestXXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classRenamed: #TestXXX as: #XXXTest stamp: 'G.L.S 6/7/2021 20:31:35'!
Smalltalk renameClassNamed: #TestXXX as: #XXXTest!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:31:50'!
test01! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:38:42' prior: 50859369!
test01

	| badRequest result sistema |
	sistema := XXX start.
	
	result := sistema request: ''.
	
	badRequest := 0.
	
	self assert: result equals: badRequest
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/7/2021 20:40:10' prior: 50859372!
test01

	| badRequest result sistema |
	
	sistema := XXX start.
	
	result := sistema request: ''.
	
	badRequest := 400.
	
	self assert: result equals: badRequest
	! !

----QUIT----(7 June 2021 22:51:48) CuisUniversity-4532.image priorSource: 16885703!

----STARTUP---- (9 June 2021 17:05:28) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 17:14:22'!
Object subclass: #Carrito
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:14:28' prior: 50859380!
test01

	| carrito aPassword idCliente |
	
	idCliente := 0.
	aPassword := '1234'.
	
	carrito := Carrito forClient: idCliente withPassword: aPassword.
	
	self assert: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:25:44' prior: 50859401!
test01

	| carrito |
	
	carrito := Carrito createNew.
	
	self assert: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:33:25' prior: 50859410!
test01

	| carrito |
	
	carrito := Carrito createNew.
	
	self assert: carrito isEmpty.
	! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:33:28'!
ERROR!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 17:33:35'!
createNew
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeCreateNew! !
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 17:33:44' prior: 50859424!
createNew
	^self new initialize.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:33:45'!
ERROR!
!Carrito methodsFor: 'no messages' stamp: 'G.L.S 6/9/2021 17:33:55' overrides: 16896425!
initialize! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:34:10'!
ERROR!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:05'!
ERROR!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:36:17'!
isEmpty
	self shouldBeImplemented.! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:36:29' prior: 50859446!
isEmpty
	^true.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:30'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:30'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:33'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:36:33'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:37:04'!
test02

	| carrito |
	
	carrito := Carrito createNew.
	
	carrito add: 'libro'.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:38:35' prior: 50859462!
test02

	| carrito |
	
	carrito := Carrito createNew.
	
	carrito add: '978-3-16-148410-0'.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:39:18' prior: 50859469!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '978-3-16-148410-0'.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:39:21' prior: 50859476!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '978-3-16-148410-0'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:42:53' prior: 50859484!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:44:43'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 17:44:57'!
add: aString 
	self shouldBeImplemented.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 17:45:23'!
Object subclass: #Carrito
	instanceVariableNames: 'libro'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 17:45:21' prior: 50859502!
add: aString 
	libro := aString.! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:45:29'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 17:45:52' prior: 50859450!
isEmpty
	^libro isNil.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:45:59'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:48:24'!
test03

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	carrito add: unLibro.
	carrito add: unLibro.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	self assert: 4 equals: carrito size.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:50:24' prior: 50859492!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro amount: 1.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 17:50:28'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:51:06' prior: 50859541!
test02

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 17:56:53' prior: 50859530!
test03

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	
	self deny: carrito isEmpty.
	self assert: 4 equals: carrito listItems size.! !

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/TerseGuide.pck.st----!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:07:10' prior: 50859559!
test03

	| carrito unLibro tuplaLibroCant |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	carrito add: unLibro amount: 4.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:07:27'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:07:37'!
add: aString amount: aSmallInteger 
	self shouldBeImplemented.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:08:50'!
Object subclass: #Carrito
	instanceVariableNames: 'libro libros'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:09:00' prior: 50862511!
add: aString amount: aSmallInteger 
	| tuplaLibroCant |
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aString.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:09:08' prior: 50862524!
add: aString amount: aSmallInteger 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aString.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:09:39'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:04' prior: 50859439 overrides: 16896425!
initialize
	libros := OrderedCollection new.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:10:06'!
FAILURE!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:10:06'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:10:27' prior: 50859520!
isEmpty
	^libros isEmpty .! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:10:28' prior: 50862555!
isEmpty
	^libros isEmpty.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:46' prior: 50859514!
add: aString 
	self add: aString amount: 1.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:10:55' prior: 50862563!
add: aLibro 
	self add: aLibro amount: 1.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:05' prior: 50862534!
add: aLibro amount: aSmallInteger 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aLibro.
	tuplaLibroCant add: aSmallInteger.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:14' prior: 50862573!
add: aLibro amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aLibro.
	tuplaLibroCant add: anAmount.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:20' prior: 50862583!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	libros add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:29' prior: 50862568!
add: aBook 
	self add: aBook amount: 1.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:11:38'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862592!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862559!
isEmpty
	^books isEmpty.! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:11:38' prior: 50862546 overrides: 16896425!
initialize
	books := OrderedCollection new.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:11:50'!
ERROR!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:12:05'!
listItems
	^books! !
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:12:06' prior: 50862634!
listItems
	^books.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:12:11'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:13:51'!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:14:05' prior: 50862650!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:15:14' prior: 50862669!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := ''.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:15:36' prior: 50862688!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := '9780201184624'.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:39'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:16:57' prior: 50862494!
test03

	| carrito unLibro tuplaLibroCant |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	carrito add: unLibro amount: 4.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:16:58'!
PASSED!

!methodRemoval: XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:17:02'!
test04

	| carrito unLibro tuplaLibroCant unLibro2 unLibro3 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	unLibro2 := '9780201184624'.
	unLibro3 := ''.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 10.
	carrito add: unLibro3 amount: 100.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 3 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 10.
	
	self assert: tuplaLibroCant equals: carrito listItems second.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro3.
	tuplaLibroCant add: 100.
	
	self assert: tuplaLibroCant equals: carrito listItems third.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:19:00' prior: 50862758!
test03

	| carrito unLibro tuplaLibroCant unLibro2 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 1 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:19:34' prior: 50862813!
test03

	| carrito unLibro tuplaLibroCant unLibro2 |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:19:35'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:23:18'!
test04

	| carrito unLibro |
	
	carrito := Carrito createNew.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:24:47' prior: 50862861!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	
	
	carrito := Carrito createNewWithValidList: 12.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:25:15' prior: 50862869!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: ''.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:25:39' prior: 50862879!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:26:14' prior: 50862890!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:26:15' prior: 50862902!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	
	
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:27:00' prior: 50862913!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithValidList: librosValidos.
	
	unLibro := '9780201113723'.
	carrito add: unLibro.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:12' prior: 50862924!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := ''.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			] 
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:26' prior: 50862935!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			] 
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:31:30' prior: 50862949!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:31:35'!
ERROR!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:31:42'!
createNewWithAllowedList: anOrderedCollection 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeCreateNewWithAllowedList: anOrderedCollection ! !
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:31:57' prior: 50862981!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection ! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:32:00'!
ERROR!

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:32:10'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books orderedCollection'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:32:10'!
initializeWith: anOrderedCollection 
	self shouldBeImplemented.
	orderedCollection := anOrderedCollection.! !
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:32:19' prior: 50863007!
initializeWith: anOrderedCollection
	orderedCollection := anOrderedCollection.! !

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:32:26'!
Object subclass: #Carrito
	instanceVariableNames: 'libro books allowedBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Carrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:32:26' prior: 50863014!
initializeWith: anOrderedCollection
	allowedBooks := anOrderedCollection.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:32:30'!
FAILURE!
!Carrito class methodsFor: 'instance creation' stamp: 'G.L.S 6/9/2021 18:32:52' prior: 50862991!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:33:12' prior: 50862964!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:33:14'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:33:57' prior: 50862613!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !
!Carrito methodsFor: 'initialization' stamp: 'G.L.S 6/9/2021 18:34:17' prior: 50863028!
initializeWith: anOrderedCollection
	allowedBooks := anOrderedCollection.
	books := OrderedCollection new.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:34:33'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:34:33'!
ERROR!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/9/2021 18:34:46'!
errorBookNotInAllowedList
	self shouldBeImplemented.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/9/2021 18:35:13' prior: 50863079!
errorBookNotInAllowedList
	^'Error - El Libro no está en la lista de productos permitidos'.! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:14'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:19'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:35:57'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:35:57'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:35:57'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:36:03'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:03'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:37:07' prior: 50863042!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message == Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:10'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:37:20'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:37:25' prior: 50863110!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			anError message = Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:38:59'!
PASSED!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/9/2021 18:40:39'!
assertBookIsAllowed: aBook

	(allowedBooks includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:40:44'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:40:44'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:19' prior: 50863129!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := '9780201113723'.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:41:20'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:41:20'!
ERROR!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:20'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:41:25'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:42' prior: 50862830!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	carrito := Carrito createNew.
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:41:54' prior: 50863186!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	carrito := Carrito createNew.
	
	librosValidos := OrderedCollection new.
	librosValidos add: '9780201184624'.
	librosValidos add: '9780201113723'.
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.
	
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:42:37' prior: 50863211!
test03

	| carrito unLibro tuplaLibroCant unLibro2 librosValidos |
	
	unLibro := '9780201184624'.
	unLibro2 := '9780201113723'.	
	
	librosValidos := OrderedCollection new.
	librosValidos add: unLibro.
	librosValidos add: unLibro2.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: unLibro amount: 4.
	carrito add: unLibro2 amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:42:42'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:42:42'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:42:42'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:43:16'!
ERROR!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:43:16'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:43:16'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:43:51' prior: 50859551!
test02

	| carrito unLibro librosValidos |
	
	unLibro := '9780201113723'.
	
	librosValidos := OrderedCollection new.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:44:08' prior: 50863291!
test02

	| carrito unLibro librosValidos |
	
	unLibro := '9780201113723'.
	
	librosValidos := OrderedCollection new.
	librosValidos add: unLibro.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: unLibro.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:14'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:44:27' prior: 50859416!
test01

	| carrito |
	
	carrito := Carrito createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:28'!
PASSED!

!methodRemoval: Carrito #initialize stamp: 'G.L.S 6/9/2021 18:44:39'!
initialize
	books := OrderedCollection new.!

!methodRemoval: Carrito class #createNew stamp: 'G.L.S 6/9/2021 18:44:44'!
createNew
	^self new initialize.!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:44:51'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:48:07' overrides: 16927572!
setUp! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:39'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:40'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1 libro2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:48:41'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'libro1 libro2 libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:48:36' prior: 50863356 overrides: 16927572!
setUp

	libro1 := 0.
	libro2 := 0.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:49:13' prior: 50863382 overrides: 16927572!
setUp

	libro1 := '9780201113723'.
	libro2 := 0.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:49:23'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 libro2 libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:49:23' prior: 50863387 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	libro2 := 0.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:49:50' prior: 50863401 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	libro2 := '9780201184624'.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:06'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatters libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:06' prior: 50863407 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatters := '9780201184624'.
	libro3 := 0.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:16'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatterns libro3'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:16' prior: 50863422 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	libro3 := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:50:27' prior: 50863437 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	libro3 := '9780735619654'.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/9/2021 18:50:37'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/9/2021 18:50:37' prior: 50863444 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:51:05' prior: 50863301!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:51:08'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:51:59' prior: 50863238!
test03

	| carrito tuplaLibroCant unLibro2 librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: unLibro2.
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:52:23' prior: 50863488!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:27'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:52:47' prior: 50863157!
test04

	| carrito unLibro librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		unLibro := smalltalk80.
		carrito add: unLibro.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:52:48'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/9/2021 18:53:03' prior: 50863551!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorBookNotInAllowedList.
			].
	! !

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/9/2021 18:53:05'!
PASSED!

----QUIT----(9 June 2021 18:55:59) CuisUniversity-4532.image priorSource: 16887590!

----STARTUP---- (10 June 2021 13:32:39) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:34:03'!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountNotInteger.
			].
	! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:34:09'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:34:42' prior: 50863059!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	books add: tuplaLibroCant.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:34:49'!
ERROR!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:35:06'!
errorAmountNotInteger
	self shouldBeImplemented.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:35:33' prior: 50863638!
errorAmountNotInteger
	^'Error - La cantidad tiene que ser un número entero'.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:35:36'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:37:08'!
assertAmountIsValid: anAmount.

	anAmount isInteger ifFalse: [self error: self class errorAmountNotInteger].! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:37:13'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:37:17'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:37:40'!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountNegative.
			].
	! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:37:47'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:38:29' prior: 50863650!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:39:15' prior: 50863677!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifFalse: [self error: self class errorAmountNegative]. ! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:39:19' prior: 50863684!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifFalse: [self error: self class errorAmountNegative].! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:39:25'!
FAILURE!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:39:58'!
errorAmountNegative
	^'Error - '.! !
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:40:37' prior: 50863704!
errorAmountNegative
	^'Error - La cantidad no puede ser negativa'.! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:48'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:48'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:46:55'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:07'!
FAILURE!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:07'!
FAILURE!
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:47:49' prior: 50863693!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifTrue: [self error: self class errorAmountNegative].! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:47:54'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 13:48:15'!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Carrito createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Carrito errorAmountZero.
			].
	! !

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:48:32'!
FAILURE!
!Carrito class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 13:49:02'!
errorAmountZero
	^'Error - La cantidad de libros no puede ser 0'.! !
!Carrito methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 13:49:35' prior: 50863725!
assertAmountIsValid: anAmount.

	(anAmount isInteger) ifFalse: [self error: self class errorAmountNotInteger].
	(anAmount < 0) ifTrue: [self error: self class errorAmountNegative].
	(anAmount = 0) ifTrue: [self error: self class errorAmountZero].! !

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test04 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!testRun: #XXXTest #test07 stamp: 'G.L.S 6/10/2021 13:49:41'!
PASSED!

!classRenamed: #XXXTest as: #CarritoTest stamp: 'G.L.S 6/10/2021 13:49:54'!
Smalltalk renameClassNamed: #XXXTest as: #CarritoTest!

Object subclass: #ItemCarrito
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #ItemCarrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 13:51:48'!
Object subclass: #ItemCarrito
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #Carrito category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 13:52:04'!
Object subclass: #Carrito
	instanceVariableNames: 'books allowedBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!ItemCarrito class methodsFor: 'no messages' stamp: 'G.L.S 6/10/2021 14:01:18'!
for: aBook amount: anAmount

	^self initializeFor: aBook withAmount: anAmount.! !
!ItemCarrito methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 14:01:46'!
initializeFor: aBook withAmount: anAmount! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:02:13' prior: 50863814!
initializeFor: aBook withAmount: anAmount
	book = aBook.
	amount = anAmount.! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:02:16' prior: 50863819!
initializeFor: aBook withAmount: anAmount

	book = aBook.
	amount = anAmount.! !
!ItemCarrito methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 14:03:46'!
book
	^book.! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:03:55'!
amount
	^amount! !
!ItemCarrito methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:03:56' prior: 50863834!
amount
	^amount.! !

!classRenamed: #Carrito as: #Cart stamp: 'G.L.S 6/10/2021 14:05:03'!
Smalltalk renameClassNamed: #Carrito as: #Cart!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863608!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863660!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863514!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863467!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863323!
test01

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863577!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 14:05:03' prior: 50863736!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !

!testRun: #CarritoTest #test01 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test02 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test03 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test04 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test06 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!testRun: #CarritoTest #test07 stamp: 'G.L.S 6/10/2021 14:05:15'!
PASSED!

!classRenamed: #CarritoTest as: #CartTest stamp: 'G.L.S 6/10/2021 14:05:22'!
Smalltalk renameClassNamed: #CarritoTest as: #CartTest!

!testRun: #CartTest #test01 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test02 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test03 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test04 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test05 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test06 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!testRun: #CartTest #test07 stamp: 'G.L.S 6/10/2021 14:05:27'!
PASSED!

!classRenamed: #ItemCarrito as: #CartItem stamp: 'G.L.S 6/10/2021 14:05:39'!
Smalltalk renameClassNamed: #ItemCarrito as: #CartItem!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:06:27'!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	! !

!methodRemoval: CartTest #test01 stamp: 'G.L.S 6/10/2021 14:06:27'!
test01

	| carrito |
	
	carrito := Cart createNewWithAllowedList: ''.
	
	self assert: carrito isEmpty.
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:07:00'!
test02CartWithAnItemIsNotEmpty

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!methodRemoval: CartTest #test02 stamp: 'G.L.S 6/10/2021 14:07:00'!
test02

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:12:05'!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.! !

!methodRemoval: CartTest #test03 stamp: 'G.L.S 6/10/2021 14:12:05'!
test03

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito listItems size.
	self assert: tuplaLibroCant equals: carrito listItems first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito listItems second.!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:17:49'!
test04CartCannotAddItemsThatAreNotAllowed

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	! !

!methodRemoval: CartTest #test04 stamp: 'G.L.S 6/10/2021 14:17:49'!
test04

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			].
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:18:31'!
test05CartCannotAddANonIntegerAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	! !

!methodRemoval: CartTest #test05 stamp: 'G.L.S 6/10/2021 14:18:31'!
test05

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			].
	!

!classRemoval: #XXX stamp: 'G.L.S 6/10/2021 14:18:47'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:19:33'!
test06CartCannotAddANegativeAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	! !

!methodRemoval: CartTest #test06 stamp: 'G.L.S 6/10/2021 14:19:33'!
test06

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			].
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:20:05'!
test07CartCannotAddAZeroAmountOfAnItem

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !

!methodRemoval: CartTest #test07 stamp: 'G.L.S 6/10/2021 14:20:05'!
test07

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:37:11'!
PASSED!

!classRemoval: #CartItem stamp: 'G.L.S 6/10/2021 14:52:12'!
Object subclass: #CartItem
	instanceVariableNames: 'book amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:55:51'!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: aBook amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:56:14' prior: 50864222!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:16' prior: 50864164!
test07CartCannotAddAZeroAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 0.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountZero.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero. 
	! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:58:18'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:28' prior: 50864258!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero. 
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:29' prior: 50864305!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountZero.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:58:57' prior: 50864135!
test06CartCannotAddANegativeAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: -1.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNegative.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNegative.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:01'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:07' prior: 50864323!
test06CartCannotAddANegativeAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNegative.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:34' prior: 50864100!
test05CartCannotAddANonIntegerAmountOfAnItem

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80 amount: 1.5.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorAmountNotInteger.
			]."
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 14:59:36'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 14:59:42' prior: 50864379!
test05CartCannotAddANonIntegerAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: {smalltalk80.}  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 15:00:13' prior: 50864072!
test04CartCannotAddItemsThatAreNotAllowed

	"| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
	
	self should: [
		carrito add: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorBookNotInAllowedList.
			]."
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: {designPatterns.}  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:00:15'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 15:00:22' prior: 50864435!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: {designPatterns.}  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

----QUIT----(10 June 2021 15:03:38) CuisUniversity-4532.image priorSource: 17022446!

----STARTUP---- (10 June 2021 15:13:46) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 15:13:57'!
PASSED!

----QUIT----(10 June 2021 15:19:09) CuisUniversity-4532.image priorSource: 17050885!

----STARTUP---- (10 June 2021 15:27:47) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


pepe _ Dictionary new.!

pepe add: 'jorge'->5.!

pepe add: 'jorge'->5.!

pepe at: 'jorge'.!

----QUIT----(10 June 2021 15:30:31) CuisUniversity-4532.image priorSource: 17051833!

----STARTUP---- (10 June 2021 17:47:27) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 17:48:49' prior: 50864021!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithAllowedList: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !

!methodRemoval: Cart #listItems stamp: 'G.L.S 6/10/2021 17:48:59'!
listItems
	^books.!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:14' overrides: 16880927!
size
	^books size.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:24'!
first
	^books first.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 17:49:35'!
second
	^books second.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 17:49:57'!
PASSED!

----QUIT----(10 June 2021 18:15:03) CuisUniversity-4532.image priorSource: 17052120!

----STARTUP---- (10 June 2021 19:39:29) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 19:42:00'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:42:19'!
test01! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:47:05'!
test01CashierCannotCheckoutWithAnEmptyCart! !

!methodRemoval: CashierTest #test01 stamp: 'G.L.S 6/10/2021 19:47:13'!
test01!

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 19:52:27'!
Object subclass: #Cashier
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:52:16' prior: 50864623!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:52:49' prior: 50864637!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:56:32' prior: 50864650!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier card |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	card := '0000000000000000'.
	
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:57:31' prior: 50864663!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 19:57:42' prior: 50864677!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart] 
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 19:58:20'!
ERROR!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 19:58:37'!
errorCannotCheckoutEmptyCart
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 20:01:29' prior: 50864706!
errorCannotCheckoutEmptyCart
	^'Error - No se puede hacer checkout de un carrito vacío'.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:31'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:31'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:42'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:01:42'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:02:08' prior: 50864690!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/10/2021 20:08:00'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:09:16'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:09:16'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:20:12'!
test02
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:22:13' prior: 50864774!
test02
	
	| cart cashier catalog |
	
	catalog := Dictionary new.
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

pepe _ Dictionary new.!

pepe add: 'jorge' -> 5.!

pepe at: 'jorge'.!

 5 !

 5 !

 5 !

pepe at: 'jorge'.!

 5 !

pepe add: 'jorge' -> 2324254.!

pepe at: 'jorge'.!

 2324254 !

 2324254 !

 2324254 !

pepe at: 'jorge' put: 10.!

pepe at: 'jorge'.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:23:45' prior: 50864785!
test02
	
	| cart cashier catalog |
	
	catalog := Dictionary new.
	catalog add: '' -> 10.
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:09'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:10'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:24:11'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:24:05' overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:24:50' prior: 50864806!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: ''.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:25:28'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking aCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:25:26' prior: 50864844 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	aCatalog := Dictionary new.
	aCatalog add: smalltalk80 -> 10.
	aCatalog add: designPatterns -> 100.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:25:44' prior: 50864872 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	aCatalog := Dictionary new.
	aCatalog add: smalltalk80 -> 10.
	aCatalog add: designPatterns -> 100.
	aCatalog add: objectThinking -> 50.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:26:00'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:26:00' prior: 50864883 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:26:19'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:26:17' prior: 50864904 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	emptyCatalog := Dictionary new.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:26:37' prior: 50864851!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:27:31' prior: 50864937!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:31:02' prior: 50864949!
test02
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]."! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:31:09' prior: 50864731!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: ''.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:31:10'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:31:22'!
FAILURE!
!Cashier methodsFor: 'nil' stamp: 'G.L.S 6/10/2021 20:31:50'!
checkout: aCart! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:32:19' prior: 50864998!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:32:42'!
assertCartIsNotEmpty: aCart
	
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:33:20' prior: 50865007!
assertCartIsNotEmpty: aCart
	
	aCart isEmpty ifTrue: [self error: self class errorCannotCheckoutEmptyCart].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:33:23'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:33:41' prior: 50864964!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:37:27' prior: 50865022!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:10' prior: 50864925 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:13' prior: 50865053 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:40:39'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:40:35' prior: 50865066 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:41:47'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:41:52' prior: 50865088 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:42:16' prior: 50865112 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:42:33' prior: 50865037!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:43:16'!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!methodRemoval: CashierTest #test02 stamp: 'G.L.S 6/10/2021 20:43:16'!
test02
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {smalltalk80. designPatterns. objectThinking.}.
	cart add: smalltalk80.
	cart add: designPatterns.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:43:55' prior: 50865155!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/10/2021 20:44:13' prior: 50865187!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:44:17'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'G.L.S 6/10/2021 20:44:26'!
withCatalog: aDictionary 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithCatalog: aDictionary ! !
!Cashier class methodsFor: 'instance creation' stamp: 'G.L.S 6/10/2021 20:44:34' prior: 50865222!
withCatalog: aDictionary 
	^self new initializeWithCatalog: aDictionary. ! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:44:36'!
ERROR!

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:44:46'!
Object subclass: #Cashier
	instanceVariableNames: 'dictionary'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:44:46'!
initializeWithCatalog: aDictionary 
	self shouldBeImplemented.
	dictionary := aDictionary.! !
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:44:56' prior: 50865248!
initializeWithCatalog: aDictionary 
	dictionary := aDictionary.! !

!classDefinition: #Cashier category: 'Ejercicio-Libros' stamp: 'G.L.S 6/10/2021 20:45:01'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:45:01' prior: 50865254!
initializeWithCatalog: aDictionary 
	catalog := aDictionary.! !
!Cashier methodsFor: 'initialization' stamp: 'G.L.S 6/10/2021 20:45:21' prior: 50865267!
initializeWithCatalog: aCatalog 
	catalog := aCatalog.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:45:24'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:46:27' prior: 50865002!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:46:38'!
assertCartHasTheSameCatalog: aCart

	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:47:45' prior: 50865288!
assertCartHasTheSameCatalog: aCart

	aCart hasCatalog: catalog.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:48:20' prior: 50865293!
assertCartHasTheSameCatalog: aCart

	(aCart hasCatalog: catalog) ifFalse: [self error: self class].! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/10/2021 20:48:53'!
errorCannotCheckoutACartWithADifferentCatalog
	^'Error - No se puede hacer checkout de un carrito con un catálogo diferente'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/10/2021 20:49:32' prior: 50865299!
assertCartHasTheSameCatalog: aCart

	(aCart hasCatalog: catalog) ifFalse: [self error: self class errorCannotCheckoutACartWithADifferentCatalog].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:49:42'!
FAILURE!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:49:42'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/10/2021 20:50:27'!
hasCatalog: aCatalog
	^allowedBooks = aCatalog.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/10/2021 20:50:38'!
PASSED!

----QUIT----(10 June 2021 21:23:14) CuisUniversity-4532.image priorSource: 17054443!

----STARTUP---- (14 June 2021 17:15:25) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:01:44'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:01:45'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:34:59' prior: 50864979!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog .
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:35:00' prior: 50865359!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:35:01'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:43:09'!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote }.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:44:32' prior: 50865202!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: {donQuixote}.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:44:58' prior: 50865127 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:45:15' prior: 50865410!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:45:21'!
ERROR!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:45:21'!
ERROR!

pepe keys.!
!Cart methodsFor: 'operations' stamp: 'G.L.S 6/14/2021 18:45:59' prior: 50863146!
assertBookIsAllowed: aBook

	(allowedBooks keys includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 18:46:06'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 18:46:08'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:27' prior: 50865396!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:41' prior: 50865482!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 30.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:46:53' prior: 50865496!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:47:15' prior: 50865510!
test03
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 18:50:32' prior: 50865524!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 18:50:39'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:52:33' prior: 50865282!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^530.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:53:07' prior: 50865554!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:54:48' prior: 50865561!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 18:55:00'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:55:47'!
totalItemPrice
	self shouldBeImplemented.! !

pepe2 _ OrderedCollection new.!

pepe2 add: 2.!

pepe2 add: 5.!

pepe2 add: 6.!

pepe2!

pepe2 sum: [:val | val*2]!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 18:59:43' prior: 50865577!
totalItemPrice
	
	^books sum: [:bookAmountTuple | allowedBooks at: bookAmountTuple first].! !

!classDefinition: #Cart category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:00:17'!
Object subclass: #Cart
	instanceVariableNames: 'books catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865585!
totalItemPrice
	
	^books sum: [:bookAmountTuple | catalog at: bookAmountTuple first].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865328!
hasCatalog: aCatalog
	^catalog = aCatalog.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50863069!
initializeWith: anOrderedCollection
	catalog := anOrderedCollection.
	books := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:00:17' prior: 50865467!
assertBookIsAllowed: aBook

	(catalog keys includes: aBook) ifFalse:[self error: self class errorBookNotInAllowedList.].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:01:17' prior: 50865598!
totalItemPrice
	
	^books sum: [:bookAmountTuple | catalog at: bookAmountTuple first * bookAmountTuple second].! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:01:30'!
ERROR!

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:01:30'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:02:09' prior: 50865623!
totalItemPrice
	
	^books sum: [:bookAmountTuple | (catalog at: bookAmountTuple first) * bookAmountTuple second].! !

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:02:43'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:04:53'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:05:57' prior: 50865539!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:06:18'!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!methodRemoval: CashierTest #test03 stamp: 'G.L.S 6/14/2021 19:06:18'!
test03
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.!

!classDefinition: #Cart category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:08:23'!
Object subclass: #Cart
	instanceVariableNames: 'cartItems catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864571!
second
	^cartItems second.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864565 overrides: 16880927!
size
	^cartItems size.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:23' prior: 50864568!
first
	^cartItems first.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50865609!
initializeWith: anOrderedCollection
	catalog := anOrderedCollection.
	cartItems := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50865635!
totalItemPrice
	
	^cartItems sum: [:bookAmountTuple | (catalog at: bookAmountTuple first) * bookAmountTuple second].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50863625!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	cartItems add: tuplaLibroCant.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:08:24' prior: 50862622!
isEmpty
	^cartItems isEmpty.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:10:40'!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:10:53' prior: 50865731!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:12:30'!
Object subclass: #CreditCard
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:12:50' prior: 50865744!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:13:27' prior: 50865764!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:14:05' prior: 50865781!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart.
	
	self assert: 530 equals: result.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:34'!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:34' prior: 50865657!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865798!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''.
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865372!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:22:35' prior: 50865442!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!methodRemoval: Cashier #checkout: stamp: 'G.L.S 6/14/2021 19:22:35'!
checkout: aCart
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	^aCart totalItemPrice.!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:24:08'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:06' prior: 50865427 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:23' prior: 50865853!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:31' prior: 50865868!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard ]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:32' prior: 50865932!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:39' prior: 50865822!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard .
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:40' prior: 50865966!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:24:55' prior: 50865836!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result creditCard |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	"creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''."
	
	result := cashier checkout: cart withCreditCard: creditCard.
	
	self assert: 530 equals: result.! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:25:23'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:25:18' prior: 50865994!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	"creditCard := CreditCard for: 'Jorge' number: '000000000000' expirationDate: ''."
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:25:34' prior: 50865902 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := nil.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:25:36'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:25:39'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:26:11' prior: 50866022!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:28:47' prior: 50866039 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:28:58' prior: 50866078 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := nil.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:29:35' prior: 50866099 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !

FixedGregorianDate today.!

FixedGregorianDate yesterday .!

FixedGregorianDate yesterday. !

FixedGregorianDate tomorrow.!

FixedGregorianDate theBeginningOfTime .!

12/05/2021!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:26' prior: 50866120 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marcos' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:27' prior: 50866150 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:45' prior: 50866063!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier result|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: expiredCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:32:52' prior: 50866198!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: expiredCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 19:34:39' prior: 50866211!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:38:52'!
forOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeForOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:10' prior: 50866240!
forOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: aString withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:19' prior: 50866252!
forOwner: anOwner withNumber: aString2 withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: anOwner withNumber: aString2 withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:35' prior: 50866261!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aFixedGregorianDate
	^self new initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aFixedGregorianDate ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'G.L.S 6/14/2021 19:39:49' prior: 50866270!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^self new initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate ! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:13'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:13'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:40:14'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber date'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 19:40:14'!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	self shouldBeImplemented.
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	date := aDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 19:40:27' prior: 50866311!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	date := aDate.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:40:47'!
FAILURE!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/14/2021 19:41:47'!
errorExpiredCard
	^'Error - No se puede hacer checkout con una tarjeta de crédito vacía'.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:42:03'!
FAILURE!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:42:03'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:47:55' prior: 50865814!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:48:51' prior: 50866344!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!CreditCard methodsFor: 'nil' stamp: 'G.L.S 6/14/2021 19:49:09'!
isExpiredOn: aDate
! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:49:26' prior: 50866365!
isExpiredOn: aDate
	^ true.! !

!classDefinition: #CreditCard category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 19:49:48'!
Object subclass: #CreditCard
	instanceVariableNames: 'owner creditCardNumber expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:49:48' prior: 50866320!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 
	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:50:01' prior: 50866369!
isExpiredOn: aDate
	^ expirationDate < aDate.! !

FixedGregorianDate yesterday < FixedGregorianDate today.!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:50:47'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:01'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:01' prior: 50866223!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865918!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865980!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:02' prior: 50865949!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !

!methodRemoval: Cashier #checkout:withCreditCard: stamp: 'G.L.S 6/14/2021 19:52:02'!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: FixedGregorianDate today) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:52:13' prior: 50866401!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:52:28'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:53:26' prior: 50866491!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCardHasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:53:30' prior: 50866517!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCardHasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:02'!
assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:14' prior: 50866527!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:19' prior: 50866547!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:34'!
assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 19:54:34' prior: 50866560!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !

!methodRemoval: Cashier #assertCard:HasNotExpiredOn: stamp: 'G.L.S 6/14/2021 19:54:34'!
assertCard: aCreditCard HasNotExpiredOn: aDate.
	
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: self class errorExpiredCard].!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:54:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:54:49'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/14/2021 19:58:09'!
PASSED!

TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CreditCardTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/14/2021 21:19:44'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:20:12'!
test01! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:25'!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:22:32'!
FAILURE!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:54' prior: 50866646!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:22:56' prior: 50866661!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:22:57'!
FAILURE!
!CreditCard class methodsFor: 'nil' stamp: 'G.L.S 6/14/2021 21:23:40'!
errorOwnerEmpty
	^'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío'! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:24:13' prior: 50866382!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 

	self assertNameNotEmpty: anOwner.

	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:24:30'!
assertNameNotEmpty: anOwner
	
	anOwner! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:25:06' prior: 50866705!
assertNameNotEmpty: anOwner
	
	anOwner withBlanksTrimmed isEmpty ifTrue: [self error: self class errorOwnerEmpty].! !

!methodRemoval: CreditCardTest #test01 stamp: 'G.L.S 6/14/2021 21:26:36'!
test01!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:26:40'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:26:40'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:27:27'!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:27:54' prior: 50866726!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorNumberFormatNotCorrect].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:28:17' prior: 50866739!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:28:26'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:28:55'!
errorCardNumberLessThan16Digits
	^'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos'! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:28:57' prior: 50866771!
errorCardNumberLessThan16Digits
	^'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos'.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:30:19' prior: 50866696!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate 

	self assertNameNotEmpty: anOwner.
	self assertCardNumberIsCorrect: aCreditCardNumber.

	owner := anOwner.
	creditCardNumber := aCreditCardNumber.
	expirationDate := aDate.! !

'jorge' length .!

'jorge' size!
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:31:29'!
assertCardNumberIsCorrect: aCreditCardNumber

	(aCreditCardNumber size < 16) ifTrue: [self error: self class errorCardNumberLessThan16Digits].! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:31:36'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:31:50'!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:32:06' prior: 50866809!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberLessThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/14/2021 21:32:19' prior: 50866823!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits].! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:32:28'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/14/2021 21:32:51'!
errorCardNumberMoreThan16Digits
	^'Error - El número de la tarjeta de crédito tiene más de 16 dígitos'.! !
!CreditCard methodsFor: 'initialization' stamp: 'G.L.S 6/14/2021 21:35:08' prior: 50866797!
assertCardNumberIsCorrect: aCreditCardNumber

	(aCreditCardNumber size < 16) ifTrue: [self error: self class errorCardNumberLessThan16Digits].
	(aCreditCardNumber size > 16) ifTrue: [self error: self class errorCardNumberMoreThan16Digits].! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/14/2021 21:35:26'!
PASSED!

----QUIT----(14 June 2021 21:36:35) CuisUniversity-4532.image priorSource: 17078199!

----STARTUP---- (14 June 2021 21:36:47) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----QUIT----(14 June 2021 21:46:54) CuisUniversity-4532.image priorSource: 17127600!

----STARTUP---- (15 June 2021 17:04:11) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:49:07'!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:53:27' prior: 50866900!
test05CashierCheckoutRegistersSale
	
	| cart cashier sales|
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:53:52' prior: 50866918!
test05CashierCheckoutRegistersSale
	
	| cart cashier sales|
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:27' prior: 50866936!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	"sales := OrderedCollection new."
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 17:54:32'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:31' prior: 50866955!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:54:57' prior: 50866985!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866462!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866413!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866431!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50866447!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:55:35' prior: 50867004!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!methodRemoval: Cashier #checkout:withCreditCard:onDate: stamp: 'G.L.S 6/15/2021 17:55:35'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate  
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	^aCart totalItemPrice.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:56:17' prior: 50867103!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:56:39' prior: 50867132!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 17:57:21' prior: 50867147!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	sales := OrderedCollection new.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 17:57:25'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:58:23' prior: 50867022!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	aSalesBook add: aCart totalItemPrice.
	
	^aCart totalItemPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:58:52' prior: 50867184!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 17:59:02' prior: 50867196!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:01:39' prior: 50866174 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:01:49' prior: 50867163!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:01:52'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:05:43'!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:07:18'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:07:24'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:07:17' prior: 50867222 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcesor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:08:55' prior: 50867283!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:10:09'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor stolenCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:10:07' prior: 50867321 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcesor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867347!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867247!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867052!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart withCreditCard: expiredCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867087!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867033!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:11:53' prior: 50867071!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier new.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!methodRemoval: Cashier #checkout:withCreditCard:onDate:registerOn: stamp: 'G.L.S 6/15/2021 18:11:53'!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook   
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:12:03'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales merchantProcesor stolenCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:12:01' prior: 50867378 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcessor := MockMerchantProcesor new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:12:28'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:12:41' prior: 50867422!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:13:09'!
ERROR!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:13:23'!
errorStolenCard
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:14:00' prior: 50867626!
errorStolenCard
	^'Error - No se puede realizar una transacción con una tarjeta robada'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/15/2021 18:14:08' prior: 50867631!
errorStolenCard
	^'Error - No se puede realizar una transacción con una tarjeta robada'.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:14:10'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:15:15' prior: 50867408!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:15:25'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:15:25'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:15:45'!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor

	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:16:42' prior: 50867669!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor

	(aMerchantProcessor isCardStolen: aCreditCard) ifTrue: [self error: self class errorStolenCard].! !
!MockMerchantProcesor methodsFor: 'no messages' stamp: 'G.L.S 6/15/2021 18:17:01'!
isCardStolen: aCreditCard

	! !

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/15/2021 18:17:18'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: 'stolenCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:17:16' prior: 50867682!
isCardStolen: aCreditCard

	^stolenCards includes: aCreditCard.! !
!MockMerchantProcesor methodsFor: 'nil' stamp: 'G.L.S 6/15/2021 18:17:35' overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.! !
!MockMerchantProcesor methodsFor: 'nil' stamp: 'G.L.S 6/15/2021 18:18:55'!
registerStolenCard: aCreditCard! !
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/15/2021 18:19:08' prior: 50867706!
registerStolenCard: aCreditCard
	
	stolenCards add: aCreditCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:19:34' prior: 50867560 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: '1234567891011120'.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:03'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:03'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:20:37'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:21:33' prior: 50867603!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:36'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:36'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:43'!
FAILURE!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:21:43'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:22:58' prior: 50867717 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:23:04'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:23:07'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/15/2021 18:24:48'!
test06CashierCannotCheckoutAStolenCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!methodRemoval: CashierTest #test06CashierCannotCheckoutAStolen stamp: 'G.L.S 6/15/2021 18:24:48'!
test06CashierCannotCheckoutAStolen
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	!

----QUIT----(15 June 2021 18:37:18) CuisUniversity-4532.image priorSource: 17127794!

----STARTUP---- (16 June 2021 15:52:48) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:07:12'!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:08:17'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:15' prior: 50867793 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:32' prior: 50867895!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:08:59' prior: 50867929 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:09:25' prior: 50867965!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardNotRegistered.
			]
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:16:25'!
FAILURE!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:16:25'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:17:47' prior: 50868022!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog .
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:18:07' prior: 50868049!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 16:18:52'!
errorNotARegisteredCard
	^'Error - La tarjeta utilizada no se encuentra registrada'.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:19:04' prior: 50868070!
test07CashierCannotCheckoutWithAFakeCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:19:04'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:19:46' prior: 50867986 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard.
	! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:20:11'!
registerCard: aCreditCard 
	self shouldBeImplemented.! !

!classDefinition: #MockMerchantProcesor category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:20:36'!
Object subclass: #MockMerchantProcesor
	instanceVariableNames: 'stolenCards registeredCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:20:34' prior: 50868158!
registerCard: aCreditCard 
	registeredCards add: aCreditCard.! !
!MockMerchantProcesor methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:20:59' prior: 50867701 overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.
	registeredCards := OrderedCollection new.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:22:02' prior: 50867647!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:22:12'!
FAILURE!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:22:12'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 16:23:13'!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	(aMerchantProcessor isCardRegistered: aCreditCard) ifFalse: [self error: self class errorNotARegisteredCard].! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:23:39'!
isCardRegistered: aCreditCard
	^registeredCards includes: aCreditCard.! !
!Cashier methodsFor: 'private' stamp: 'G.L.S 6/16/2021 16:25:06' prior: 50868209!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	
	(aMerchantProcessor isCardRegistered: aCreditCard) ifFalse: [self error: self class errorNotARegisteredCard].! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:25:18'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:25:21'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 16:26:37'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:40:18'!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 16:44:48'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:44:42' prior: 50868120 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:45:00' prior: 50868262!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 16:52:09' prior: 50868339!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughMoney.
			]
	! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 16:53:01'!
errorCardDoesNotHaveEnoughMoney

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 16:53:18'!
FAILURE!
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 16:55:17' prior: 50868184!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	self assertCard: aCreditCard hasEnoughMoneyOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	aSalesBook add: total.
	
	^total.! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:02:31' prior: 50868391!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor    
	
	| total |
	
	self assertCartIsNotEmpty: aCart.
	self assertCartHasTheSameCatalog: aCart.
	self assertCard: aCreditCard hasNotExpiredOn: aDate.
	self assertCard: aCreditCard isNotStolenFor: aMerchantProcessor.
	self assertCard: aCreditCard isRegisteredOn: aMerchantProcessor.
	
	total := aCart totalItemPrice.
	
	self assertCard: aCreditCard canSpend: total on: aMerchantProcessor.
	
	aSalesBook add: total.
	
	^total.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:03:49'!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards add: aCreditCard.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 17:03:49' prior: 50868297 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!methodRemoval: MockMerchantProcesor #registerCard: stamp: 'G.L.S 6/16/2021 17:03:49'!
registerCard: aCreditCard 
	registeredCards add: aCreditCard.!
!MockMerchantProcesor methodsFor: 'initialization' stamp: 'G.L.S 6/16/2021 17:04:23' prior: 50868178 overrides: 16896425!
initialize

	stolenCards := OrderedCollection new.
	registeredCards := Dictionary new.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:04:41' prior: 50868431!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards at: aCreditCard -> aBalance.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:04:50' prior: 50868492!
registerCard: aCreditCard withBalance: aBalance  
	registeredCards add: aCreditCard -> aBalance.! !

pepe _ Dictionary new.!

pepe add: 'jorge' -> 2324254.!

pepe at: 'jorge'.!

 2324254 !

 2324254 !

 2324254 !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:05:25' prior: 50868217!
isCardRegistered: aCreditCard
	^registeredCards keys includes: aCreditCard.! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:06:00'!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor! !
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:06:50' prior: 50868514!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	
	(aMerchantProcessor can: aCreditCard spend: aTotal) ifFalse: [self error: self class errorCardDoesNotHaveEnoughMoney]! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 6/16/2021 17:07:06'!
errorCardDoesNotHaveEnoughBalance

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 17:07:06' prior: 50868360!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughBalance.
			]
	! !

!methodRemoval: Cashier class #errorCardDoesNotHaveEnoughMoney stamp: 'G.L.S 6/16/2021 17:07:06'!
errorCardDoesNotHaveEnoughMoney

	^'Error - La tarjeta de crédito no tiene suficiente saldo'.!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:07:19'!
FAILURE!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:08:12'!
can: aCreditCard spend: aTotal

	^ (registeredCards at:aCreditCard) >= aTotal.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:33'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:33'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:08:38'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:38'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:38'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:08:43'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:43'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:08:43'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:09:26' prior: 50868438 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:29'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:29'!
FAILURE!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:09:43'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:43'!
FAILURE!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:09:43'!
FAILURE!

(registeredCards at:aCreditCard) >= aTotal!
!Cashier methodsFor: 'operations' stamp: 'G.L.S 6/16/2021 17:21:01' prior: 50868519!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	
	(aMerchantProcessor can: aCreditCard spend: aTotal) ifFalse: [self error: self class errorCardDoesNotHaveEnoughBalance]! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:06'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:21:10'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:30:56'!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:31:24' prior: 50868774!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: aBlockToFail 
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = anErrorMessage].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:31:36' prior: 50868788!
testCreditCardFail: aBlockToFail withErrorMessage: anErrorMessage
	
	self should: aBlockToFail 
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = anErrorMessage].! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:12' prior: 50866674!
test01CreditCardCannotHaveEmptyOwner
	
	self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty].
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:23' prior: 50868808!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
		
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:25' prior: 50868826!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:31' prior: 50868844!
test01CreditCardCannotHaveEmptyOwner
	
	"self should: [CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorOwnerEmpty]."
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:32:33'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:32:43' prior: 50868862!
test01CreditCardCannotHaveEmptyOwner
	
	self testCreditCardFail: [CreditCard forOwner: '' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate today] 
		withErrorMessage: CreditCard errorOwnerEmpty.! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:33:28' prior: 50866753!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today] 
		 withErrorMessage: CreditCard errorCardNumberLessThan16Digits! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:33:30' prior: 50868905!
test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: ''  withExpirationDate: FixedGregorianDate today] 
		 withErrorMessage: CreditCard errorCardNumberLessThan16Digits.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:33:33'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:40' prior: 50866837!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	"self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits]."
		
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits ! !
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:42' prior: 50868943!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	"self should: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]  
		raise: Error - MessageNotUnderstood
		withExceptionDo: [
			:anError |
			self assert: anError messageText = CreditCard errorCardNumberMoreThan16Digits]."
		
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 17:34:43'!
PASSED!
!CreditCardTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:34:49' prior: 50868964!
test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits
	
	self testCreditCardFail: [CreditCard forOwner: 'Jorge' withNumber: '00000000000000001'  withExpirationDate: FixedGregorianDate today]
		withErrorMessage: CreditCard errorCardNumberMoreThan16Digits.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:44:32' prior: 50867517!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog .
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:44:33' prior: 50869012!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart withCreditCard: workingCreditCard onDate: FixedGregorianDate today registerOn: sales forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:44:33'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:45:46' prior: 50869030!
test01CashierCannotCheckoutWithAnEmptyCart
	
	| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:46:03' prior: 50867497!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:46:45' prior: 50867480!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:46:47'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:47:04' prior: 50867460!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:47:28' prior: 50867442!
test05CashierCheckoutRegistersSale
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1).! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:53:12'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:54:37' prior: 50869206!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 17:55:03'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:02' prior: 50868644 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	listToAdd := Dictionary new.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:17' prior: 50869268 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	listToAdd := Dictionary new.
	listToAdd add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 17:55:44'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd emptyListToAdd'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:55:42' prior: 50869314 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:57:21'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCart:withCatalog:withItems:withCreditCard:ThrowingError: stamp: 'G.L.S 6/16/2021 17:57:28'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCart: aCart withCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:58:33' prior: 50869080!
test01CashierCannotCheckoutWithAnEmptyCart
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: emptyCatalog.
	
	cart := Cart createNewWithAllowedList: emptyCatalog.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutEmptyCart.
			]."
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutWithCartwithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:58:34'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 17:58:57' prior: 50869476!
test01CashierCannotCheckoutWithAnEmptyCart
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutWithCartwithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 17:58:58'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:00:37' prior: 50869099!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: ''
		withCreditCard:  '' 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:00:56' prior: 50869376 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:01:26'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd emptyListToAdd listToAdd2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:24' prior: 50869603 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:46' prior: 50869576!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog2.
	cart add: donQuixote.
	
	self should: [cashier checkout: cart 
					withCreditCard: workingCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = Cashier errorCannotCheckoutACartWithADifferentCatalog.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:01:47'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:01:54' prior: 50869716!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:03:56' prior: 50869169!
test04CashierCannotCheckOutWithAnExpiredCard
	
	| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			].
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:03' prior: 50869788!
test04CashierCannotCheckOutWithAnExpiredCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: expiredCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]  
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorExpiredCard.
			]."
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:04:08'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:23' prior: 50869666 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:04:30'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:04:36' prior: 50869814!
test04CashierCannotCheckOutWithAnExpiredCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:05:45' prior: 50867849!
test06CashierCannotCheckoutAStolenCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: stolenCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.] 
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorStolenCard.
			]"
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:05:51'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:05:59' prior: 50869967!
test06CashierCannotCheckoutAStolenCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:32' prior: 50868096!
test07CashierCannotCheckoutWithAFakeCard
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: fakeCreditCard 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorNotARegisteredCard.
			]"
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:06:35'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:41' prior: 50870035!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:53' prior: 50870093!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorStolenCard .
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:06:54'!
FAILURE!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:06:59' prior: 50870104!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard .
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:00' prior: 50870118!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:03' prior: 50870129!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:03'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:07:54' prior: 50868535!
test08CashierCannotCheckoutWithACardWithoutMoney
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	self should: [cashier checkout: cart 
					withCreditCard: creditCardWithoutMoney 
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor.]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = Cashier errorCardDoesNotHaveEnoughBalance.
			]."
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance .
	! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:07:56'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:08:04' prior: 50870182!
test08CashierCannotCheckoutWithACardWithoutMoney
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutWithCartwithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance.
	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:08:57'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	cashier checkout: cart 
			withCreditCard: aCreditCard
			onDate: FixedGregorianDate today 
			registerOn: sales 
			forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:09:02' prior: 50870253!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:09:40' prior: 50870274!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:10:04' prior: 50870295!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:10:34' prior: 50870316!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:11:38' prior: 50869120!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:12:43'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCartwithCatalog:withItems:withCreditCard:Asserting: stamp: 'G.L.S 6/16/2021 18:12:50'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:13:22'!
testCashierWithCatalog: aCatalog cannotCheckoutCartWithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870140!
test07CashierCannotCheckoutWithAFakeCard
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: fakeCreditCard 
		ThrowingError: Cashier errorNotARegisteredCard.
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870025!
test06CashierCannotCheckoutAStolenCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: stolenCreditCard 
		ThrowingError: Cashier errorStolenCard.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50870242!
test08CashierCannotCheckoutWithACardWithoutMoney
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2 
		withCreditCard: creditCardWithoutMoney 
		ThrowingError: Cashier errorCardDoesNotHaveEnoughBalance.
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869533!
test01CashierCannotCheckoutWithAnEmptyCart
		
	self testCashierWithCatalog: emptyCatalog 
		cannotCheckoutCartWithCatalog: emptyCatalog 
		withItems: emptyListToAdd 
		withCreditCard: workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutEmptyCart.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869776!
test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog
		
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog2 
		withItems: listToAdd 
		withCreditCard:  workingCreditCard 
		ThrowingError: Cashier errorCannotCheckoutACartWithADifferentCatalog! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:13:22' prior: 50869956!
test04CashierCannotCheckOutWithAnExpiredCard
	
	self testCashierWithCatalog: catalog1 
		cannotCheckoutCartWithCatalog: catalog1 
		withItems: listToAdd2  
		withCreditCard: expiredCreditCard 
		ThrowingError: Cashier errorExpiredCard.! !

!methodRemoval: CashierTest #testCashierWithCatalog:cannotCheckoutWithCartwithCatalog:withItems:withCreditCard:ThrowingError: stamp: 'G.L.S 6/16/2021 18:13:22'!
testCashierWithCatalog: aCatalog cannotCheckoutWithCartwithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:13:29'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:13:31'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:14:14' prior: 50870359!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result.
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [self assert: 530 equals: result.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:14:52' prior: 50870572!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	"cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [self assert: 530 equals: result.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:20' prior: 50870376!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:27' prior: 50870617!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:45' prior: 50870594!
test03CheckoutReturnsTheRightAmount
	
	| cart cashier result |
	
	"cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:15:54' prior: 50870659!
test03CheckoutReturnsTheRightAmount
	
	"| cart cashier result |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	result := cashier checkout: cart 
				withCreditCard: workingCreditCard 
				onDate: FixedGregorianDate today 
				registerOn: sales 
				forMerchantProcessor: merchantProcessor.
	
	self assert: 530 equals: result."
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:15:56'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:16:03' prior: 50870682!
test03CheckoutReturnsTheRightAmount
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:17:35' prior: 50869189!
test05CashierCheckoutRegistersSale
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1)."
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		Asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:17:44'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:18:05'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:18:05' prior: 50870736!
test03CheckoutReturnsTheRightAmount
	
	self testCashierWithCatalog: catalog1 
		checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self assert: 530 equals: aResult.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:18:05' prior: 50870746!
test05CashierCheckoutRegistersSale
	
	"| cart cashier |
	
	cashier := Cashier withCatalog: catalog1.
	
	cart := Cart createNewWithAllowedList: catalog1 .
	cart add: smalltalk80 amount: 3.
	cart add: designPatterns amount: 5.
	
	cashier checkout: cart 
		withCreditCard: workingCreditCard 
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
	
	self deny: sales isEmpty.
	self assert: 530 equals: (sales at: 1)."
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !

!methodRemoval: CashierTest #testCashierWithCatalog:checkoutCartWithItems:withCreditCard:Asserting: stamp: 'G.L.S 6/16/2021 18:18:05'!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard Asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithAllowedList: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:19:13' prior: 50870832!
test05CashierCheckoutRegistersSale
	
	self testCashierWithCatalog: catalog1 
	 	checkoutCartWithItems: listToAdd2 
		withCreditCard: workingCreditCard 
		asserting: [:aResult | self deny: sales isEmpty.
						self assert: 530 equals: (sales at: 1)].! !
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
createNewWithAllowedList: anOrderedCollection
	^ [
	([
	(self coverAll:
		{50 to: 53}) new ] valueCoveringAll:
		{55 to: 57}) initializeWith:
		(anOrderedCollection
			cover: (75 to: 93)
			declaredAt: (27 to: 45)) ] valueCoveringAll:
		{59 to: 73}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:20:06'!
PASSED!
!Behavior method!
createNewWithAllowedList: anOrderedCollection
	^ [
	([
	(self coverAll:
		{50 to: 53}) new ] valueCoveringAll:
		{55 to: 57}) initializeWith:
		(anOrderedCollection
			cover: (75 to: 93)
			declaredAt: (27 to: 45)) ] valueCoveringAll:
		{59 to: 73}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:20:45'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:20:45'!
ERROR!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:20:45'!
FAILURE!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:20:45'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:21:01'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:21:01'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:21:01'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:21:01'!
FAILURE!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:10'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:11'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:13'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:22:20'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 catalog2 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:09' prior: 50863460 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:45' prior: 50872100 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:22:57' prior: 50863989!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithAllowedList: emptyCatalog.
	
	self assert: carrito isEmpty.
	! !
!Cart class methodsFor: 'instance creation' stamp: 'G.L.S 6/16/2021 18:26:27'!
createNewWithCatalog: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50870801!
testCashierWithCatalog: aCatalog checkoutCartWithItems: aListOfItemsAndAmounts withCreditCard: aCreditCard asserting: anAssertionBlock
	
	| cart cashier result |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithCatalog: aCatalog.
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem).].
	
	result := cashier checkout: cart 
		withCreditCard: aCreditCard
		onDate: FixedGregorianDate today 
		registerOn: sales 
		forMerchantProcessor: merchantProcessor.
		
	anAssertionBlock value: result.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50870419!
testCashierWithCatalog: aCatalog cannotCheckoutCartWithCatalog: aCartCatalog withItems: aListOfItemsAndAmounts withCreditCard: aCreditCard ThrowingError: anErrorMessage
	
	| cart cashier |
	
	cashier := Cashier withCatalog: aCatalog.
	
	cart := Cart createNewWithCatalog: aCartCatalog .
	
	aListOfItemsAndAmounts keysDo: [:anItem | cart add: anItem amount: (aListOfItemsAndAmounts at: anItem)].
	
	self should: [cashier checkout: cart 
					withCreditCard: aCreditCard
					onDate: FixedGregorianDate today 
					registerOn: sales 
					forMerchantProcessor: merchantProcessor]
		raise: Error 
		withExceptionDo: [
			:anError | 
			self assert: anError messageText = anErrorMessage.
			].! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864536!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80.
	librosValidos add: designPatterns.
	
	carrito := Cart createNewWithCatalog: librosValidos.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864001!
test02CartWithAnItemIsNotEmpty

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	librosValidos add: smalltalk80 .
	
	carrito := Cart createNewWithCatalog: librosValidos.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50872130!
test01CartThatWasJustCreatedIsEmpty

	| carrito |
	
	carrito := Cart createNewWithCatalog: emptyCatalog.
	
	self assert: carrito isEmpty.
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/16/2021 18:26:27' prior: 50864240!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito librosValidos |
	
	librosValidos := OrderedCollection new.
	aBookList do: [:aBookToAllow | librosValidos add: aBookToAllow.].
	
	carrito := Cart createNewWithCatalog: librosValidos.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !

!methodRemoval: Cart class #createNewWithAllowedList: stamp: 'G.L.S 6/16/2021 18:26:27'!
createNewWithAllowedList: anOrderedCollection 
	^self new initializeWith: anOrderedCollection.!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:26:30'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:26:33'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:26:35'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:35'!
ERROR!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:26:35'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:35'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:26:53' prior: 50872217!
test02CartWithAnItemIsNotEmpty

	| carrito |
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	
	self deny: carrito isEmpty.
	! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:26:57'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:26:57'!
ERROR!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:26:57'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:27:10' prior: 50872115 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:27:24'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1 donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:28:50' prior: 50872190!
test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts

	| carrito tuplaLibroCant |
	
	carrito := Cart createNewWithCatalog: catalog1.
		
	carrito add: smalltalk80 amount: 4.
	carrito add: designPatterns amount: 2.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: smalltalk80.
	tuplaLibroCant add: 4.
	
	self deny: carrito isEmpty.
	self assert: 2 equals: carrito size.
	self assert: tuplaLibroCant equals: carrito first.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: designPatterns .
	tuplaLibroCant add: 2.
	
	self assert: tuplaLibroCant equals: carrito second.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:28:54'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:28:54'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:29:34' prior: 50872236!
testCartFailToAdd: aBook withAmount: anAmount whileAllowing: aBookList expectingErrorMessage: anErrorMessage

	| carrito |
	
	carrito := Cart createNewWithCatalog: aBookList.
	
	self should: [
		carrito add: aBook amount: anAmount.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:29:55' prior: 50864482!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:29:57'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:26' prior: 50872446!
test04CartCannotAddItemsThatAreNotAllowed
		
	self testCartFailToAdd: smalltalk80 
		withAmount: 1
		whileAllowing: emptyCatalog 
		expectingErrorMessage: Cart errorBookNotInAllowedList.
	! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:27'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:27'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:36' prior: 50864426!
test05CartCannotAddANonIntegerAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 1.5
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountNotInteger.
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:40' prior: 50864370!
test06CartCannotAddANegativeAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: -1
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountNegative.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:30:46' prior: 50864314!
test07CartCannotAddAZeroAmountOfAnItem
	
	self testCartFailToAdd: smalltalk80 
		withAmount: 0
		whileAllowing: catalog1  
		expectingErrorMessage: Cart errorAmountZero.
	! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:30:55'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:30:59'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:31:01'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 6/16/2021 18:31:30' prior: 50872359 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.! !

!classDefinition: #CartTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/16/2021 18:31:37'!
TestCase subclass: #CartTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:31:39'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:32:27'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:32:28'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/16/2021 18:33:54'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/16/2021 18:33:55'!
PASSED!

----QUIT----(16 June 2021 20:12:33) CuisUniversity-4532.image priorSource: 17159611!

----STARTUP---- (17 June 2021 20:37:52) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/17/2021 20:52:45'!
TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'no messages' stamp: 'G.L.S 6/17/2021 20:52:59'!
test01
! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 20:59:52' prior: 50873901!
test01

	| invalidID |
	invalidID := '00000000' ! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:00:00' prior: 50873904!
test01

	| invalidID |
	
	invalidID := '00000000' ! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:00:52' prior: 50873909!
test01

	| invalidID |
	
	invalidID := '0000000000'.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:02:19' prior: 50873914!
test01

	| invalidID |
	
	invalidID := '0000000000'.
	
	self should: [] 
		raise: Error  
		withExceptionDo: [
			:anError |
			] ! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/17/2021 21:21:12'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:22:44' prior: 50873919!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError errorMessage = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:23:15'!
ERROR!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:23:35' prior: 50873933!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:23:37'!
ERROR!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/17/2021 21:23:58'!
errorWrongUserCredentials
	self shouldBeImplemented.! !
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/17/2021 21:24:23' prior: 50873963!
errorWrongUserCredentials
	^'Error - Las credenciales del usuario no son correctas'.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:24:30'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:24:45' prior: 50873948!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:24:46'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:24:56'!
createCartUser: aString password: aString2 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:25:11' prior: 50873992!
createCartUser: aUser password: aPassword 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:29:28' prior: 50873998!
createCartUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:29:40'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:30:15'!
createCartForUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:30:15' prior: 50873976!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText = XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXX #createCartUser:password: stamp: 'G.L.S 6/17/2021 21:30:15'!
createCartUser: aUser password: aPassword 
	
	self error: [self class errorWrongUserCredentials].!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:30:23'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/17/2021 21:32:02' prior: 50874019!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:32:02'!
FAILURE!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:32:20'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/17/2021 21:33:23' prior: 50874012!
createCartForUser: aUser password: aPassword 
	
	self error: self class errorWrongUserCredentials.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/17/2021 21:33:27'!
PASSED!

----QUIT----(17 June 2021 22:08:36) CuisUniversity-4532.image priorSource: 17351466!

----STARTUP---- (20 June 2021 16:49:08) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 16:51:31'!
PASSED!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 16:51:32'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:52:03'!
test02

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:53:37' prior: 50874078!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 16:53:45'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 16:55:36' prior: 50874092!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface := XXX new.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 16:56:55'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:56:53' prior: 50874060!
createCartForUser: aUser password: aPassword 
	
	(datosUsuarios at:aUser = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 16:57:13' overrides: 16896425!
initialize

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:57:37' prior: 50874127!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios at:aUser) = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:58:09' prior: 50874135 overrides: 16896425!
initialize

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:59:26'!
initializeWith: aUserDataDictionary

	datosUsuarios := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 16:59:31' prior: 50874153!
initializeWith: aUserDataDictionary

	datosUsuarios := aUserDataDictionary.! !

!methodRemoval: XXX #initialize stamp: 'G.L.S 6/20/2021 16:59:39'!
initialize

	datosUsuarios := Dictionary new.!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 17:00:55'!
createWith: aUserDataDictionary

	^self initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:01:43' prior: 50874041!
test01

	| mockInterface password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:01:52' prior: 50874107!
test02

	| mockInterface password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 17:02:17'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 17:02:16' overrides: 16927572!
setUp
	
	mockXXX := XXX new.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:02:43' prior: 50874174!
test01

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:02:52' prior: 50874187!
test02

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 17:03:19'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 17:03:25' prior: 50874206 overrides: 16927572!
setUp
	
	userData := Dictionary new.
	
	mockXXX := XXX createWith: userData.! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 17:04:06' prior: 50874242 overrides: 16927572!
setUp
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 'jorge'!

pepe at: 'jorge' ifAbsent: [nil.] !

nil = nil.!

 true !

 true !

nil = 0.!

nil = nil.!

nil = 0.!

nil = 0.!

nil !

nil = 0.!

nil = 0.
!

nil!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:10:51' prior: 50874140!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [datosUsuarios at:aUser = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:11:22' prior: 50874262!
createCartForUser: aUser password: aPassword 
	
	(datosUsuarios at:aUser = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 17:12:00' prior: 50874168!
createWith: aUserDataDictionary

	^self new initializeWith: aUserDataDictionary.! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:06'!
FAILURE!

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:06'!
FAILURE!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:15'!
FAILURE!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:15'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:12:33' prior: 50874271!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios at:aUser) = aPassword) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:12:35'!
PASSED!

!testRun: #XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:12:37'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:13:02'!
test03

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!testRun: #XXXTest #test03 stamp: 'G.L.S 6/20/2021 17:13:04'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:13:50'!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXXTest #test01 stamp: 'G.L.S 6/20/2021 17:13:50'!
test01

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:14:28'!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!methodRemoval: XXXTest #test02 stamp: 'G.L.S 6/20/2021 17:14:28'!
test02

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:14:53'!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !

!methodRemoval: XXXTest #test03 stamp: 'G.L.S 6/20/2021 17:14:53'!
test03

	| password usuario |
	
	usuario := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:15:07' prior: 50874294!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [datosUsuarios at:aUser = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:15:11'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:16'!
FAILURE!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:15:16'!
FAILURE!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:15:16'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:23'!
FAILURE!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:15:23'!
FAILURE!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 'jorge' -> 2324254.!

pepe add: 'jorge' -> 2324254.!

pepe includesKey: 'jorge'.!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:16:17' prior: 50874392!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:16:22'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:16:24'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:16:26'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 17:16:30'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:20:17' prior: 50874366!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:32:09'!
test04CannotAddItemToAnUnexistentCart

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:33:09' prior: 50874472!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX addItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:40:29' prior: 50874487!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX addItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:41:06' prior: 50874498!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: '' ofItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:41:14' prior: 50874509!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '12345678' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:48:42' prior: 50874520!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000'] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 17:57:28' prior: 50874531!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:58:25'!
ERROR!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:58:35'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:58:46'!
add: aSmallInteger ofItem: aString toCart: aString3 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:59:10' prior: 50874561!
add: anAmount ofItem: anItemID toCart: aCartID 
	self shouldBeImplemented.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 17:59:56' prior: 50874567!
add: anAmount ofItem: anItemID toCart: aCartID 
	self error: self class errorCartIdDoesntExist.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 17:59:59'!
ERROR!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:00:18' prior: 50874573!
add: anAmount ofItem: anItemID toCart: aCartID 
	self error: self class errorCartIdDoesNotExist.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:00:27'!
ERROR!
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:01:09'!
errorCartIdDoesNotExist
	self shouldBeImplemented.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 18:01:47' prior: 50874592!
errorCartIdDoesNotExist
	^'Error - No existe un carrito con esa ID'.! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:48'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:01:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 18:38:04'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:05:49'!
PASSED!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:06:28' prior: 50874583!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self error: self class errorCartIdDoesNotExist.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:01'!
test05
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:08' prior: 50874675!
test05
	
	
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:21' prior: 50874686!
test05
	
	| password usuario |
	usuario := 'pepe'.
	password := '5678'.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:09:47' prior: 50874697!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:10:23' prior: 50874710!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:10:40' prior: 50874725!
test05
	
	| password usuario cartId |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	mockXXX add: 17 ofItem: '9780201113723' toCart: cartId.
		! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:11:00' prior: 50874740!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		! !

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:48'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:50'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:51'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:52'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:53'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:54'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:56'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #XXXTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:13:57'!
TestCase subclass: #XXXTest
	instanceVariableNames: 'mockXXX userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 19:13:26' prior: 50874248 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 19:14:00' prior: 50874837 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:15:17' prior: 50874750!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		! !

!methodRemoval: XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:15:38'!
test05
	
	| password usuario cartId huboError |
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	huboError := #No.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
		!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:17:21'!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:00' prior: 50874902!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: '00000000'] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:10' prior: 50874913!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: '9780201113723' toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:18:23' prior: 50874926!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:18:41'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:19:12' prior: 50874345!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockXXX createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:19:15'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:15'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:15'!
FAILURE!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:19:20'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:23'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:19:23'!
FAILURE!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 19:20:38'!
createWith: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:20:38' prior: 50874857 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createWith: userData withCatalog: catalog1.
	! !

!methodRemoval: XXX class #createWith: stamp: 'G.L.S 6/20/2021 19:20:38'!
createWith: aUserDataDictionary

	^self new initializeWith: aUserDataDictionary.!
!XXX class methodsFor: 'error handling' stamp: 'G.L.S 6/20/2021 19:21:06'!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:21:06' prior: 50875002 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	
	mockXXX := XXX createFor: userData withCatalog: catalog1.
	! !

!methodRemoval: XXX class #createWith:withCatalog: stamp: 'G.L.S 6/20/2021 19:21:06'!
createWith: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary.!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:21:10'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:21:12'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:21:14'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:21:16'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:21:20'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:33'!
initializeWith: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:33' prior: 50875027!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeWith: aUserDataDictionary withCatalog: aCatalog.! !

!methodRemoval: XXX #initializeWith: stamp: 'G.L.S 6/20/2021 19:22:33'!
initializeWith: aUserDataDictionary

	datosUsuarios := aUserDataDictionary.!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:56'!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:22:56' prior: 50875083!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.! !

!methodRemoval: XXX #initializeWith:withCatalog: stamp: 'G.L.S 6/20/2021 19:22:56'!
initializeWith: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.!

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:23:12'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:23:11' prior: 50875094!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog .! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:23:13' prior: 50875121!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/20/2021 19:23:20'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/20/2021 19:23:22'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/20/2021 19:23:24'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:23:27'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:23:29'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:23:31'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:23:32'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:23:41'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:24:54' prior: 50874939!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty. ! !

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:24:57'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:25:13' prior: 50875214!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:31:22' prior: 50874428!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:31:45'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:31:43' prior: 50875128!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.! !

!classDefinition: #XXX category: 'Ejercicio-Libros' stamp: 'G.L.S 6/20/2021 19:32:20'!
Object subclass: #XXX
	instanceVariableNames: 'datosUsuarios catalog carts lastId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:32:13' prior: 50875263!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !

pepe add: 23 -> 25.!

pepe at:23.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:33:34' prior: 50874543!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: '9780201113723' toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:33:35'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:33:35'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:33:35'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:33:47' prior: 50875279!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:33:51' prior: 50875321!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 19:34:34' prior: 50875288!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartIdDoesNotExist.
			].! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:36'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:36'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:36'!
FAILURE!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 19:34:42'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:34:44'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:47'!
FAILURE!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:34:47'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:35:41' prior: 50875246!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1)! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:36:21' prior: 50875381!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1) -> (Cart createNewWithCatalog: catalog)
	lastId = lastId +1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:36:28' prior: 50875391!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:(lastId + 1) -> (Cart createNewWithCatalog: catalog).
	lastId = lastId +1.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:27' prior: 50875403!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:1000 -> (Cart createNewWithCatalog: catalog).! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:34' prior: 50875329!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new..! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:37:36' prior: 50875426!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:49:55' prior: 50874669!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:00' prior: 50875442!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	
	
	self error: self class errorCartIdDoesNotExist.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:09'!
assertCartExists: aCartID. 

	self error: self class errorCartIdDoesNotExist.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:20' prior: 50875448!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	self assertCartExists: aCartID.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:50' prior: 50875455!
assertCartExists: aCartID. 

	(carts includesKey: aCartID) ifFalse: [self error: self class errorCartIdDoesNotExist.]! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:50:53' prior: 50875467!
assertCartExists: aCartID. 

	(carts includesKey: aCartID) ifFalse: [self error: self class errorCartIdDoesNotExist.].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:51:22' prior: 50875415!
createCartForUser: aUser password: aPassword 
	
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	carts add:1000 -> (Cart createNewWithCatalog: catalog).
	
	^1000.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:02' prior: 50875461!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID. 
	
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:23' prior: 50875493!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID. 
	cart add: anItemID amount: anAmount.
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:24' prior: 50875500!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.
	
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:32' prior: 50875509!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:33' prior: 50875518!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := carts at: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:52:45'!
listCart: aCartID 

	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:53:15' prior: 50875534!
listCart: aCartID 

	^(carts at: aCartID)
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:55:26' prior: 50875538!
listCart: aCartID 

	^(carts at: aCartID) itemListFor: self.
	! !
!Cart methodsFor: 'nil' stamp: 'G.L.S 6/20/2021 19:57:06'!
itemListFor: aXXX! !
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:57:53'!
itemList
	^cartItems! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 19:58:02' prior: 50875543!
listCart: aCartID 

	^(carts at: aCartID) itemList.
	! !

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 19:58:12'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 19:58:14'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 20:00:07'!
test06

	| password usuario huboError cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	huboError := #No.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/20/2021 20:00:22' prior: 50875564!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/20/2021 20:00:46' prior: 50875034 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockXXX := XXX createFor: userData withCatalog: catalog1.
	! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/20/2021 20:00:52'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:01' prior: 50875481!
createCartForUser: aUser password: aPassword 
	
	| newId |
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	newId := lastId+1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := lastId + 1.
	
	^newId.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:19' prior: 50875616!
createCartForUser: aUser password: aPassword 
	
	| newId |
	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/20/2021 20:02:38' prior: 50875434!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.! !

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/20/2021 20:02:43'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/20/2021 20:02:46'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/20/2021 20:02:47'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/20/2021 20:02:49'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/20/2021 20:02:51'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/20/2021 20:02:52'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/20/2021 20:02:54'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/20/2021 20:02:56'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/20/2021 20:03:04'!
PASSED!

!methodRemoval: Cart #itemListFor: stamp: 'G.L.S 6/20/2021 20:04:06'!
itemListFor: aXXX!

----QUIT----(20 June 2021 20:06:33) CuisUniversity-4532.image priorSource: 17357356!

----STARTUP---- (21 June 2021 15:17:56) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test05 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!

!testRun: #XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:20:25'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:21:53' prior: 50875578!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:22:13'!
test06DifferentCartsCannotHaveTheSameId

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !

!methodRemoval: XXXTest #test06 stamp: 'G.L.S 6/21/2021 15:22:13'!
test06

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockXXX createCartForUser: usuario password: password.
	cartId2 := mockXXX createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:23:08'!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !

!methodRemoval: XXXTest #test05 stamp: 'G.L.S 6/21/2021 15:23:08'!
test05

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:29:13'!
test07

	| password usuario huboError cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:18' prior: 50875828!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:30' prior: 50875842!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:30:52'!
test07CannotListItemsOfUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !

!methodRemoval: XXXTest #test07 stamp: 'G.L.S 6/21/2021 15:30:52'!
test07
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].!

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:30:58'!
ERROR!
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:31:07'!
errorCartDoesNotExist
	self shouldBeImplemented.! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:31:28' prior: 50875882!
errorCartDoesNotExist
	^'Error - No existe un carrito con ese Id'.! !

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:31:29'!
FAILURE!
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:32:20' prior: 50875554!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self class errorCartDoesNotExist]) itemList.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:32:28' prior: 50875896!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartDoesNotExist]) itemList.
	! !

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:36'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!

!testRun: #XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:32:46'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:34:08'!
test07CannotListCartAnUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].! !

!methodRemoval: XXXTest #test07CannotListItemsOfUnexistentCart stamp: 'G.L.S 6/21/2021 15:34:08'!
test07CannotListItemsOfUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: XXX errorCartDoesNotExist.
			].!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:34:18'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:35:44' prior: 50875800!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:36:54' prior: 50875958!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: 17 equals: cartList first first.
	self assert: smalltalk80 equals: cartList first second.! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:36:56'!
FAILURE!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:09' prior: 50875975!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockXXX listCart: cartId) isEmpty.
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:12'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:48' prior: 50875999!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:49' prior: 50876046!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:37:52' prior: 50876066!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList ) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.
	! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:37:54'!
PASSED!
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:38:00' prior: 50876086!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: 17 equals: cartList first second.
	self assert: smalltalk80 equals: cartList first first.
	! !
!XXXTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 15:38:19' prior: 50876132!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockXXX createCartForUser: usuario password: password.
	
	[mockXXX add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockXXX listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:38:20'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:12'!
itemListFor: aXXX
	^aXXX listCartItemsFor: cartItems.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:30' prior: 50875902!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartDoesNotExist]) itemListFor: self.
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:57'!
listCartItemsFor: aCartItemList
	^aCartItemList
	! !
!XXX methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:42:58' prior: 50876210!
listCartItemsFor: aCartItemList
	^aCartItemList.
	! !

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:15'!
PASSED!

!methodRemoval: Cart #itemList stamp: 'G.L.S 6/21/2021 15:43:33'!
itemList
	^cartItems!

!testRun: #XXXTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!testRun: #XXXTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:43:36'!
PASSED!

!classRenamed: #XXX as: #MockRestInterface stamp: 'G.L.S 6/21/2021 15:46:00'!
Smalltalk renameClassNamed: #XXX as: #MockRestInterface!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875337!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockXXX add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50874320!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50874458!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockXXX createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875592 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockXXX := MockRestInterface createFor: userData withCatalog: catalog1.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:00' prior: 50875934!
test07CannotListCartAnUnexistentCart
	
	self should: [mockXXX listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !

!classRenamed: #XXXTest as: #MockRestInterfaceTest stamp: 'G.L.S 6/21/2021 15:46:26'!
Smalltalk renameClassNamed: #XXXTest as: #MockRestInterfaceTest!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:46:50' prior: 50876198!
itemListFor: aMockRestInterface
	^aMockRestInterface listCartItemsFor: cartItems.! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 15:47:11'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876285!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876300!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuarioNoExistente password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50874954!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876273!
test04CannotAddItemToAnUnexistentCart
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876338!
test07CannotListCartAnUnexistentCart
	
	self should: [mockInterface listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876316 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50875774!
test06DifferentCartsCannotHaveTheSameId

	| password usuario cartId1 cartId2 password2 usuario2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	usuario2 := 'ramon'.
	password2 := '1234'.
	
	cartId1 := mockInterface createCartForUser: usuario password: password.
	cartId2 := mockInterface createCartForUser: usuario2 password: password2.
	
	self deny: (cartId1 = cartId2).! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:47:11' prior: 50876152!
test05AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	[mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:18'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:21'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 15:47:23'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 15:47:25'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (33 to: 47)
		declaredAt: (33 to: 47)) keys ] valueCoveringAll:
		{49 to: 52}) includes:
		(aCreditCard
			cover: (64 to: 74)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{54 to: 62}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	^ [
	([
	(registeredCards
		cover: (37 to: 51)
		declaredAt: (37 to: 51)) at:
		(aCreditCard
			cover: (56 to: 66)
			declaredAt: (6 to: 16)) ] valueCoveringAll:
		{53 to: 55}) >=
		(aTotal
			cover: (72 to: 77)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{69 to: 70}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog
	^ [
	([
	(self coverAll:
		{58 to: 61}) new ] valueCoveringAll:
		{63 to: 65})
		initializeFor:
			(aUserDataDictionary
				cover: (82 to: 100)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (115 to: 122)
				declaredAt: (45 to: 52)) ] valueCoveringAll:
		{67 to: 80. 102 to: 113}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog
	(datosUsuarios _ aUserDataDictionary
		cover: (78 to: 96)
		declaredAt: (16 to: 34))
		cover: (61 to: 73)
		declaredAt: (61 to: 73).
	(catalog _ aCatalog
		cover: (111 to: 118)
		declaredAt: (49 to: 56))
		cover: (100 to: 106)
		declaredAt: (100 to: 106).
	(carts _ [
	(Dictionary
		cover: (131 to: 140)
		declaredAt: (131 to: 140)) new ] valueCoveringAll:
		{142 to: 144})
		cover: (122 to: 126)
		declaredAt: (122 to: 126).
	(lastId _ 0 coverAll:
		{158 to: 158})
		cover: (148 to: 153)
		declaredAt: (148 to: 153).! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	([
	([
	(datosUsuarios
		cover: (63 to: 75)
		declaredAt: (63 to: 75)) includesKey:
		(aUser
			cover: (90 to: 94)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{77 to: 88}) and: [
		[
		([
		(datosUsuarios
			cover: (104 to: 116)
			declaredAt: (63 to: 75)) at:
			(aUser
				cover: (121 to: 125)
				declaredAt: (20 to: 24)) ] valueCoveringAll:
			{118 to: 120}) =
			(aPassword
				cover: (130 to: 138)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
			{128 to: 128} ]] valueCoveringAll:
		{97 to: 100}) ifFalse: [
		[
		(self coverAll:
			{152 to: 155}) error:
			([
			([
			(self coverAll:
				{164 to: 167}) class ] valueCoveringAll:
				{169 to: 173}) errorWrongUserCredentials ] valueCoveringAll:
				{175 to: 199}) ] valueCoveringAll:
			{157 to: 162} ]] valueCoveringAll:
		{142 to: 149}.
	(newId _ [
	(lastId
		cover: (215 to: 220)
		declaredAt: (215 to: 220)) +
		(1 coverAll:
			{224 to: 224}) ] valueCoveringAll:
		{222 to: 222})
		cover: (206 to: 210)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (228 to: 232)
		declaredAt: (228 to: 232)) add:
		([
		(newId
			cover: (239 to: 243)
			declaredAt: (52 to: 56)) ->
			([
			(Cart
				cover: (250 to: 253)
				declaredAt: (250 to: 253)) createNewWithCatalog:
				(catalog
					cover: (277 to: 283)
					declaredAt: (277 to: 283)) ] valueCoveringAll:
				{255 to: 275}) ] valueCoveringAll:
			{246 to: 247}) ] valueCoveringAll:
		{234 to: 237}.
	(lastId _ newId
		cover: (300 to: 304)
		declaredAt: (52 to: 56))
		cover: (290 to: 295)
		declaredAt: (215 to: 220).
	^ newId
		cover: (311 to: 315)
		declaredAt: (52 to: 56).! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	[
	(self coverAll:
		{62 to: 65}) assertCartExists:
		(aCartID
			cover: (85 to: 91)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{67 to: 83}.
	(cart _ [
	(carts
		cover: (105 to: 109)
		declaredAt: (105 to: 109)) at:
		(aCartID
			cover: (115 to: 121)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{111 to: 113})
		cover: (97 to: 100)
		declaredAt: (54 to: 57).
	[
	(cart
		cover: (125 to: 128)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (135 to: 142)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (152 to: 159)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{130 to: 133. 144 to: 150}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
listCart: aCartID
	^ [
	([
	(carts
		cover: (24 to: 28)
		declaredAt: (24 to: 28))
		at:
			(aCartID
				cover: (34 to: 40)
				declaredAt: (11 to: 17))
		ifAbsent: [
			[
			(self coverAll:
				{53 to: 56}) error:
				([
				([
				(self coverAll:
					{65 to: 68}) class ] valueCoveringAll:
					{70 to: 74}) errorCartDoesNotExist ] valueCoveringAll:
					{76 to: 96}) ] valueCoveringAll:
				{58 to: 63} ]] valueCoveringAll:
		{30 to: 32. 42 to: 50}) itemListFor:
		(self coverAll:
			{113 to: 116}) ] valueCoveringAll:
		{100 to: 111}.! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!Behavior method!
errorCartDoesNotExist
	^ 'Error - No existe un carrito con ese Id' coverAll:
		{25 to: 65}.! !

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 15:47:43'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:55:13'!
assertUser: aUser existsWithPassword: aPassword.

	((datosUsuarios includesKey: aUser) and: [(datosUsuarios at:aUser) = aPassword]) ifFalse: [self error: self class errorWrongUserCredentials].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 15:55:46' prior: 50875629!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:02:38'!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:03:17' prior: 50877430!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:16:13' prior: 50877445!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:14'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 16:16:24'!
listPurchasesForUser: aString withPassword: aString2 
	self shouldBeImplemented.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 16:16:55' prior: 50877480!
listPurchasesForUser: aUser withPassword: aPassword 
	
	self assertUser: aUser existsWithPassword: aPassword.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:16:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:17:10'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:17:42'!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:18:08' prior: 50877561!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:10'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:18:38' prior: 50877577!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:38'!
PASSED!

!methodRemoval: MockRestInterfaceTest #test09CannotListPurchasesWithAnUserWithWrongPassword stamp: 'G.L.S 6/21/2021 16:18:44'!
test09CannotListPurchasesWithAnUserWithWrongPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface listPurchasesForUser: usuario withPassword: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:22:46' prior: 50876403!
test02CreateCartForAnExistingUserDoesNotFail

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:48:00'!
test09

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 16:48:24' prior: 50877677!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '5678'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:03:57' prior: 50877684!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '1234'.
	
	
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:11' prior: 50877690!
test09

	| password usuario|
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:45' prior: 50877696!
test09

	| password |
	
	self should: [mockInterface ] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:04:52' prior: 50877710!
test09

	self should: [mockInterface ] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:06:16' prior: 50877720!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartDoesNotExist.
			].! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:07:50'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:07:51'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/21/2021 17:07:43' prior: 50876441 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:08:32'!
ERROR!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:08:32'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:08:41'!
checkOutCart: aSmallInteger withCreditCard: aString withExpirationDate: aString3 withOwner: aString4 
	self shouldBeImplemented.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:09:23' prior: 50877802!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	self assertCartExists: aCartId.! !

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:09:27'!
FAILURE!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:10:32' prior: 50876203!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartIdDoesNotExist]) itemListFor: self.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:10:37' prior: 50876429!
test07CannotListCartAnUnexistentCart
	
	self should: [mockInterface listCart: 0] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:10:42' prior: 50877730!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface class #errorCartDoesNotExist stamp: 'G.L.S 6/21/2021 17:10:47'!
errorCartDoesNotExist
	^'Error - No existe un carrito con ese Id'.!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:10:51'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:10:54'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:11:24'!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterfaceTest #test09 stamp: 'G.L.S 6/21/2021 17:11:24'!
test09

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:22:49'!
test10
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 17:22:53'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:23:51' prior: 50877916!
test10
	
	| password usuario|
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:01' prior: 50877926!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:31' prior: 50877935!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:25:49' prior: 50877946!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: '' withOwner: ''.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:26:11' prior: 50877957!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:27:24' prior: 50877969!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError = #No.
	
	mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:27:50' prior: 50877982!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:02' prior: 50877996!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self assert: (mockInterface listPurchasesForUser: usuario withPassword: password) ! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe isEmpty .!

pepe isEmpty.!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:40' prior: 50878012!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty ! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:43' prior: 50878037!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty. ! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:29:56' prior: 50878056!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 17:32:10'!
ERROR!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/21/2021 17:33:51'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:33:33' prior: 50877486!
listPurchasesForUser: aUser withPassword: aPassword 
	
	self assertUser: aUser existsWithPassword: aPassword.
	
	^userPurchases at: aUser.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:34:45' prior: 50875642!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [:aUser | userPurchases add: aUser -> Dictionary new.]! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:34:46' prior: 50878114!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [:aUser | userPurchases add: aUser -> Dictionary new.].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:38:20' prior: 50878075!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: (mockInterface listPurchasesForUser: usuario withPassword: password) isEmpty.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 17:38:29'!
FAILURE!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:41:02' prior: 50878126!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUser | 
			userPurchases add: aUser -> Dictionary new.
			aCatalog do:[
				:aCatalogItem |			
				(userPurchases at: aUser).
				]
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:42:24' prior: 50878162!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUser | 
			userPurchases add: aUser -> Dictionary new.
			(userPurchases at: aUser) add: 'total' -> 0.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:42:44' prior: 50878177!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'total' -> 0.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:43:11' prior: 50878191!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'total' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:46:54' prior: 50878138!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'total') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:47:00' prior: 50878220!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'total') = 0.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:48:13' prior: 50878206!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:48:20' prior: 50878241!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBook') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:48:21' prior: 50878277!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco'.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:48:36' prior: 50877810!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	
	self assertCartExists: aCartId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	self assertCartExists: aCartId.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32' prior: 50878298!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId withCreditCard: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow withOwner: 'Marco' aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:51:32' prior: 50877892!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' aMerchantProcesor: merchantProcessor] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner: stamp: 'G.L.S 6/21/2021 17:51:32'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner 
	
	self assertCartExists: aCartId.!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 17:51:41'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:52:01' prior: 50878337!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 17:52:15' prior: 50878387!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				aMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:53:41' prior: 50878328!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:54:22' prior: 50878434!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:54:43' prior: 50878445!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01' prior: 50878410!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:55:01' prior: 50878360!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:aMerchantProcesor: stamp: 'G.L.S 6/21/2021 17:55:01'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner aMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:56:15' prior: 50878474!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:57:21' prior: 50878543!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 17:58:46' prior: 50878558!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49' prior: 50878489!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor registerOn: salesbook.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:49' prior: 50878513!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: salesbook] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor: stamp: 'G.L.S 6/21/2021 18:00:49'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor  
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: ''
		forMerchantProcessor: aMerchantProcessor.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:00:56' prior: 50878596!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:10' prior: 50878642!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:17' prior: 50878618!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:01:22' prior: 50878717!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:03:04' prior: 50878680!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:04:21' prior: 50878765!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:10:15' prior: 50877420!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> OrderedCollection new.
	
	(carts at: newId).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:10:27' prior: 50878813!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> OrderedCollection new.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:12:23' prior: 50878824!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add:(newId) -> (Cart createNewWithCatalog: catalog).
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21'!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21' prior: 50878702!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 forUser: usuario withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:21' prior: 50878741!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor:registerOn: stamp: 'G.L.S 6/21/2021 18:13:21'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases
		].!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:13:31' prior: 50878872!
test09CannotCheckOutWithACartThatDoesNotExist

	self should: [mockInterface checkOutCart: 0 forUser: '' withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartIdDoesNotExist.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:13:38' prior: 50878888!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 18:13:40'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:13:56' prior: 50878847!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		userPurchases at: aUser
		].! !

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 put: 20.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 put: 20.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:17:39' prior: 50878983!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first put: ((userPurchases at: aUser) at: aBookAmountTuple ifAbsent:[0]) + aBookAmountTuple second)
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:18:07' prior: 50879015!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first 
			put: ((userPurchases at: aUser) at: aBookAmountTuple first ifAbsent:[0]) + aBookAmountTuple second)
		].! !

pepe _ Dictionary new.!

pepe at: 10 
	put: (pepe at:10 ifAbsent: [0] + (pepe at:10)).
!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:20:23' prior: 50879044!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		((userPurchases at: aUser) at: aBookAmountTuple first ifAbsentPut: aBookAmountTuple second). 
		].! !

pepe _ Dictionary new.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe at: 'jorge' put: 10.!

pepe !

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 put: 245.!

pepe at: 10 ifAbsentPut: 0.!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe !

pepe at: 10.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 10 ->0.!

pepe add: 10 ->0.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe _ Dictionary new.!

pepe add: 10 -> 0.!

pepe at: 10 
	ifPresent: [pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe _ Dictionary new.!

pepe add: 10 -> 0.!

pepe at: 10 
	ifPresent: [:v | pepe at: 10 put: 355]  
	ifAbsent: [pepe add: 10->4].!

pepe at: 10.!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:30:31' prior: 50879076!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:32:34' prior: 50879160!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:33:05' prior: 50879193!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:33:37'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 18:36:01' prior: 50878954!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:46:14' prior: 50879230!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	aMerchantProcessor registerCard: creditCard withBalance: 1000. 
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 18:47:23' prior: 50868509!
isCardRegistered: aCreditCard

	^registeredCards keys includes: aCreditCard.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:47:51' prior: 50879294!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!CreditCard methodsFor: 'nil' stamp: 'G.L.S 6/21/2021 18:48:15' overrides: 16881029!
= aCreditCard
	
	! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 18:49:48' prior: 50879374 overrides: 16881029!
= aCreditCard
	
	^ aCreditCard isNumber: creditCardNumber.! !
!CreditCard methodsFor: 'private' stamp: 'G.L.S 6/21/2021 18:50:24'!
isNumber: aCreditCardNumber.
	
	aCreditCardNumber = creditCardNumber.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:50:45'!
FAILURE!

registeredCards keys!

self at: 1!

registeredCards keys includes: aCreditCard!

registeredCards keys!

self at: 1.!

(self at: 1) includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today)!

self includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: FixedGregorianDate today)!
!CreditCard methodsFor: 'private' stamp: 'G.L.S 6/21/2021 18:58:58' prior: 50879384!
isNumber: aCreditCardNumber.
	
	^ aCreditCardNumber = creditCardNumber.! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:03'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:03'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:16'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:16'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:19'!
FAILURE!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 18:59:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:23'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:23'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:35'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 18:59:35'!
FAILURE!

self listCart: aCartId!

userPurchases at: aUser!

aBookAmountTuple first !

userPurchases at:aUser!

(mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks'!

((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:32'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:03:32'!
FAILURE!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:03:45'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:03:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:04:26'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:04:26'!
FAILURE!

----QUIT----(21 June 2021 19:06:45) CuisUniversity-4532.image priorSource: 17410667!

----STARTUP---- (21 June 2021 19:06:50) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:06:53'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:07:15' prior: 50879269!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	"self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0."
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:07:16'!
FAILURE!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:07:23' prior: 50879510!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:08:48' prior: 50879538!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #No].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:08:57' prior: 50879563!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:08' prior: 50879588!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] value
		"on: Error 
		do: [huboError := #Si]."
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:09:10'!
ERROR!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:26' prior: 50879613!
test10
	
	| password usuario cartId huboError|
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	huboError := #No.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.]
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/21/2021 19:09:42' prior: 50879641!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:09:46'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:10:52'!
ERROR!

registeredCards at:aCreditCard!

registeredCards!

self keys.!

self keys at: 1!

self keys at: 1!

(self keys at: 1) = (CreditCard forOwner: '' withNumber: '0000000000000000'  withExpirationDate: '')!

(self keys at: 1) = (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: '')!

self keys includes: (CreditCard forOwner: 'Marco' withNumber: '0000000000000000'  withExpirationDate: '').!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:25'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:40'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:18:40'!
ERROR!

aMerchantProcessor isCardRegistered: aCreditCard!

aMerchantProcessor isCardRegistered: aCreditCard!

CreditCard!

(registeredCards keys at:1)!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:26:03'!
ERROR!

self at:(CreditCard forOwner: 't' withNumber: '0000000000000000' withExpirationDate: 'e')!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 19:30:40' prior: 50879338!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	aMerchantProcessor registerCard: creditCard withBalance: 1000. 
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:30:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:30:54'!
PASSED!
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:34:40' prior: 50868566!
can: aCreditCard spend: aTotal
	
	| storedCard |
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard  = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:34:46' prior: 50879802!
can: aCreditCard spend: aTotal
	
	| storedCard |
	
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard  = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockMerchantProcesor methodsFor: 'operations' stamp: 'G.L.S 6/21/2021 19:35:03' prior: 50879813!
can: aCreditCard spend: aTotal
	
	| storedCard |
	
	registeredCards keysDo: [
		:storedCreditCard |
		storedCreditCard = aCreditCard ifTrue: [storedCard := storedCreditCard].
		].
	
	^ (registeredCards at:storedCard) >= aTotal.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/21/2021 19:36:40' prior: 50879724!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aXXX   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aXXX
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:36:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/21/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/21/2021 19:36:49'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/21/2021 19:36:51'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/21/2021 19:36:54'!
PASSED!

----QUIT----(21 June 2021 19:42:16) CuisUniversity-4532.image priorSource: 17531182!

----STARTUP---- (22 June 2021 16:11:06) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:00:01' prior: 50879835!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:09:32' prior: 50879981!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:14' prior: 50880018!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:26' prior: 50880056!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
		
	self updatePurchasesFor: cartUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:33' prior: 50880082!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:10:55'!
updatePurchasesFor: aUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:11:26' prior: 50880122!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := aUser.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:11:28'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:23:33' prior: 50880178!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := carts at: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:24:12'!
userOfCart: aCartId
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:25:18' prior: 50878837!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:28:25' prior: 50880266!
userOfCart: aCartId

	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:28:46' prior: 50877821!
listCart: aCartID 

	^(carts at: aCartID ifAbsent: [self error: self class errorCartIdDoesNotExist]) first itemListFor: self.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:06' prior: 50880240!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := (carts at: aCartId) first.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:29' prior: 50880296!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	self assertCartExists: aCartId.
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:29:47'!
cartForId: aCartId

	^(carts at: aCartId) first.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:33' prior: 50880323!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:38' prior: 50880283!
userOfCart: aCartId
	self assertCartExists: aCartId.
	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:39' prior: 50880379!
userOfCart: aCartId

	self assertCartExists: aCartId.
	^(carts at: aCartId) second.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:31:45' prior: 50880349!
cartForId: aCartId
	
	self assertCartExists: aCartId.
	^(carts at: aCartId) first.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:32:34' prior: 50880288!
listCart: aCartID 

	^(self cartForId: aCartID) itemListFor: self.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:32:38' prior: 50880397!
listCart: aCartId 

	^(self cartForId: aCartId) itemListFor: self.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:00'!
FAILURE!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:33:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:00'!
ERROR!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:15'!
ERROR!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:15'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:33:43' prior: 50875526!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	self assertCartExists: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:33:49' prior: 50880458!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:33:55'!
PASSED!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:35:41'!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal .
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:35:41' prior: 50880354!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: total.
! !

!methodRemoval: MockRestInterface #updatePurchasesFor:withCart: stamp: 'G.L.S 6/22/2021 17:35:41'!
updatePurchasesFor: aUser withCart: aCartId.
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aBookAmountTuple second.
		].
!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:36:29' prior: 50880531!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout.
! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:36:43' prior: 50880576!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:36:46'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:40:06'!
test10CheckoutWorksAsExpected
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterfaceTest #test10 stamp: 'G.L.S 6/22/2021 17:40:06'!
test10
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:42:38'!
test11CannotUseACartAfterItExpired

	| password usuario huboError |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	[mockInterface createCartForUser: usuario password: password] 
		on: Error 
		do: [huboError := #Si].
		
	self assert: #No equals: huboError.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:44:16'!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	! !

!methodRemoval: MockRestInterfaceTest #test10CheckoutWorksAsExpected stamp: 'G.L.S 6/22/2021 17:44:16'!
test10CheckoutWorksAsExpected
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self deny: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 0.
	!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:44:50' prior: 50880707!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:47:55' prior: 50880764!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:49:36' prior: 50880773!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:50:00' prior: 50880782!
test11CannotUseACartAfterItExpired

	| password usuario |
	
	usuario := 'pepe'.
	password := '5678'.
	
	mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:50:17' prior: 50880792!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	"pasa el tiempo"
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:25'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard merchantProcessor timer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockTimer category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:30'!
Object subclass: #MockTimer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/22/2021 17:52:23' prior: 50877767 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := MockTimer new.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !
!MockTimer methodsFor: 'no messages' stamp: 'G.L.S 6/22/2021 17:52:39' overrides: 16896425!
initialize! !

!classDefinition: #MockTimer category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:52:50'!
Object subclass: #MockTimer
	instanceVariableNames: 'currentTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:52:49' prior: 50880878 overrides: 16896425!
initialize

	currentTime := 0.! !
!MockTimer methodsFor: 'nil' stamp: 'G.L.S 6/22/2021 17:53:37'!
passTime: anAmontOfTime

	currentTime + anAmontOfTime.! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:54:03'!
currentTime

	^currentTime.! !
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/22/2021 17:55:24'!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:55:24' prior: 50880847 overrides: 16927572!
setUp
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := MockTimer new.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!methodRemoval: MockRestInterface class #createFor:withCatalog: stamp: 'G.L.S 6/22/2021 17:55:24'!
createFor: aUserDataDictionary withCatalog: aCatalog 

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog.!
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:56:19'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterface class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:56:19' prior: 50880903!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer.! !

!methodRemoval: MockRestInterface #initializeFor:withCatalog: stamp: 'G.L.S 6/22/2021 17:56:19'!
initializeFor: aUserDataDictionary withCatalog: aCatalog 

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:56:41'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:56:34' prior: 50880950!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 17:57:03' prior: 50880809!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 30.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:58:14' prior: 50880467!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:58:46' prior: 50881031!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart := self cartForId: aCartID.
	cart add: anItemID amount: anAmount.
	
	self updateCartTimerFor: aCartID.
	! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:59:17'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 17:59:15' prior: 50880270!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	cartTimer add: newId -> timer currentTime.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/22/2021 17:59:33' prior: 50880998!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimer := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 17:59:38'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:59:38' prior: 50881060!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	cartTimers add: newId -> timer currentTime.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 17:59:38' prior: 50881075!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:02:24'!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	cartTimer := cartTimers at: aCartID.
	
	^ timer isDifferenceWith: cartTimer biggerThan: 30.
! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:02:35' prior: 50881132!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	
	cartTimer := cartTimers at: aCartID.
	
	^ timer isDifferenceWith: cartTimer biggerThan: 30.
! !
!MockTimer methodsFor: 'nil' stamp: 'G.L.S 6/22/2021 18:03:03'!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:04:53' prior: 50881147!
isDifferenceWith: aTime biggerThan: anAmountOfTime

	^ (currentTime - aTime) abs > anAmountOfTime.! !
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:05:01' prior: 50881152!
isDifferenceWith: aTime biggerThan: anAmountOfTime

	^ ((currentTime - aTime) abs > anAmountOfTime).! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:05:33' prior: 50881014!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:05:42'!
ERROR!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:05:42'!
ERROR!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:06:33'!
updateCartTimerFor: aCartID

	cartTimers at: aCartID put: timer currentTime.
	! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:06:45'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:06:45'!
FAILURE!
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/22/2021 18:07:18'!
errorCartExpired
	^ 'Error - El carrito utilizado expiró'.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:07:55' prior: 50881140!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	
	cartTimer := cartTimers at: aCartID.
	
	(timer isDifferenceWith: cartTimer biggerThan: 30) ifTrue: [self error: self class errorCartExpired].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:07:59'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:07:59'!
FAILURE!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:08:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:08:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:08:08'!
FAILURE!
!MockTimer methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/22/2021 18:09:16' prior: 50880894!
passTime: anAmontOfTime

	currentTime := currentTime + anAmontOfTime.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:09:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:09:22'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:09:47' prior: 50881166!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
		
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:10:31' prior: 50881249!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self should: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
		
	self should: [mockInterface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorCartExpired.
			].
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:10:32'!
FAILURE!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 18:11:20'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers itemList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:11:18' prior: 50880403!
listCart: aCartId 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	itemList := (self cartForId: aCartId) itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^itemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:12:35' prior: 50881311!
listCart: aCartId 
	
	| cartItemList |
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/22/2021 18:12:50'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:12:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:13:01'!
FAILURE!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:13:01'!
FAILURE!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:13:01'!
PASSED!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:14:16' prior: 50881040!
add: anAmount ofItem: anItemID toCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart add: anItemID amount: anAmount.
	
	self updateCartTimerFor: aCartID.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:14:31' prior: 50881320!
listCart: aCartId 
	
	| cartItemList |
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:14:38'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/22/2021 18:18:12' prior: 50880719!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
		
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:18:16'!
FAILURE!

((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks')!
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/22/2021 18:19:07' prior: 50880511!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal .
	
	(self listCart: aCartId) do: [
		:aBookAmountTuple |
		(userPurchases at: aUser) at: aBookAmountTuple first 
			ifPresent:[:cant | (userPurchases at: aUser) at: aBookAmountTuple first put: cant + aBookAmountTuple second] 
			ifAbsent:[(userPurchases at: aUser) at: aBookAmountTuple first put: aBookAmountTuple second].
		(userPurchases at:aUser) at: 'totalBooks' put: ((userPurchases at:aUser) at: 'totalBooks') + aTotal.
		].
! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:19:20'!
PASSED!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:20:29' prior: 50881396!
listCart: aCartId 
	
	| cartItemList |
	
	cartItemList := (self cartForId: aCartId) itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:21:19' prior: 50881541!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := (self cartForId: aCartId). 
	
	cartItemList := cart itemListFor: self.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:21:52' prior: 50881551!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := (self cartForId: aCartId). 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/22/2021 18:23:13' prior: 50881562!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := self cartForId: aCartId. 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/22/2021 18:23:18'!
PASSED!

----QUIT----(22 June 2021 18:32:30) CuisUniversity-4532.image priorSource: 17546330!

----STARTUP---- (24 June 2021 15:09:22) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:17:53'!
testFail: aBlock withErrorMessage: anErrorMessage

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self should: [mockInterface createCartForUser: usuario password: password] 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:18:12' prior: 50881631!
testFail: aBlock withErrorMessage: anErrorMessage
	
	self should: aBlock 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: MockRestInterface errorWrongUserCredentials.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:18:27' prior: 50881646!
testFail: aBlock withErrorMessage: anErrorMessage
	
	self should: aBlock 
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: anErrorMessage.
			].! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:19:09' prior: 50876372!
test01CannotCreateCartWithTheWrongUserPassword

	| password usuario |
	
	usuario := 'pepe'.
	password := '1234'.
	
	self testFail: [mockInterface createCartForUser: usuario password: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:19:17'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:19:38' prior: 50876387!
test03CannotCreateCartForAUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
		
	self testFail: [mockInterface createCartForUser: usuarioNoExistente password: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:20:41' prior: 50876416!
test04CannotAddItemToAnUnexistentCart

	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0]  withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:20:42'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:20:49' prior: 50881737!
test04CannotAddItemToAnUnexistentCart

	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:23:55' prior: 50877828!
test07CannotListCartAnUnexistentCart

	self testFail: [mockInterface listCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:23:58'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:24:35' prior: 50877460!
test08CannotListPurchasesWithAnUserThatDoesntExist

	| password usuarioNoExistente |
	
	usuarioNoExistente := 'Jorge'.
	password := '1234'.
	
	self testFail: [mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password] withErrorMessage: MockRestInterface errorWrongUserCredentials.
			! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:24:37'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:25:18' prior: 50878938!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 forUser: '' withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales]  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:25:19'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:26:11' prior: 50881274!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:26:12'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:26:12'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:26:13'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:29:35'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:33:45' prior: 50881448!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:34:16'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:35:08' prior: 50881970!
test11CannotUseACartAfterItExpired

	| password usuario cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	cartList := mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:35:14'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:36:17' prior: 50882146!
test11CannotUseACartAfterItExpired

	| password usuario cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	cartList := mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:36:27' prior: 50882210!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:36:33'!
PASSED!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/24/2021 15:37:38' prior: 50880602!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:37:43'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:38:09' prior: 50882231!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:39:17' prior: 50882366!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:39:21' prior: 50882386!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:39:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:40:53'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:58:26'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:35'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:58:36'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/24/2021 15:59:42' prior: 50882074!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				forUser: usuario 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:59:50'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 15:59:55'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{255 to: 258}) cartForId:
		(aCartId
			cover: (271 to: 277)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{260 to: 269})
		cover: (237 to: 250)
		declaredAt: (189 to: 202).
	(cartUser _ [
	(self coverAll:
		{293 to: 296}) userOfCart:
		(aCartId
			cover: (310 to: 316)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{298 to: 308})
		cover: (281 to: 288)
		declaredAt: (223 to: 230).
	(creditCard _ [
	(CreditCard
		cover: (334 to: 343)
		declaredAt: (334 to: 343))
		forOwner:
			(anOwner
				cover: (355 to: 361)
				declaredAt: (109 to: 115))
		withNumber:
			(aCreditCardNumber
				cover: (375 to: 391)
				declaredAt: (54 to: 70))
		withExpirationDate:
			(aDate
				cover: (413 to: 417)
				declaredAt: (92 to: 96)) ] valueCoveringAll:
		{345 to: 353. 363 to: 373. 393 to: 411})
		cover: (320 to: 329)
		declaredAt: (204 to: 213).
	(cashier _ [
	(Cashier
		cover: (434 to: 440)
		declaredAt: (434 to: 440)) withCatalog:
		(catalog
			cover: (455 to: 461)
			declaredAt: (455 to: 461)) ] valueCoveringAll:
		{442 to: 453})
		cover: (423 to: 429)
		declaredAt: (215 to: 221).
	[
	(self coverAll:
		{467 to: 470}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (504 to: 510)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{472 to: 502}.
	[
	(cashier
		cover: (516 to: 522)
		declaredAt: (215 to: 221))
		checkout:
			(cartToCheckout
				cover: (534 to: 547)
				declaredAt: (189 to: 202))
		withCreditCard:
			(creditCard
				cover: (568 to: 577)
				declaredAt: (204 to: 213))
		onDate:
			([
			(FixedGregorianDate
				cover: (590 to: 607)
				declaredAt: (590 to: 607)) today ] valueCoveringAll:
				{609 to: 613})
		registerOn:
			(aSalesBook
				cover: (629 to: 638)
				declaredAt: (170 to: 179))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (664 to: 681)
				declaredAt: (139 to: 156)) ] valueCoveringAll:
		{524 to: 532. 552 to: 566. 582 to: 588. 617 to: 627. 642 to: 662}.
	[
	(self coverAll:
		{687 to: 690})
		updatePurchasesFor:
			(cartUser
				cover: (712 to: 719)
				declaredAt: (223 to: 230))
		withCart:
			(aCartId
				cover: (731 to: 737)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (750 to: 763)
				declaredAt: (189 to: 202)) totalItemPrice ] valueCoveringAll:
				{765 to: 778}) ] valueCoveringAll:
		{692 to: 710. 721 to: 729. 739 to: 748}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 15:59:56'!
PASSED!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/24/2021 16:00:44'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50881912!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' withMerchantProcesor: merchantProcessor registerOn: sales]  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50884869!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/24/2021 16:00:44' prior: 50882416!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!methodRemoval: MockRestInterface #checkOutCart:forUser:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor:registerOn: stamp: 'G.L.S 6/24/2021 16:00:44'!
checkOutCart: aCartId forUser: aUser withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 16:01:03'!
PASSED!
!Behavior method!
createNewWithCatalog: anOrderedCollection
	^ [
	([
	(self coverAll:
		{46 to: 49}) new ] valueCoveringAll:
		{51 to: 53}) initializeWith:
		(anOrderedCollection
			cover: (71 to: 89)
			declaredAt: (23 to: 41)) ] valueCoveringAll:
		{55 to: 69}.! !
!Behavior method!
initializeWith: anOrderedCollection
	(catalog _ anOrderedCollection
		cover: (49 to: 67)
		declaredAt: (17 to: 35))
		cover: (38 to: 44)
		declaredAt: (38 to: 44).
	(cartItems _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (71 to: 79)
		declaredAt: (71 to: 79).! !
!Behavior method!
isEmpty
	^ [
	(cartItems
		cover: (11 to: 19)
		declaredAt: (11 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
add: aBook
	[
	(self coverAll:
		{14 to: 17})
		add:
			(aBook
				cover: (24 to: 28)
				declaredAt: (6 to: 10))
		amount:
			(1 coverAll:
				{38 to: 38}) ] valueCoveringAll:
		{19 to: 22. 30 to: 36}.! !
!Behavior method!
add: aBook amount: anAmount
	| tuplaLibroCant |
	[
	(self coverAll:
		{53 to: 56}) assertBookIsAllowed:
		(aBook
			cover: (79 to: 83)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{58 to: 77}.
	[
	(self coverAll:
		{87 to: 90}) assertAmountIsValid:
		(anAmount
			cover: (113 to: 120)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{92 to: 111}.
	(tuplaLibroCant _ [
	(OrderedCollection
		cover: (144 to: 160)
		declaredAt: (144 to: 160)) new ] valueCoveringAll:
		{162 to: 164})
		cover: (126 to: 139)
		declaredAt: (33 to: 46).
	[
	(tuplaLibroCant
		cover: (168 to: 181)
		declaredAt: (33 to: 46)) add:
		(aBook
			cover: (188 to: 192)
			declaredAt: (6 to: 10)) ] valueCoveringAll:
		{183 to: 186}.
	[
	(tuplaLibroCant
		cover: (196 to: 209)
		declaredAt: (33 to: 46)) add:
		(anAmount
			cover: (216 to: 223)
			declaredAt: (20 to: 27)) ] valueCoveringAll:
		{211 to: 214}.
	[
	(cartItems
		cover: (229 to: 237)
		declaredAt: (229 to: 237)) add:
		(tuplaLibroCant
			cover: (244 to: 257)
			declaredAt: (33 to: 46)) ] valueCoveringAll:
		{239 to: 242}.! !
!Behavior method!
assertBookIsAllowed: aBook
	[
	([
	([
	(catalog
		cover: (31 to: 37)
		declaredAt: (31 to: 37)) keys ] valueCoveringAll:
		{39 to: 42}) includes:
		(aBook
			cover: (54 to: 58)
			declaredAt: (22 to: 26)) ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			([
			(self coverAll:
				{82 to: 85}) class ] valueCoveringAll:
				{87 to: 91}) errorBookNotInAllowedList ] valueCoveringAll:
				{93 to: 117}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 68}.! !
!Behavior method!
assertAmountIsValid: anAmount
	self coverAll:
		{65 to: 68}.
	[
	([
	(anAmount
		cover: (35 to: 42)
		declaredAt: (22 to: 29)) isInteger ] valueCoveringAll:
		{44 to: 52}) ifFalse: [
		[
		(self coverAll:
			{77 to: 80}) error:
			([
			([
			(self coverAll:
				{137 to: 140}) class ] valueCoveringAll:
				{82 to: 86}) errorAmountNotInteger ] valueCoveringAll:
				{88 to: 108}) ] valueCoveringAll:
			{70 to: 75} ]] valueCoveringAll:
		{55 to: 62}.
	[
	([
	(anAmount
		cover: (114 to: 121)
		declaredAt: (22 to: 29)) <
		(0 coverAll:
			{125 to: 125}) ] valueCoveringAll:
		{123 to: 123}) ifTrue: [
		[
		(self coverAll:
			{149 to: 152}) error:
			([
			([
			(self coverAll:
				{207 to: 210}) class ] valueCoveringAll:
				{154 to: 158}) errorAmountNegative ] valueCoveringAll:
				{160 to: 178}) ] valueCoveringAll:
			{142 to: 147} ]] valueCoveringAll:
		{128 to: 134}.
	[
	([
	(anAmount
		cover: (184 to: 191)
		declaredAt: (22 to: 29)) =
		(0 coverAll:
			{195 to: 195}) ] valueCoveringAll:
		{193 to: 193}) ifTrue: [
		[
		(self coverAll:
			{219 to: 222}) error:
			([
			([ self class ] valueCoveringAll:
				{224 to: 228}) errorAmountZero ] valueCoveringAll:
				{230 to: 244}) ] valueCoveringAll:
			{212 to: 217} ]] valueCoveringAll:
		{198 to: 204}.! !

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
size
	^ [
	(cartItems
		cover: (8 to: 16)
		declaredAt: (8 to: 16)) size ] valueCoveringAll:
		{18 to: 21}.! !
!Behavior method!
first
	^ [
	(cartItems
		cover: (9 to: 17)
		declaredAt: (9 to: 17)) first ] valueCoveringAll:
		{19 to: 23}.! !
!Behavior method!
second
	^ [
	(cartItems
		cover: (10 to: 18)
		declaredAt: (10 to: 18)) second ] valueCoveringAll:
		{20 to: 25}.! !

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorBookNotInAllowedList
	^ 'Error - El Libro no está en la lista de productos permitidos' coverAll:
		{29 to: 90}.! !

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountNotInteger
	^ 'Error - La cantidad tiene que ser un número entero' coverAll:
		{25 to: 76}.! !

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountNegative
	^ 'Error - La cantidad no puede ser negativa' coverAll:
		{23 to: 65}.! !

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorAmountZero
	^ 'Error - La cantidad de libros no puede ser 0' coverAll:
		{19 to: 64}.! !

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeForOwner:
			(anOwner
				cover: (106 to: 112)
				declaredAt: (11 to: 17))
		withNumber:
			(aCreditCardNumber
				cover: (126 to: 142)
				declaredAt: (31 to: 47))
		withExpirationDate:
			(aDate
				cover: (164 to: 168)
				declaredAt: (69 to: 73)) ] valueCoveringAll:
		{86 to: 104. 114 to: 124. 144 to: 162}.! !
!Behavior method!
initializeForOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate
	[
	(self coverAll:
		{88 to: 91}) assertNameNotEmpty:
		(anOwner
			cover: (113 to: 119)
			declaredAt: (21 to: 27)) ] valueCoveringAll:
		{93 to: 111}.
	[
	(self coverAll:
		{123 to: 126}) assertCardNumberIsCorrect:
		(aCreditCardNumber
			cover: (155 to: 171)
			declaredAt: (41 to: 57)) ] valueCoveringAll:
		{128 to: 153}.
	(owner _ anOwner
		cover: (185 to: 191)
		declaredAt: (21 to: 27))
		cover: (176 to: 180)
		declaredAt: (176 to: 180).
	(creditCardNumber _ aCreditCardNumber
		cover: (215 to: 231)
		declaredAt: (41 to: 57))
		cover: (195 to: 210)
		declaredAt: (195 to: 210).
	(expirationDate _ aDate
		cover: (253 to: 257)
		declaredAt: (79 to: 83))
		cover: (235 to: 248)
		declaredAt: (235 to: 248).! !
!Behavior method!
assertNameNotEmpty: anOwner
	[
	([
	([
	(anOwner
		cover: (32 to: 38)
		declaredAt: (21 to: 27)) withBlanksTrimmed ] valueCoveringAll:
		{40 to: 56}) isEmpty ] valueCoveringAll:
		{58 to: 64}) ifTrue: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) errorOwnerEmpty ] valueCoveringAll:
				{98 to: 112}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{66 to: 72}.! !
!Behavior method!
assertCardNumberIsCorrect: aCreditCardNumber
	[
	([
	([
	(aCreditCardNumber
		cover: (49 to: 65)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{67 to: 70}) <
		(16 coverAll:
			{74 to: 75}) ] valueCoveringAll:
		{72 to: 72}) ifTrue: [
		[
		(self coverAll:
			{87 to: 90}) error:
			([
			([
			(self coverAll:
				{99 to: 102}) class ] valueCoveringAll:
				{104 to: 108}) errorCardNumberLessThan16Digits ] valueCoveringAll:
				{110 to: 140}) ] valueCoveringAll:
			{92 to: 97} ]] valueCoveringAll:
		{78 to: 84}.
	[
	([
	([
	(aCreditCardNumber
		cover: (146 to: 162)
		declaredAt: (28 to: 44)) size ] valueCoveringAll:
		{164 to: 167}) >
		(16 coverAll:
			{171 to: 172}) ] valueCoveringAll:
		{169 to: 169}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			([
			(self coverAll:
				{196 to: 199}) class ] valueCoveringAll:
				{201 to: 205}) errorCardNumberMoreThan16Digits ] valueCoveringAll:
				{207 to: 237}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.! !
!Behavior method!
initialize
	(stolenCards _ [
	(OrderedCollection
		cover: (29 to: 45)
		declaredAt: (29 to: 45)) new ] valueCoveringAll:
		{47 to: 49})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).
	(registeredCards _ [
	(Dictionary
		cover: (72 to: 81)
		declaredAt: (72 to: 81)) new ] valueCoveringAll:
		{83 to: 85})
		cover: (53 to: 67)
		declaredAt: (53 to: 67).! !
!Behavior method!
registerStolenCard: aCreditCard
	[
	(stolenCards
		cover: (36 to: 46)
		declaredAt: (36 to: 46)) add:
		(aCreditCard
			cover: (53 to: 63)
			declaredAt: (21 to: 31)) ] valueCoveringAll:
		{48 to: 51}.! !
!Behavior method!
registerCard: aCreditCard withBalance: aBalance
	[
	(registeredCards
		cover: (52 to: 66)
		declaredAt: (52 to: 66)) add:
		([
		(aCreditCard
			cover: (73 to: 83)
			declaredAt: (15 to: 25)) ->
			(aBalance
				cover: (88 to: 95)
				declaredAt: (40 to: 47)) ] valueCoveringAll:
			{85 to: 86}) ] valueCoveringAll:
		{68 to: 71}.! !
!Behavior method!
= aCreditCard
	^ [
	(aCreditCard
		cover: (20 to: 30)
		declaredAt: (3 to: 13)) isNumber:
		(creditCardNumber
			cover: (42 to: 57)
			declaredAt: (42 to: 57)) ] valueCoveringAll:
		{32 to: 40}.! !
!Behavior method!
isNumber: aCreditCardNumber
	self.
	^ [
	(aCreditCardNumber
		cover: (35 to: 51)
		declaredAt: (11 to: 27)) =
		(creditCardNumber
			cover: (55 to: 70)
			declaredAt: (55 to: 70)) ] valueCoveringAll:
		{53 to: 53}.! !
!Behavior method!
errorCannotCheckoutEmptyCart
	^ 'Error - No se puede hacer checkout de un carrito vacío' coverAll:
		{32 to: 87}.! !
!Behavior method!
withCatalog: aDictionary
	^ [
	([
	(self coverAll:
		{29 to: 32}) new ] valueCoveringAll:
		{34 to: 36}) initializeWithCatalog:
		(aDictionary
			cover: (61 to: 71)
			declaredAt: (14 to: 24)) ] valueCoveringAll:
		{38 to: 59}.! !
!Behavior method!
initializeWithCatalog: aCatalog
	(catalog _ aCatalog
		cover: (46 to: 53)
		declaredAt: (24 to: 31))
		cover: (35 to: 41)
		declaredAt: (35 to: 41).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard onDate: aDate registerOn: aSalesBook forMerchantProcessor: aMerchantProcessor
	| total |
	[
	(self coverAll:
		{143 to: 146}) assertCartIsNotEmpty:
		(aCart
			cover: (170 to: 174)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{148 to: 168}.
	[
	(self coverAll:
		{178 to: 181}) assertCartHasTheSameCatalog:
		(aCart
			cover: (212 to: 216)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{183 to: 210}.
	[
	(self coverAll:
		{220 to: 223})
		assertCard:
			(aCreditCard
				cover: (237 to: 247)
				declaredAt: (33 to: 43))
		hasNotExpiredOn:
			(aDate
				cover: (266 to: 270)
				declaredAt: (53 to: 57)) ] valueCoveringAll:
		{225 to: 235. 249 to: 264}.
	[
	(self coverAll:
		{274 to: 277})
		assertCard:
			(aCreditCard
				cover: (291 to: 301)
				declaredAt: (33 to: 43))
		isNotStolenFor:
			(aMerchantProcessor
				cover: (319 to: 336)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{279 to: 289. 303 to: 317}.
	[
	(self coverAll:
		{340 to: 343})
		assertCard:
			(aCreditCard
				cover: (357 to: 367)
				declaredAt: (33 to: 43))
		isRegisteredOn:
			(aMerchantProcessor
				cover: (385 to: 402)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{345 to: 355. 369 to: 383}.
	(total _ [
	(aCart
		cover: (417 to: 421)
		declaredAt: (11 to: 15)) totalItemPrice ] valueCoveringAll:
		{423 to: 436})
		cover: (408 to: 412)
		declaredAt: (132 to: 136).
	[
	(self coverAll:
		{442 to: 445})
		assertCard:
			(aCreditCard
				cover: (459 to: 469)
				declaredAt: (33 to: 43))
		canSpend:
			(total
				cover: (481 to: 485)
				declaredAt: (132 to: 136))
		on:
			(aMerchantProcessor
				cover: (491 to: 508)
				declaredAt: (104 to: 121)) ] valueCoveringAll:
		{447 to: 457. 471 to: 479. 487 to: 489}.
	[
	(aSalesBook
		cover: (514 to: 523)
		declaredAt: (71 to: 80)) add:
		(total
			cover: (530 to: 534)
			declaredAt: (132 to: 136)) ] valueCoveringAll:
		{525 to: 528}.
	^ total
		cover: (541 to: 545)
		declaredAt: (132 to: 136).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	[
	([
	(aCart
		cover: (32 to: 36)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{38 to: 44}) ifTrue: [
		[
		(self coverAll:
			{55 to: 58}) error:
			([
			([
			(self coverAll:
				{67 to: 70}) class ] valueCoveringAll:
				{72 to: 76}) errorCannotCheckoutEmptyCart ] valueCoveringAll:
				{78 to: 105}) ] valueCoveringAll:
			{60 to: 65} ]] valueCoveringAll:
		{46 to: 52}.! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/24/2021 16:01:08'!
PASSED!
!Behavior method!
errorCannotCheckoutACartWithADifferentCatalog
	^ 'Error - No se puede hacer checkout de un carrito con un catálogo diferente' coverAll:
		{49 to: 124}.! !
!Behavior method!
assertCartHasTheSameCatalog: aCart
	[
	([
	(aCart
		cover: (39 to: 43)
		declaredAt: (30 to: 34)) hasCatalog:
		(catalog
			cover: (57 to: 63)
			declaredAt: (57 to: 63)) ] valueCoveringAll:
		{45 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) errorCannotCheckoutACartWithADifferentCatalog ] valueCoveringAll:
				{99 to: 143}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
hasCatalog: aCatalog
	^ [
	(catalog
		cover: (24 to: 30)
		declaredAt: (24 to: 30)) =
		(aCatalog
			cover: (34 to: 41)
			declaredAt: (13 to: 20)) ] valueCoveringAll:
		{32 to: 32}.! !

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
assertCard: aCreditCard hasNotExpiredOn: aDate
	self coverAll:
		{94 to: 97}.
	[
	([
	(aCreditCard
		cover: (53 to: 63)
		declaredAt: (13 to: 23)) isExpiredOn:
		(aDate
			cover: (78 to: 82)
			declaredAt: (42 to: 46)) ] valueCoveringAll:
		{65 to: 76}) ifTrue: [
		[
		(self coverAll:
			{106 to: 109}) error:
			([
			([ self class ] valueCoveringAll:
				{111 to: 115}) errorExpiredCard ] valueCoveringAll:
				{117 to: 132}) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{85 to: 91}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	(expirationDate
		cover: (23 to: 36)
		declaredAt: (23 to: 36)) <
		(aDate
			cover: (40 to: 44)
			declaredAt: (14 to: 18)) ] valueCoveringAll:
		{38 to: 38}.! !
!Behavior method!
assertCard: aCreditCard isNotStolenFor: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (63 to: 80)
		declaredAt: (41 to: 58)) isCardStolen:
		(aCreditCard
			cover: (96 to: 106)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{82 to: 94}) ifTrue: [
		[
		(self coverAll:
			{118 to: 121}) error:
			([
			([
			(self coverAll:
				{130 to: 133}) class ] valueCoveringAll:
				{135 to: 139}) errorStolenCard ] valueCoveringAll:
				{141 to: 155}) ] valueCoveringAll:
			{123 to: 128} ]] valueCoveringAll:
		{109 to: 115}.! !
!Behavior method!
isCardStolen: aCreditCard
	^ [
	(stolenCards
		cover: (30 to: 40)
		declaredAt: (30 to: 40)) includes:
		(aCreditCard
			cover: (52 to: 62)
			declaredAt: (15 to: 25)) ] valueCoveringAll:
		{42 to: 50}.! !
!Behavior method!
assertCard: aCreditCard isRegisteredOn: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (64 to: 81)
		declaredAt: (41 to: 58)) isCardRegistered:
		(aCreditCard
			cover: (101 to: 111)
			declaredAt: (13 to: 23)) ] valueCoveringAll:
		{83 to: 99}) ifFalse: [
		[
		(self coverAll:
			{124 to: 127}) error:
			([
			([
			(self coverAll:
				{136 to: 139}) class ] valueCoveringAll:
				{141 to: 145}) errorNotARegisteredCard ] valueCoveringAll:
				{147 to: 169}) ] valueCoveringAll:
			{129 to: 134} ]] valueCoveringAll:
		{114 to: 121}.! !
!Behavior method!
isCardRegistered: aCreditCard
	^ [
	([
	(registeredCards
		cover: (34 to: 48)
		declaredAt: (34 to: 48)) keys ] valueCoveringAll:
		{50 to: 53}) includes:
		(aCreditCard
			cover: (65 to: 75)
			declaredAt: (19 to: 29)) ] valueCoveringAll:
		{55 to: 63}.! !
!Behavior method!
totalItemPrice
	^ [
	(cartItems
		cover: (20 to: 28)
		declaredAt: (20 to: 28)) sum: [ :bookAmountTuple |
		[
		([
		(catalog
			cover: (56 to: 62)
			declaredAt: (56 to: 62)) at:
			([
			(bookAmountTuple
				cover: (68 to: 82)
				declaredAt: (37 to: 51)) first ] valueCoveringAll:
				{84 to: 88}) ] valueCoveringAll:
			{64 to: 66}) *
			([
			(bookAmountTuple
				cover: (93 to: 107)
				declaredAt: (37 to: 51)) second ] valueCoveringAll:
				{109 to: 114}) ] valueCoveringAll:
			{91 to: 91} ]] valueCoveringAll:
		{30 to: 33}.! !
!Behavior method!
assertCard: aCreditCard canSpend: aTotal on: aMerchantProcessor
	[
	([
	(aMerchantProcessor
		cover: (69 to: 86)
		declaredAt: (46 to: 63))
		can:
			(aCreditCard
				cover: (93 to: 103)
				declaredAt: (13 to: 23))
		spend:
			(aTotal
				cover: (112 to: 117)
				declaredAt: (35 to: 40)) ] valueCoveringAll:
		{88 to: 91. 105 to: 110}) ifFalse: [
		[
		(self coverAll:
			{130 to: 133}) error:
			([
			([
			(self coverAll:
				{142 to: 145}) class ] valueCoveringAll:
				{147 to: 151}) errorCardDoesNotHaveEnoughBalance ] valueCoveringAll:
				{153 to: 185}) ] valueCoveringAll:
			{135 to: 140} ]] valueCoveringAll:
		{120 to: 127}.! !
!Behavior method!
can: aCreditCard spend: aTotal
	| storedCard |
	[
	(registeredCards
		cover: (53 to: 67)
		declaredAt: (53 to: 67)) keysDo: [ :storedCreditCard |
		[
		([
		(storedCreditCard
			cover: (103 to: 118)
			declaredAt: (82 to: 97)) =
			(aCreditCard
				cover: (122 to: 132)
				declaredAt: (6 to: 16)) ] valueCoveringAll:
			{120 to: 120}) ifTrue: [
			(storedCard _ storedCreditCard
				cover: (157 to: 172)
				declaredAt: (82 to: 97))
				cover: (143 to: 152)
				declaredAt: (37 to: 46) ]] valueCoveringAll:
			{134 to: 140} ]] valueCoveringAll:
		{69 to: 75}.
	^ [
	([
	(registeredCards
		cover: (187 to: 201)
		declaredAt: (53 to: 67)) at:
		(storedCard
			cover: (206 to: 215)
			declaredAt: (37 to: 46)) ] valueCoveringAll:
		{203 to: 205}) >=
		(aTotal
			cover: (221 to: 226)
			declaredAt: (25 to: 30)) ] valueCoveringAll:
		{218 to: 219}.! !

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorExpiredCard
	^ 'Error - No se puede hacer checkout con una tarjeta de crédito vacía' coverAll:
		{20 to: 88}.! !

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorStolenCard
	^ 'Error - No se puede realizar una transacción con una tarjeta robada' coverAll:
		{19 to: 87}.! !

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorNotARegisteredCard
	^ 'Error - La tarjeta utilizada no se encuentra registrada' coverAll:
		{27 to: 83}.! !

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardDoesNotHaveEnoughBalance
	^ 'Error - La tarjeta de crédito no tiene suficiente saldo' coverAll:
		{38 to: 94}.! !

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorOwnerEmpty
	^ 'Error - El nombre dueño de la tarjeta de crédito no puede estar vacío' coverAll:
		{19 to: 89}.! !

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardNumberLessThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene menos de 16 dígitos' coverAll:
		{35 to: 104}.! !

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCardNumberMoreThan16Digits
	^ 'Error - El número de la tarjeta de crédito tiene más de 16 dígitos' coverAll:
		{35 to: 102}.! !

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
initialize
	(currentTime _ 0 coverAll:
		{29 to: 29})
		cover: (14 to: 24)
		declaredAt: (14 to: 24).! !
!Behavior method!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	^ [
	([
	(self coverAll:
		{77 to: 80}) new ] valueCoveringAll:
		{82 to: 84})
		initializeFor:
			(aUserDataDictionary
				cover: (101 to: 119)
				declaredAt: (12 to: 30))
		withCatalog:
			(aCatalog
				cover: (134 to: 141)
				declaredAt: (45 to: 52))
		withTimer:
			(aTimer
				cover: (154 to: 159)
				declaredAt: (65 to: 70)) ] valueCoveringAll:
		{86 to: 99. 121 to: 132. 143 to: 152}.! !
!Behavior method!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer
	(datosUsuarios _ aUserDataDictionary
		cover: (97 to: 115)
		declaredAt: (16 to: 34))
		cover: (80 to: 92)
		declaredAt: (80 to: 92).
	(catalog _ aCatalog
		cover: (130 to: 137)
		declaredAt: (49 to: 56))
		cover: (119 to: 125)
		declaredAt: (119 to: 125).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(cartTimers _ [
	(Dictionary
		cover: (181 to: 190)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{192 to: 194})
		cover: (167 to: 176)
		declaredAt: (167 to: 176).
	(lastId _ 0 coverAll:
		{208 to: 208})
		cover: (198 to: 203)
		declaredAt: (198 to: 203).
	(timer _ aTimer
		cover: (221 to: 226)
		declaredAt: (69 to: 74))
		cover: (212 to: 216)
		declaredAt: (212 to: 216).
	(userPurchases _ [
	(Dictionary
		cover: (249 to: 258)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{260 to: 262})
		cover: (232 to: 244)
		declaredAt: (232 to: 244).
	[
	(datosUsuarios
		cover: (268 to: 280)
		declaredAt: (80 to: 92)) keysDo: [ :aUserId |
		[
		(userPurchases
			cover: (310 to: 322)
			declaredAt: (232 to: 244)) add:
			([
			(aUserId
				cover: (329 to: 335)
				declaredAt: (296 to: 302)) ->
				([
				(Dictionary
					cover: (340 to: 349)
					declaredAt: (150 to: 159)) new ] valueCoveringAll:
					{351 to: 353}) ] valueCoveringAll:
				{337 to: 338}) ] valueCoveringAll:
			{324 to: 327}.
		[
		([
		(userPurchases
			cover: (360 to: 372)
			declaredAt: (232 to: 244)) at:
			(aUserId
				cover: (378 to: 384)
				declaredAt: (296 to: 302)) ] valueCoveringAll:
			{374 to: 376}) add:
			([
			('totalBooks' coverAll:
				{392 to: 403}) ->
				(0 coverAll:
					{408 to: 408}) ] valueCoveringAll:
				{405 to: 406}) ] valueCoveringAll:
			{387 to: 390} ]] valueCoveringAll:
		{282 to: 288}.! !
!Behavior method!
errorWrongUserCredentials
	^ 'Error - Las credenciales del usuario no son correctas' coverAll:
		{29 to: 83}.! !
!Behavior method!
createCartForUser: aUser password: aPassword
	| newId |
	[
	(self coverAll:
		{61 to: 64})
		assertUser:
			(aUser
				cover: (78 to: 82)
				declaredAt: (20 to: 24))
		existsWithPassword:
			(aPassword
				cover: (104 to: 112)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{66 to: 76. 84 to: 102}.
	(newId _ [
	(lastId
		cover: (127 to: 132)
		declaredAt: (127 to: 132)) +
		(1 coverAll:
			{136 to: 136}) ] valueCoveringAll:
		{134 to: 134})
		cover: (118 to: 122)
		declaredAt: (52 to: 56).
	[
	(carts
		cover: (140 to: 144)
		declaredAt: (140 to: 144)) add:
		([
		(newId
			cover: (151 to: 155)
			declaredAt: (52 to: 56)) ->
			([
			(OrderedCollection
				cover: (160 to: 176)
				declaredAt: (160 to: 176)) new ] valueCoveringAll:
				{178 to: 180}) ] valueCoveringAll:
			{157 to: 158}) ] valueCoveringAll:
		{146 to: 149}.
	[
	(cartTimers
		cover: (184 to: 193)
		declaredAt: (184 to: 193)) add:
		([
		(newId
			cover: (200 to: 204)
			declaredAt: (52 to: 56)) ->
			([
			(timer
				cover: (209 to: 213)
				declaredAt: (209 to: 213)) currentTime ] valueCoveringAll:
				{215 to: 225}) ] valueCoveringAll:
			{206 to: 207}) ] valueCoveringAll:
		{195 to: 198}.
	[
	([
	(carts
		cover: (232 to: 236)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (242 to: 246)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{238 to: 240}) add:
		([
		(Cart
			cover: (255 to: 258)
			declaredAt: (255 to: 258)) createNewWithCatalog:
			(catalog
				cover: (282 to: 288)
				declaredAt: (282 to: 288)) ] valueCoveringAll:
			{260 to: 280}) ] valueCoveringAll:
		{249 to: 252}.
	[
	([
	(carts
		cover: (294 to: 298)
		declaredAt: (140 to: 144)) at:
		(newId
			cover: (304 to: 308)
			declaredAt: (52 to: 56)) ] valueCoveringAll:
		{300 to: 302}) add:
		(aUser
			cover: (316 to: 320)
			declaredAt: (20 to: 24)) ] valueCoveringAll:
		{311 to: 314}.
	(lastId _ newId
		cover: (336 to: 340)
		declaredAt: (52 to: 56))
		cover: (326 to: 331)
		declaredAt: (127 to: 132).
	^ newId
		cover: (347 to: 351)
		declaredAt: (52 to: 56).! !
!Behavior method!
assertUser: aUser existsWithPassword: aPassword
	self coverAll:
		{143 to: 146}.
	[
	([
	([
	(datosUsuarios
		cover: (54 to: 66)
		declaredAt: (54 to: 66)) includesKey:
		(aUser
			cover: (81 to: 85)
			declaredAt: (13 to: 17)) ] valueCoveringAll:
		{68 to: 79}) and: [
		[
		([
		(datosUsuarios
			cover: (95 to: 107)
			declaredAt: (54 to: 66)) at:
			(aUser
				cover: (112 to: 116)
				declaredAt: (13 to: 17)) ] valueCoveringAll:
			{109 to: 111}) =
			(aPassword
				cover: (121 to: 129)
				declaredAt: (39 to: 47)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{88 to: 91}) ifFalse: [
		[
		(self coverAll:
			{155 to: 158}) error:
			([
			([ self class ] valueCoveringAll:
				{160 to: 164}) errorWrongUserCredentials ] valueCoveringAll:
				{166 to: 190}) ] valueCoveringAll:
			{148 to: 153} ]] valueCoveringAll:
		{133 to: 140}.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
currentTime
	^ currentTime
		cover: (16 to: 26)
		declaredAt: (16 to: 26).! !

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
errorCartIdDoesNotExist
	^ 'Error - No existe un carrito con esa ID' coverAll:
		{27 to: 67}.! !
!Behavior method!
add: anAmount ofItem: anItemID toCart: aCartID
	| cart |
	(cart _ [
	(self coverAll:
		{72 to: 75}) cartForId:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{77 to: 86})
		cover: (64 to: 67)
		declaredAt: (54 to: 57).
	[
	(self coverAll:
		{100 to: 103}) assertCartTimerDidNotExpireFor:
		(aCartID
			cover: (137 to: 143)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{105 to: 135}.
	[
	(cart
		cover: (149 to: 152)
		declaredAt: (54 to: 57))
		add:
			(anItemID
				cover: (159 to: 166)
				declaredAt: (23 to: 30))
		amount:
			(anAmount
				cover: (176 to: 183)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
		{154 to: 157. 168 to: 174}.
	[
	(self coverAll:
		{189 to: 192}) updateCartTimerFor:
		(aCartID
			cover: (214 to: 220)
			declaredAt: (40 to: 46)) ] valueCoveringAll:
		{194 to: 212}.! !
!Behavior method!
cartForId: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{64 to: 66}) first ] valueCoveringAll:
		{77 to: 81}.! !
!Behavior method!
assertCartExists: aCartID
	self coverAll:
		{70 to: 73}.
	[
	([
	(carts
		cover: (32 to: 36)
		declaredAt: (32 to: 36)) includesKey:
		(aCartID
			cover: (51 to: 57)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{38 to: 49}) ifFalse: [
		[
		(self coverAll:
			{82 to: 85}) error:
			([
			([ self class ] valueCoveringAll:
				{87 to: 91}) errorCartIdDoesNotExist ] valueCoveringAll:
				{93 to: 115}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{60 to: 67}.! !

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
assertCartTimerDidNotExpireFor: aCartID
	| cartTimer |
	(cartTimer _ [
	(cartTimers
		cover: (73 to: 82)
		declaredAt: (73 to: 82)) at:
		(aCartID
			cover: (88 to: 94)
			declaredAt: (33 to: 39)) ] valueCoveringAll:
		{84 to: 86})
		cover: (60 to: 68)
		declaredAt: (45 to: 53).
	[
	([
	(timer
		cover: (101 to: 105)
		declaredAt: (101 to: 105))
		isDifferenceWith:
			(cartTimer
				cover: (125 to: 133)
				declaredAt: (45 to: 53))
		biggerThan:
			(30 coverAll:
				{147 to: 148}) ] valueCoveringAll:
		{107 to: 123. 135 to: 145}) ifTrue: [
		[
		(self coverAll:
			{160 to: 163}) error:
			([
			([
			(self coverAll:
				{172 to: 175}) class ] valueCoveringAll:
				{177 to: 181}) errorCartExpired ] valueCoveringAll:
				{183 to: 198}) ] valueCoveringAll:
			{165 to: 170} ]] valueCoveringAll:
		{151 to: 157}.! !
!Behavior method!
isDifferenceWith: aTime biggerThan: anAmountOfTime
	^ [
	([
	([
	(currentTime
		cover: (58 to: 68)
		declaredAt: (58 to: 68)) -
		(aTime
			cover: (72 to: 76)
			declaredAt: (19 to: 23)) ] valueCoveringAll:
		{70 to: 70}) abs ] valueCoveringAll:
		{79 to: 81}) >
		(anAmountOfTime
			cover: (85 to: 98)
			declaredAt: (37 to: 50)) ] valueCoveringAll:
		{83 to: 83}.! !
!Behavior method!
updateCartTimerFor: aCartID
	[
	(cartTimers
		cover: (31 to: 40)
		declaredAt: (31 to: 40))
		at:
			(aCartID
				cover: (46 to: 52)
				declaredAt: (21 to: 27))
		put:
			([
			(timer
				cover: (59 to: 63)
				declaredAt: (59 to: 63)) currentTime ] valueCoveringAll:
				{65 to: 75}) ] valueCoveringAll:
		{42 to: 44. 54 to: 57}.! !
!Behavior method!
listCart: aCartId
	| cartItemList cart |
	(cart _ [
	(self coverAll:
		{56 to: 59}) cartForId:
		(aCartId
			cover: (72 to: 78)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{61 to: 70})
		cover: (48 to: 51)
		declaredAt: (38 to: 41).
	[
	(self coverAll:
		{85 to: 88}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (122 to: 128)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{90 to: 120}.
	(cartItemList _ [
	(cart
		cover: (150 to: 153)
		declaredAt: (38 to: 41)) itemListFor:
		(self coverAll:
			{168 to: 171}) ] valueCoveringAll:
		{155 to: 166})
		cover: (134 to: 145)
		declaredAt: (25 to: 36).
	[
	(self coverAll:
		{177 to: 180}) updateCartTimerFor:
		(aCartId
			cover: (202 to: 208)
			declaredAt: (11 to: 17)) ] valueCoveringAll:
		{182 to: 200}.
	^ cartItemList
		cover: (215 to: 226)
		declaredAt: (25 to: 36).! !
!Behavior method!
itemListFor: aMockRestInterface
	^ [
	(aMockRestInterface
		cover: (35 to: 52)
		declaredAt: (14 to: 31)) listCartItemsFor:
		(cartItems
			cover: (72 to: 80)
			declaredAt: (72 to: 80)) ] valueCoveringAll:
		{54 to: 70}.! !
!Behavior method!
listCartItemsFor: aCartItemList
	^ aCartItemList
		cover: (35 to: 47)
		declaredAt: (19 to: 31).! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
listPurchasesForUser: aUser withPassword: aPassword
	[
	(self coverAll:
		{57 to: 60})
		assertUser:
			(aUser
				cover: (74 to: 78)
				declaredAt: (23 to: 27))
		existsWithPassword:
			(aPassword
				cover: (100 to: 108)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{62 to: 72. 80 to: 98}.
	^ [
	(userPurchases
		cover: (115 to: 127)
		declaredAt: (115 to: 127)) at:
		(aUser
			cover: (133 to: 137)
			declaredAt: (23 to: 27)) ] valueCoveringAll:
		{129 to: 131}.! !

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook
	| cartToCheckout creditCard cashier cartUser |
	(cartToCheckout _ [
	(self coverAll:
		{240 to: 243}) cartForId:
		(aCartId
			cover: (256 to: 262)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{245 to: 254})
		cover: (222 to: 235)
		declaredAt: (174 to: 187).
	(cartUser _ [
	(self coverAll:
		{278 to: 281}) userOfCart:
		(aCartId
			cover: (295 to: 301)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{283 to: 293})
		cover: (266 to: 273)
		declaredAt: (208 to: 215).
	(creditCard _ [
	(CreditCard
		cover: (319 to: 328)
		declaredAt: (319 to: 328))
		forOwner:
			(anOwner
				cover: (340 to: 346)
				declaredAt: (94 to: 100))
		withNumber:
			(aCreditCardNumber
				cover: (360 to: 376)
				declaredAt: (39 to: 55))
		withExpirationDate:
			(aDate
				cover: (398 to: 402)
				declaredAt: (77 to: 81)) ] valueCoveringAll:
		{330 to: 338. 348 to: 358. 378 to: 396})
		cover: (305 to: 314)
		declaredAt: (189 to: 198).
	(cashier _ [
	(Cashier
		cover: (419 to: 425)
		declaredAt: (419 to: 425)) withCatalog:
		(catalog
			cover: (440 to: 446)
			declaredAt: (440 to: 446)) ] valueCoveringAll:
		{427 to: 438})
		cover: (408 to: 414)
		declaredAt: (200 to: 206).
	[
	(self coverAll:
		{452 to: 455}) assertCartTimerDidNotExpireFor:
		(aCartId
			cover: (489 to: 495)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{457 to: 487}.
	[
	(cashier
		cover: (501 to: 507)
		declaredAt: (200 to: 206))
		checkout:
			(cartToCheckout
				cover: (519 to: 532)
				declaredAt: (174 to: 187))
		withCreditCard:
			(creditCard
				cover: (553 to: 562)
				declaredAt: (189 to: 198))
		onDate:
			([
			(FixedGregorianDate
				cover: (575 to: 592)
				declaredAt: (575 to: 592)) today ] valueCoveringAll:
				{594 to: 598})
		registerOn:
			(aSalesBook
				cover: (614 to: 623)
				declaredAt: (155 to: 164))
		forMerchantProcessor:
			(aMerchantProcessor
				cover: (649 to: 666)
				declaredAt: (124 to: 141)) ] valueCoveringAll:
		{509 to: 517. 537 to: 551. 567 to: 573. 602 to: 612. 627 to: 647}.
	[
	(self coverAll:
		{672 to: 675})
		updatePurchasesFor:
			(cartUser
				cover: (697 to: 704)
				declaredAt: (208 to: 215))
		withCart:
			(aCartId
				cover: (716 to: 722)
				declaredAt: (15 to: 21))
		withTotal:
			([
			(cartToCheckout
				cover: (735 to: 748)
				declaredAt: (174 to: 187)) totalItemPrice ] valueCoveringAll:
				{750 to: 763}) ] valueCoveringAll:
		{677 to: 695. 706 to: 714. 724 to: 733}.! !

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
userOfCart: aCartId
	[
	(self coverAll:
		{23 to: 26}) assertCartExists:
		(aCartId
			cover: (46 to: 52)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{28 to: 44}.
	^ [
	([
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(aCartId
			cover: (68 to: 74)
			declaredAt: (13 to: 19)) ] valueCoveringAll:
		{64 to: 66}) second ] valueCoveringAll:
		{77 to: 82}.! !
!Behavior method!
updatePurchasesFor: aUser withCart: aCartId withTotal: aTotal
	self coverAll:
		{69 to: 72}.
	[
	([
	self listCart:
		(aCartId
			cover: (84 to: 90)
			declaredAt: (37 to: 43)) ] valueCoveringAll:
		{74 to: 82}) do: [ :aBookAmountTuple |
		[
		([
		(userPurchases
			cover: (124 to: 136)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (142 to: 146)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{138 to: 140})
			at:
				([
				(aBookAmountTuple
					cover: (153 to: 168)
					declaredAt: (102 to: 117)) first ] valueCoveringAll:
					{170 to: 174})
			ifPresent: [ :cant |
				[
				([
				(userPurchases
					cover: (200 to: 212)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (218 to: 222)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{214 to: 216})
					at:
						([
						(aBookAmountTuple
							cover: (229 to: 244)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{246 to: 250})
					put:
						([
						(cant
							cover: (257 to: 260)
							declaredAt: (192 to: 195)) +
							([
							(aBookAmountTuple
								cover: (264 to: 279)
								declaredAt: (102 to: 117)) second ] valueCoveringAll:
								{281 to: 286}) ] valueCoveringAll:
							{262 to: 262}) ] valueCoveringAll:
					{225 to: 227. 252 to: 255} ]
			ifAbsent: [
				[
				([
				(userPurchases
					cover: (304 to: 316)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (322 to: 326)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{318 to: 320})
					at:
						([
						(aBookAmountTuple
							cover: (333 to: 348)
							declaredAt: (102 to: 117)) first ] valueCoveringAll:
							{350 to: 354})
					put:
						([
						(aBookAmountTuple
							cover: (361 to: 376)
							declaredAt: (102 to: 117)) second ] valueCoveringAll:
							{378 to: 383}) ] valueCoveringAll:
					{329 to: 331. 356 to: 359} ]] valueCoveringAll:
			{149 to: 151. 180 to: 189. 293 to: 301}.
		[
		([
		(userPurchases
			cover: (390 to: 402)
			declaredAt: (124 to: 136)) at:
			(aUser
				cover: (407 to: 411)
				declaredAt: (21 to: 25)) ] valueCoveringAll:
			{404 to: 406})
			at:
				('totalBooks' coverAll:
					{418 to: 429})
			put:
				([
				([
				([
				(userPurchases
					cover: (438 to: 450)
					declaredAt: (124 to: 136)) at:
					(aUser
						cover: (455 to: 459)
						declaredAt: (21 to: 25)) ] valueCoveringAll:
					{452 to: 454}) at:
					('totalBooks' coverAll:
						{466 to: 477}) ] valueCoveringAll:
					{462 to: 464}) +
					(aTotal
						cover: (482 to: 487)
						declaredAt: (56 to: 61)) ] valueCoveringAll:
					{480 to: 480}) ] valueCoveringAll:
			{414 to: 416. 431 to: 434} ]] valueCoveringAll:
		{93 to: 95}.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!
!Behavior method!
passTime: anAmontOfTime
	(currentTime _ [
	(currentTime
		cover: (27 to: 37)
		declaredAt: (27 to: 37)) +
		(anAmontOfTime
			cover: (56 to: 68)
			declaredAt: (11 to: 23)) ] valueCoveringAll:
		{54 to: 54})
		cover: (42 to: 52)
		declaredAt: (27 to: 37).! !
!Behavior method!
errorCartExpired
	^ 'Error - El carrito utilizado expiró' coverAll:
		{21 to: 57}.! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/24/2021 16:01:09'!
PASSED!

----QUIT----(24 June 2021 16:06:25) CuisUniversity-4532.image priorSource: 17599159!

----STARTUP---- (24 June 2021 21:00:34) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/StringsServicesServer.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Features/Compression.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Features/Sound.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/WebClient.pck.st----!

----QUIT----(24 June 2021 22:17:15) CuisUniversity-4532.image priorSource: 17791366!

----STARTUP---- (27 June 2021 18:31:24) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


pepe := StringsServicesRestInterface listeningOn: 8080!

TestCase subclass: #RestInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #RestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 6/27/2021 18:42:58'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

Object subclass: #RestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #RestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/27/2021 18:48:16'!
Object subclass: #RestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

pepe destroy.!
!RestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/27/2021 19:10:29'!
test01! !
!RestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/27/2021 19:15:23' prior: 50924499!
test01

	! !

pepe := StringsServicesRestInterface listeningOn: 8080.!

pepe!
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:28:14' prior: 50920773!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	self halt.
	^self dispatchRequest: request url: request url! !

request url!
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:29:22' prior: 50924509!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	"self halt."
	^self dispatchRequest: request url: request url! !
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:30:56' prior: 50924517!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	self halt.
	^self dispatchRequest: request url: request url! !

request url!

request!
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:32:34' prior: 50924525!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	"self halt."
	^self dispatchRequest: request url: request url! !

pepe destroy.!
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:33:56' prior: 50920148!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	self halt.
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !

pepe := StringsServicesRestInterface listeningOn: 8080.!

stream ascii!

String crlfString!

request!

stream ascii!
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:35:57' prior: 50924543!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:36:22' prior: 50920118!
initializeFromUrl: urlString
	"Initialize the client from a http url or string"

	| urlStream |
	self halt.
	urlStream := urlString readStream.
	"Skip past scheme if present"
	urlStream upToAll: '://'.
	urlStream atEnd 
		ifTrue:[rawUrl := urlString]
		ifFalse:[rawUrl := urlStream upTo: $/; upToEnd].
	(rawUrl beginsWith: '/') ifFalse:[rawUrl := '/', rawUrl].
! !

pepe destroy.!

pepe := StringsServicesRestInterface listeningOn: 8080.!
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:36:58' prior: 50924592!
initializeFromUrl: urlString
	"Initialize the client from a http url or string"

	| urlStream |
	urlStream := urlString readStream.
	"Skip past scheme if present"
	urlStream upToAll: '://'.
	urlStream atEnd 
		ifTrue:[rawUrl := urlString]
		ifFalse:[rawUrl := urlStream upTo: $/; upToEnd].
	(rawUrl beginsWith: '/') ifFalse:[rawUrl := '/', rawUrl].
! !

pepe!

(WebRequest new initializeFromUrl: 'localhost:8080/quote')!

self dispatchRequest: (WebRequest new initializeFromUrl: 'localhost:8080/quote'). !

(WebRequest new initializeFromUrl: 'http://localhost:8080/quote')!

self dispatchRequest: (WebRequest new initializeFromUrl: 'http://localhost:8080/quote'). !
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:41:32' prior: 50924534!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	self halt.
	^self dispatchRequest: request url: request url! !

request!

self class!

self class!

self class!
!WebRequest class methodsFor: 'instance creation' stamp: 'G.L.S 6/27/2021 19:43:48' prior: 50920501 overrides: 16882927!
readFrom: aStream
	"Create a WebRequest from a given stream"
	self halt.
	^self new readFrom: aStream! !
!WebServer methodsFor: 'handling' stamp: 'G.L.S 6/27/2021 19:44:15' prior: 50924633!
dispatchRequest: request
	"Look up the handler for a given request and dispatch to it"
	"self halt."
	^self dispatchRequest: request url: request url! !
!WebRequest class methodsFor: 'instance creation' stamp: 'G.L.S 6/27/2021 19:50:56' prior: 50924644 overrides: 16882927!
readFrom: aStream
	"Create a WebRequest from a given stream"
	^self new readFrom: aStream! !
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:55:53' prior: 50924570!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	self halt.
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:57:38' prior: 50924665!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	"self halt."
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 19:59:22' prior: 50924688!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	self halt.
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !
!WebRequest methodsFor: 'initialize' stamp: 'G.L.S 6/27/2021 20:00:12' prior: 50924711!
readFrom: aStream
	"Initialize the receiver initialized from an existing socket stream 
	This method will block until the headers have been parsed."

	| tokens |
	"self halt."
	stream := aStream.
	stream isBinary ifTrue:[stream ascii].
	"Parse request header"
	request := stream upToAll: String crlfString.
	tokens := request findTokens: ' '.
	tokens size < 2 ifTrue:[^self error: 'Invalid HTTP request: ', request].
	method := tokens first.
	rawUrl := tokens second.
	tokens size > 2 
		ifTrue:[protocol := tokens third]
		ifFalse:[protocol := 'HTTP/1.0'].

	"Parse HTTP header"
	headers := WebUtils readHeadersFrom: stream.
! !

self dispatchRequest: (WebRequest new initializeFromUrl: '/quote' )!

pepe destroy.!
!RestInterface class methodsFor: 'no messages' stamp: 'G.L.S 6/27/2021 20:47:31'!
listeningOn: aPortNumber

	^self new initializeWith: aPortNumber.! !
!RestInterface methodsFor: 'nil' stamp: 'G.L.S 6/27/2021 20:48:02'!
initializeWith: aPortNumber! !

----QUIT----(27 June 2021 23:34:42) CuisUniversity-4532.image priorSource: 18970115!

----STARTUP---- (28 June 2021 15:44:36) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


!classDefinition: #RestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:48:07'!
Object subclass: #RestInterface
	instanceVariableNames: 'mockInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #RestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:48:26'!
Object subclass: #RestInterface
	instanceVariableNames: 'mockInterface port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #RestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:48:27'!
Object subclass: #RestInterface
	instanceVariableNames: 'mockInterface port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:47:58' prior: 50924764!
initializeWith: aPortNumber

	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:48:38' prior: 50924798!
initializeWith: aPortNumber

	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:50:23' prior: 50924815!
initializeWith: aPortNumber

	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

Object subclass: #StoreObjectFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:51:31'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory class methodsFor: 'no messages' stamp: 'G.L.S 6/28/2021 15:53:27'!
createDefaultCatalog

	! !

!classDefinition: 'StoreObjectFactory class' category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:54:39'!
StoreObjectFactory class
	instanceVariableNames: 'smalltalk80'!

!classDefinition: 'StoreObjectFactory class' category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:54:40'!
StoreObjectFactory class
	instanceVariableNames: 'smalltalk80 designPatterns'!

!classDefinition: 'StoreObjectFactory class' category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:54:42'!
StoreObjectFactory class
	instanceVariableNames: 'designPatterns smalltalk80 objectThinking'!
!StoreObjectFactory class methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:54:35' prior: 50924861!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50.
	
	^catalog! !

!methodRemoval: StoreObjectFactory class #createDefaultCatalog stamp: 'G.L.S 6/28/2021 15:56:14'!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50.
	
	^catalog!

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:56:22'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:56:23'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:56:25'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory methodsFor: 'no messages' stamp: 'G.L.S 6/28/2021 15:56:21'!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50.
	
	^catalog! !

StoreObjectFactory class
	instanceVariableNames: ''!

!classDefinition: 'StoreObjectFactory class' category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:56:36'!
StoreObjectFactory class
	instanceVariableNames: ''!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:56:56' overrides: 16896425!
initialize

! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:56:56' prior: 50924943 overrides: 16896425!
initialize

	! !

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:57:20'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:57:18' prior: 50924948 overrides: 16896425!
initialize

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:58:19'!
createDefaultSalesBook

	^ OrderedCollection new.! !

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 15:58:51'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking donQuixote userData'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:58:49'!
createDefaultUserData

	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:58:55' prior: 50924984!
createDefaultUserData

	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 15:58:56' prior: 50924992!
createDefaultUserData

	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:00:57' prior: 50925000!
createDefaultUserData
	
	
	
	"userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'."! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:01:00' prior: 50925008!
createDefaultUserData
	
	"userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'."! !

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 16:01:09'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking donQuixote'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:01:32' prior: 50925016!
createDefaultUserData
	
	| userData |
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	^ userData.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:03:05'!
createEmptyCatalog

	^Dictionary new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:03:47'!
createSingleItemCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: donQuixote -> 10.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:06:09' prior: 50925046!
createSingleItemCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: donQuixote -> 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:07:34'!
createDefaultTimer

	^MockTimer new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:07:46'!
createRealTimer

	"nada"! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:08:01' prior: 50925065!
createRealTimer

	self shouldBeImplemented.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:08:58'!
createMerchantProcesor

	^MockMerchantProcesor new! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:11:48' prior: 50924832!
initializeWith: aPortNumber

	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '' action: [ :request |
		[]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

!classDefinition: #RestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 16:12:48'!
Object subclass: #RestInterface
	instanceVariableNames: 'mockInterface port webServer storeOF'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:12:44' prior: 50925080!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '' action: [ :request |
		[]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:13:05'!
createMockInterface

	MockRestInterface createFor: '' withCatalog: '' withTimer: ''.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:13:29' prior: 50925131!
createMockInterface

	| mockInterface |
	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	^ mockInterface! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:13:35' prior: 50925138!
createMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	^mockInterface! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:13:48'!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	^mockInterface! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:13:48' prior: 50925110!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '' action: [ :request |
		[]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

!methodRemoval: StoreObjectFactory #createMockInterface stamp: 'G.L.S 6/28/2021 16:13:48'!
createMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: '' withCatalog: '' withTimer: ''.
	
	^mockInterface!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:14:44' prior: 50925154!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData withCatalog: self createDefaultCatalog withTimer: self createDefaultTimer.
	
	^mockInterface! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:15:41'!
createDefaultMockTimer

	^MockTimer new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:15:41' prior: 50925191!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData withCatalog: self createDefaultCatalog withTimer: self createDefaultMockTimer.
	
	^mockInterface! !

!methodRemoval: StoreObjectFactory #createDefaultTimer stamp: 'G.L.S 6/28/2021 16:15:41'!
createDefaultTimer

	^MockTimer new.!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:16:05'!
createDefaultTimer

	self shouldBeImplemented.! !

!methodRemoval: StoreObjectFactory #createRealTimer stamp: 'G.L.S 6/28/2021 16:16:05'!
createRealTimer

	self shouldBeImplemented.!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:17:42' prior: 50925206!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData withCatalog: self createDefaultCatalog withTimer: self createDefaultTimer.
	
	^mockInterface! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/28/2021 16:18:55' prior: 50880912 overrides: 16927572!
setUp
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := MockTimer new.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:19:04'!
PASSED!

!classRemoval: #RestInterfaceTest stamp: 'G.L.S 6/28/2021 16:29:12'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

b := DateAndTime now.!

b!

b !

b + 30.!

b + 30 minutes.!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:33:36' prior: 50881236!
passTime: anAmontOfTime

	currentTime := currentTime + anAmontOfTime minutes.! !
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 16:33:51' prior: 50880890 overrides: 16896425!
initialize

	currentTime := DateAndTime now.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:34:53' prior: 50881159!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^ ((currentTime - aTimer) abs > anAmountOfTime).! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:34:56' prior: 50925332!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	"^ ((currentTime - aTimer) abs > anAmountOfTime)."! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:35:29'!
now

	^currentTime.! !
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 16:35:29' prior: 50881190!
updateCartTimerFor: aCartID

	cartTimers at: aCartID put: timer now.
	! !

!methodRemoval: MockTimer #currentTime stamp: 'G.L.S 6/28/2021 16:35:29'!
currentTime

	^currentTime.!

c := DateAndTime now.!

b !

c!

b - c.!

(b - c)  !

(b - c) minutes.!

(b - c) minutes abs.!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:38:43' prior: 50925338!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^((currentTime - aTimer) minutes abs > anAmountOfTime).
	
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:43:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:43:33'!
FAILURE!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:43:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:43:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:43:34'!
ERROR!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:43:34'!
ERROR!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:43:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:43:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:43:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:43:34'!
ERROR!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:43:34'!
ERROR!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:43:53'!
ERROR!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:43:53'!
ERROR!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 16:44:11' prior: 50881101!
createCartForUser: aUser password: aPassword 
	
	| newId |
	self assertUser: aUser existsWithPassword: aPassword.
	
	newId := lastId + 1.
	carts add: newId -> OrderedCollection new.
	cartTimers add: newId -> timer now.
	
	(carts at: newId) add: (Cart createNewWithCatalog: catalog).
	(carts at: newId) add: aUser.
	
	lastId := newId.
	
	^newId.! !

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:44:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:44:20'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:44:31'!
PASSED!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:46:01' prior: 50925344!
now

	^DateAndTime now.! !
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 16:46:18' prior: 50925327 overrides: 16896425!
initialize

! !
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 16:46:19' prior: 50925627 overrides: 16896425!
initialize! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:46:58' prior: 50925360!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^((self now - aTimer) minutes abs > anAmountOfTime).
	
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:47:35'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:47:35'!
ERROR!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:47:35'!
ERROR!
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 16:48:37' prior: 50925631 overrides: 16896425!
initialize

	currentTime := DateAndTime now.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:50:22' prior: 50925635!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^((currentTime - aTimer) minutes abs > anAmountOfTime).
	
	! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:50:30' prior: 50925622!
now

	^currentTime! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 16:50:31' prior: 50925700!
now

	^currentTime.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:50:36'!
PASSED!
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 16:57:33'!
initialize: aTime

	currentTime := aTime.! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/28/2021 16:58:09' prior: 50925240 overrides: 16927572!
setUp
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new) initialize: DateAndTime now.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:58:11'!
PASSED!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/28/2021 16:58:32' prior: 50925755 overrides: 16927572!
setUp
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	timer initialize: DateAndTime now.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 16:58:33'!
PASSED!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:55:37' prior: 50925704!
now
	currentTime := DateAndTime now.
	^currentTime.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:55:38' prior: 50925904!
now
	currentTime := DateAndTime now.
	
	^currentTime.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:55:42' prior: 50925909!
now
	currentTime := DateAndTime now.
	^currentTime.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 17:55:44'!
PASSED!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:56:03' prior: 50925693!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^((self now - aTimer) minutes abs > anAmountOfTime).
	
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 17:56:08'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 17:56:08'!
FAILURE!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 17:56:08'!
FAILURE!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:56:42' prior: 50925960!
isDifferenceWith: aTimer biggerThan: anAmountOfTime

	^((currentTime - aTimer) minutes abs > anAmountOfTime).
	
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 17:56:53'!
PASSED!
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 17:57:56' prior: 50881208!
assertCartTimerDidNotExpireFor: aCartID

	| cartTimer |
	
	cartTimer := cartTimers at: aCartID.
	
	(timer isDifferenceWith: cartTimer biggerThan: 30) ifTrue: [self error: self class errorCartExpired].
! !

!classDefinition: #MockTimer category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 17:59:01'!
Object subclass: #MockTimer
	instanceVariableNames: 'currentTime manualyPased'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 17:58:59' prior: 50925321!
passTime: anAmontOfTime

	currentTime := currentTime + anAmontOfTime minutes.
	manualyPased := true.! !
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 17:59:17' prior: 50925688 overrides: 16896425!
initialize

	self initialize: DateAndTime now.! !
!MockTimer methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 17:59:27' prior: 50925749!
initialize: aTime

	currentTime := aTime.
	manualyPased  := false.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 18:00:39' prior: 50926012!
isDifferenceWith: aTimer biggerThan: anAmountOfTime
	|actualTimer|
	actualTimer  := manualyPased ifTrue: [currentTime] ifFalse: [self now]
	^((actualTimer - aTimer) minutes abs > anAmountOfTime).
	
	! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 18:00:43' prior: 50926095!
isDifferenceWith: aTimer biggerThan: anAmountOfTime
	|actualTimer|
	actualTimer  := manualyPased ifTrue: [currentTime] ifFalse: [self now].
	^((actualTimer - aTimer) minutes abs > anAmountOfTime).
	
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 18:00:46'!
PASSED!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 19:04:20' prior: 50926078!
passTime: anAmontOfTime

	self now.
	currentTime := currentTime + anAmontOfTime minutes.
	manualyPased := true.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 19:04:23'!
PASSED!
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 19:04:32' prior: 50926156!
passTime: anAmontOfTime

	self now.
	currentTime := currentTime + anAmontOfTime minutes.
	manualyPased := true.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 19:06:05'!
restart

	self now.! !
!MockTimer methodsFor: 'operation' stamp: 'G.L.S 6/28/2021 19:06:13' prior: 50926210!
restart

	self now.
	manualyPased := false.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 19:06:55'!
PASSED!

!methodRemoval: MockTimer #restart stamp: 'G.L.S 6/28/2021 19:07:22'!
restart

	self now.
	manualyPased := false.!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/28/2021 19:07:44' prior: 50925830 overrides: 16927572!
setUp
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:10:15' prior: 50925229!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData withCatalog: self createDefaultCatalog withTimer: self createDefaultMockTimer.
	
	^mockInterface! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:13:43' prior: 50925162!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	"webServer addService: '/createCart' action: [ :request |
		[ | clientId password sentence words |
			clientId := (request fields at:'clientId').
        			password := (request fields at:'password').
       	 		sentence := 'exitoso pero no hicimos nada'.
        			words := stringGenius words: sentence.
        			wordsAsJson:= WebUtils jsonEncode: (words).
        			request send200Response: (wordsAsJson)
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]"
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:14:49' prior: 50926308!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ :request | |clientId password| 
		[
			clientId := (request fields at:'clientId').
        			password := (request fields at:'password').
			
       	 		"wordsAsJson:= WebUtils jsonEncode: (words).
        			request send200Response: (wordsAsJson)"
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:15:57' prior: 50926341!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
        			"wordsAsJson:= WebUtils jsonEncode: (words).
    			request send200Response: (wordsAsJson)"
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:19:00' prior: 50926371!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
        			"wordsAsJson:= WebUtils jsonEncode: (words).
    			request send200Response: (wordsAsJson)"
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:20:20' prior: 50926401!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId| 
		[ | cartIdAsJson |
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
        			cartIdAsJson:= WebUtils jsonEncode: (cartId).
    			request send200Response: '()'
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:20:42' prior: 50926433!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId cartIdAsJson| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
        			cartIdAsJson:= WebUtils jsonEncode: (cartId).
    			request send200Response: cartIdAsJson.
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:20:52' prior: 50926465!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId cartIdAsJson| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
        			cartIdAsJson := WebUtils jsonEncode: (cartId).
    			request send200Response: cartIdAsJson.
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

pepe := StringsServicesRestInterface listeningOn: 8080.!

pepe destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:24:31'!
destroy
	
	! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:24:44' prior: 50926535!
destroy
	
	webServer ifNotNil:[webServer destroy].! !

librosServer destroy.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:28:15' prior: 50926498!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
        			result := WebUtils jsonEncode: (cartId).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

d _ Dictionary new.!

d add: 'jorge'->'1234'.!

WebUtils jsonEncode: d.!

WebUtils jsonEncode: 1.!

WebUtils jsonEncode: 'hola'.!

WebUtils jsonEncode: d.!

d add: '0'->'1'.!

WebUtils jsonEncode: d.!

WebUtils jsonEncode: ('0|', 1 asString)!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:33:40' prior: 50926545!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: (anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

(Cart class)!

(Cart class)!

self allInstances !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:35:24' prior: 50926585!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:39:13' prior: 50926622!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"2do va acá"
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList result| 
		[
			cartList := mockInterface listCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:39:52' prior: 50926657!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"2do va acá"
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:40:46' prior: 50926701!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"2do va acá"
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:41:28' prior: 50926747!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"2do va acá"
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:43:35' prior: 50926794!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"2do va acá"
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:44:48' prior: 50926841!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

RestInterface allInstances .!

a RestInterface!

RestInterface allInstances!

librosServer := RestInterface listeningOn: 8080.!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 19:47:31' prior: 50881573!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := self cartForId: aCartId. 
	
	self halt.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 19:47:36' prior: 50926967!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := self cartForId: aCartId. 
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 19:47:37' prior: 50926978!
listCart: aCartId 
	
	| cartItemList cart |
	
	cart := self cartForId: aCartId.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 19:47:43' prior: 50926989!
listCart: aCartId 
	
	| cartItemList cart |
	
	self halt.
	
	cart := self cartForId: aCartId.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

librosServer!

mockInterface listCart: 1.!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 6/28/2021 19:49:23' prior: 50927000!
listCart: aCartId 
	
	| cartItemList cart |
	
	"self halt."
	
	cart := self cartForId: aCartId.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cartItemList := cart itemListFor: self.
	
	self updateCartTimerFor: aCartId.
	
	^cartItemList.! !

mockInterface listCart: 1.!

mockInterface listCart: 1.!

mockInterface listCart: 900.!

mockInterface listCart: 1.!

(OrderedCollection new) do: [].!

d := (OrderedCollection new).!

d do: [:a | ].!

d do: [:a | ].!

d do: [:a | a + 1].!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:51:56' prior: 50926892!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			self halt.
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:53:08' prior: 50927031!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId').
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:53:54' prior: 50927101!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asInteger.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

'1' asNumber .!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:54:35' prior: 50927167!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:55:37' prior: 50927236!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			self halt.
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

cartId!

carts includesKey: aCartID!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 19:58:26' prior: 50927304!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 20:00:05' prior: 50927374!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			cartId := (request fields at:'cartId') asNumber.
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 20:00:28' prior: 50927447!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:03:11' prior: 50927514!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookId result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookId := (request fields at:'cartId').
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:03:22' prior: 50927576!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookId result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookId := (request fields at:'bookId').
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:03:49' prior: 50927640!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:04:26' prior: 50927704!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:04:55' prior: 50927768!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first, '|'.
					resultString := resultString, cartItem second, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:08:06' prior: 50927834!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:09:29' prior: 50927905!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		]
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:11:45' prior: 50927977!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			"self halt."
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	"webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)]."
	
	"webServer addService: '' action:[:request | | |
		[] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]."! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:34:52' prior: 50928046!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:39:25' prior: 50928115!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:40:16' prior: 50928191!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:40:28' prior: 50928267!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:40:45' prior: 50928344!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:43:21' prior: 50928421!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:43:41' prior: 50928498!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:46:23' prior: 50928578!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:47:13' prior: 50928661!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self addCreateCartService.
	
	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:47:34'!
addCreateCartService.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:48:10' prior: 50928760!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self addCreateCartService.
	
	self startAddToCartService.
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:48:22'!
startAddToCartService.

	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:48:45'!
startCreateCartService.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 20:48:45' prior: 50928864!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	
	self startAddToCartService.
	
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

!methodRemoval: RestInterface #addCreateCartService stamp: 'G.L.S 6/28/2021 20:48:45'!
addCreateCartService.
	
	webServer addService: '/createCart' action: [ 
		:request | 
		|clientId password cartId result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].!
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:49:06' prior: 50928974!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	self startAddToCartService.
	self startListCartService.
	
	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:49:22'!
startListCartService
	webServer addService: '/listCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:49:44' prior: 50929062!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	self startAddToCartService.
	self startListCartService.
	self startCheckOutCartService.
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:50:08'!
startCheckOutCartService

	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId cartList resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:50:32' prior: 50929136!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	self startAddToCartService.
	self startListCartService.
	self startCheckOutCartService.
	self startListPurchasesService.! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:50:41'!
startListPurchasesService
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:50:44' prior: 50929206!
startListPurchasesService
	
	webServer addService: '/listPurchases' action: [ 
		:request | 
		|clientId password list resultString result| 
		[
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].
	! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:52:23' prior: 50929169!
startCheckOutCartService

	webServer addService: '/checkOutCart' action: [ 
		:request | 
		|cartId ccn cced cco resultString result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 20:54:09'!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

!methodRemoval: RestInterface #addInterfaceService:withAction: stamp: 'G.L.S 6/28/2021 20:56:01'!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 20:56:42'!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: '/addToCart' action: [ 
		:request | 
		|cartId bookIsbn bookQuantity result| 
		[
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 20:57:20' prior: 50929313!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request | 
		(anActionBlock value: request)
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 20:58:53' prior: 50928954!
startCreateCartService.

	self addInterfaceService: '/createCart' withAction: [ :request |
		|clientId password cartId result| 
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		].! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:01:02' prior: 50929113!
startListCartService
	self addInterfaceService: '/listCart' withAction: [
			:request | 
			|cartId cartList resultString result|
			
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:01:09' prior: 50929365!
startListCartService

	self addInterfaceService: '/listCart' withAction: [
			:request | 
			|cartId cartList resultString result|
			
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:01:24' prior: 50929346!
startCreateCartService.

	self addInterfaceService: '/createCart' withAction: [ 
		:request |
		|clientId password cartId result| 
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			cartId := mockInterface createCartForUser: clientId password: password.
			
        			result := WebUtils jsonEncode: ('0|', cartId asString).
    			request send200Response: result.
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:01:30' prior: 50929385!
startListCartService

	self addInterfaceService: '/listCart' withAction: [
		:request | 
		|cartId cartList resultString result|
			
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:02:44' prior: 50929254!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result| 
			cartId := (request fields at:'cartId') asNumber.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:03:17' prior: 50929230!
startListPurchasesService
	
	webServer addService: '/listPurchases' action: [
		:request | 
		|clientId password list resultString result| 
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:03:18' prior: 50929456!
startListPurchasesService
	
	webServer addService: '/listPurchases' action: [
		:request | 
		|clientId password list resultString result| 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:03:32' prior: 50929477!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result| 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key), '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:04:08' prior: 50928933!
startAddToCartService.

	webServer addService: '/addToCart' action: [
		:request | 
		|cartId bookIsbn bookQuantity result| 
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		]! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:04:23' prior: 50929519!
startAddToCartService.

	self addInterfaceService: '/addToCart' withAction: [
		:request | 
		|cartId bookIsbn bookQuantity result| 
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		].! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:08:39' prior: 50929335!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		self halt.
		(anActionBlock value: request)
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:10:36' prior: 50929559!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		(anActionBlock value: request)
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

----QUIT----(28 June 2021 21:10:41) CuisUniversity-4532.image priorSource: 18979742!

----STARTUP---- (28 June 2021 21:10:53) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

[:v | 1/v] value:1.!

[:v | 1/v] value:4.!

[:v | 1/v] value:0.!

([:v | 1/v] value: 0) on: Error do:['Se puede'].!

([:v | 1/v] value: 0) yourself; on: Error do:['Se puede'].!

[([:v | 1/v] value: 0)] on: Error do:['Se puede'].!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:13:34' prior: 50929573!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:16:34' prior: 50929442!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result| 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			mockInterface checkOutCart: cartId  
						withCreditCard: ccn
						withExpirationDate: cced 
						withOwner: cco 
						withMerchantProcesor: ''  
						registerOn: ''.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:16:55' prior: 50929613!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result| 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			mockInterface checkOutCart: cartId  
						withCreditCard: ccn
						withExpirationDate: cced 
						withOwner: cco.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 21:18:16'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 21:18:18'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers salesBook merchantProcesor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/28/2021 21:18:15'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
! !
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 21:19:22'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor.

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	salesBook := aSalesBook.
	merchantProcesor := aMerchantProcesor.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:19:25'!
PASSED!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:20:52' prior: 50926297!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData 
					withCatalog: self createDefaultCatalog 
					withTimer: self createDefaultMockTimer
					withSalesBook: ''
					withMerchantProcesor: ''.
	
	^mockInterface! !
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/28/2021 21:21:25'!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer.! !
!MockRestInterface class methodsFor: 'error handling' stamp: 'G.L.S 6/28/2021 21:21:36' prior: 50929777!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:21:58' prior: 50929765!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData 
					withCatalog: self createDefaultCatalog 
					withTimer: self createDefaultMockTimer
					withSalesBook: self createDefaultSalesBook 
					withMerchantProcesor: self createMerchantProcesor.
	
	^mockInterface! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:22:04' prior: 50925075!
createMerchantProcesor

	^MockMerchantProcesor new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:22:14'!
createDefaultMerchantProcesor

	^MockMerchantProcesor new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:22:23' prior: 50929820!
createDefaultMerchantProcesor

	| mp |
	mp := MockMerchantProcesor new.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:22:29' prior: 50929826!
createDefaultMerchantProcesor

	| mp |
	mp := MockMerchantProcesor new.
	^mp.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:22:41' prior: 50929801!
createDefaultMockInterface

	| mockInterface |
	
	mockInterface := MockRestInterface createFor: self createDefaultUserData 
					withCatalog: self createDefaultCatalog 
					withTimer: self createDefaultMockTimer
					withSalesBook: self createDefaultSalesBook 
					withMerchantProcesor: self createDefaultMerchantProcesor.
	
	^mockInterface! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:23:26' prior: 50929832!
createDefaultMerchantProcesor

	| merchantProcessor workingCreditCard |
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	^merchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 6/28/2021 21:25:02' prior: 50926265 overrides: 16927572!
setUp
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:25:32' prior: 50886230!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '' ]  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:25:34' prior: 50929902!
test09CannotCheckOutWithACartThatDoesNotExist

		
	self testFail: [mockInterface checkOutCart: 0 withCreditCard: '' withExpirationDate: '' withOwner: '']  		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:25:37'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:25:50' prior: 50886243!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco' 
				withMerchantProcesor: merchantProcessor 
				registerOn: sales.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:25:52'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:26:04' prior: 50886287!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:26:30'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:26:33'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:28:27' prior: 50929964!
test10SuccessfulCheckoutAltersUserListPurchase
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !

!methodRemoval: MockRestInterface #checkOutCart:withCreditCard:withExpirationDate:withOwner:withMerchantProcesor:registerOn: stamp: 'G.L.S 6/28/2021 21:28:33'!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner withMerchantProcesor: aMerchantProcessor registerOn: aSalesBook   
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: aSalesBook
		forMerchantProcessor: aMerchantProcessor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
!

!methodRemoval: MockRestInterface #initializeFor:withCatalog:withTimer:withSalesBook:withMerchantProcesor: stamp: 'G.L.S 6/28/2021 21:28:40'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor.

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	salesBook := aSalesBook.
	merchantProcesor := aMerchantProcesor.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	!
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 21:29:26'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 21:29:42' prior: 50930213!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	salesBook  := aSalesBook.
	merchantProcesor := aMerchantProcesor.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !

!methodRemoval: MockRestInterface #initializeFor:withCatalog:withTimer: stamp: 'G.L.S 6/28/2021 21:30:08'!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	timer := aTimer.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	!

!methodRemoval: MockRestInterface class #createFor:withCatalog:withTimer: stamp: 'G.L.S 6/28/2021 21:30:26'!
createFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer  

	^self new initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer.!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:30:31'!
PASSED!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:32:18' prior: 50929853!
createDefaultMerchantProcesor

	| merchantProcessor workingCreditCard2 |
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard2 withBalance: 1000.
	
	^merchantProcessor.! !

!classDefinition: #StoreObjectFactory category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 21:32:25'!
Object subclass: #StoreObjectFactory
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking donQuixote workingCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:32:24' prior: 50924962 overrides: 16896425!
initialize

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:32:27' prior: 50930341 overrides: 16896425!
initialize

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 6/28/2021 21:32:32' prior: 50930320!
createDefaultMerchantProcesor

	| merchantProcessor |
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	^merchantProcessor.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:34:34'!
test12SuccesfulCheckoutsProduceDifferentTransactionIds
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 17.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 170.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:35:58' prior: 50930376!
test12SuccesfulCheckoutsProduceDifferentTransactionIds
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: smalltalk80) = 34.
	self assert: ((mockInterface listPurchasesForUser: usuario withPassword: password) at: 'totalBooks') = 340.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/28/2021 21:36:24' prior: 50930415!
test12SuccesfulCheckoutsProduceDifferentTransactionIds
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).! !

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 6/28/2021 21:36:31'!
FAILURE!

!classDefinition: #MockRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 6/28/2021 21:37:37'!
Object subclass: #MockRestInterface
	instanceVariableNames: 'datosUsuarios catalog carts lastId userPurchases timer cartTimers salesBook merchantProcesor transactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/28/2021 21:37:35' prior: 50929677!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	
	transactionId := transactionId + 1.
	^transactionId.
! !
!MockRestInterface methodsFor: 'initialization' stamp: 'G.L.S 6/28/2021 21:37:57' prior: 50930232!
initializeFor: aUserDataDictionary withCatalog: aCatalog withTimer: aTimer withSalesBook: aSalesBook withMerchantProcesor: aMerchantProcesor

	datosUsuarios := aUserDataDictionary.
	catalog := aCatalog.
	carts := Dictionary new.
	cartTimers := Dictionary new.
	lastId := 0.
	transactionId := 0.
	
	timer := aTimer.
	salesBook  := aSalesBook.
	merchantProcesor := aMerchantProcesor.
	
	userPurchases := Dictionary new.
	
	datosUsuarios keysDo: [
			:aUserId | 
			userPurchases add: aUserId -> Dictionary new.
			(userPurchases at: aUserId) add: 'totalBooks' -> 0.
		].
	! !

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 6/28/2021 21:38:06'!
PASSED!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:42:24' prior: 50929636!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

'01/20' asDate.!

'01\20' asDate.!

DateAndTime newFrom: '01/20'.!

'01/23' 	asDate. !

'2001/06/23' 	asDate. !

'2001/06' 	asDate.!

'2001/06/06' 	asDate.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/28/2021 21:52:05' prior: 50930593!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced') asDate.
			cco := (request fields at:'cco').
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

'2001/06' 	asDate.!

'2001/06' asMonth.!

'2001/06' asMonth < FixedGregorianDate today.!

('2001/06' asMonth) < FixedGregorianDate today.!

('2001/06' asMonth asDate) !

2001/06!

2001/06!

2001/06!

'2001/06' asMonth !

'2001/06' asMonth !

self year!

self month.!

self class!

mes := '2001/06' asMonth.!

FixedGregorianDate year: mes year month: mes monthName  dayNumber: 01!

FixedGregorianDate year: mes year month: mes monthName dayNumber: 1!

FixedGregorianDate year: mes year month: mes monthIndex dayNumber: 1!

FixedGregorianDate year: mes year month: mes dayNumber: 1!

FixedGregorianDate year: mes year month: mes dayNumber: 1 day!

mes class.!

FixedGregorianDate year: 2002 month: 6 dayNumber: 1!

FixedGregorianDate year: 2002*year month: 6*month dayNumber: 1*day!

mes year.!

mes day!

mes monthName!

mes monthIndex!

----QUIT----(28 June 2021 22:15:25) CuisUniversity-4532.image priorSource: 19133848!

----STARTUP---- (29 June 2021 18:34:36) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 6/29/2021 18:39:33'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 6/29/2021 18:39:33'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Features/Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/29/2021 18:39:34'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/29/2021 18:39:34'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /media/Datos/Cuis/Ej-Libros/linux64/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /media/Archivos/UBA/2021/Ing-Soft-1/2021-1c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:42:27' prior: 50930623!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:43:58' prior: 50940077!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId tempString | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			tempString := ''.
			cced do:[ :char |
				char = '/' 
					ifTrue:[]
					ifFalse:[]
				].
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

$/ = '/'.!

'hola' do:[:l | l].!

a := ''!

'hola' do:[:l | a, l].!

'hola' do:[:l | a, l asString].!

'hola' do:[:l | l = $h ifFalse:[a, l asString]]. !

a := ''!

a := ''!

a := ''!

a := ''!

a := ''!

a := ''!

'hola' do:[:l | l = $h ifFalse:[a, l asString]].!

a!

a.!

a := ''!

'hola' do:[:l | l = $h ifFalse:[a := a, l asString]].!

a!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:47:40' prior: 50940100!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId tempString | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			tempString := ''.
			
			cced do:[ :char |
				char = $/ 
					ifTrue:[ | expYear |
						expYear := tempString asNumber.
						tempString := ''.
						]
					ifFalse:[tempString := tempString, char asString]
				].
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:47:58' prior: 50940137!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId tempString expYear | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			tempString := ''.
			
			cced do:[ :char |
				char = $/ 
					ifTrue:[
						expYear := tempString asNumber.
						tempString := ''.
						]
					ifFalse:[tempString := tempString, char asString]
				].
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:48:16' prior: 50940167!
startCheckOutCartService

	| expMonth |
	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId tempString expYear | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			tempString := ''.
			
			cced do:[ :char |
				char = $/ 
					ifTrue:[
						expYear := tempString asNumber.
						tempString := ''.
						]
					ifFalse:[tempString := tempString, char asString]
				].
			
			expMonth := tempString asNumber.
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:49:15' prior: 50940197!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId tempString expYear expMonth | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco').
			
			tempString := ''.
			
			cced do:[ :char |
				char = $/ 
					ifTrue:[
						expYear := tempString asNumber.
						tempString := ''.
						]
					ifFalse:[tempString := tempString, char asString]
				].
			
			expMonth := tempString asNumber.
			
			cced := Date year: expYear month: expMonth day: 1. 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

Date year: 2001 month: 6 day:4.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:50:10' prior: 50940229!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:51:31'!
processExpirationDateFrom: aString
	
	| expMonth expYear tempString |
	tempString := ''.
			
	aString do:[ :char |
			char = $/ 
			ifTrue:[		expYear := tempString asNumber.
					tempString := ''.]
			ifFalse:[tempString := tempString, char asString]
		].
			
			expMonth := tempString asNumber.
			
	^ Date year: expYear month: expMonth day: 1.
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:51:44' prior: 50940286!
processExpirationDateFrom: aString
	
	| expMonth expYear tempString |
	
	tempString := ''.
			
	aString do:[ :char |
			char = $/ 
			ifTrue:[		expYear := tempString asNumber.
					tempString := ''.]
			ifFalse:[tempString := tempString, char asString]
		].
			
			expMonth := tempString asNumber.
			
	^ Date year: expYear month: expMonth day: 1.
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:51:49' prior: 50940300!
processExpirationDateFrom: aString
	
	| expMonth expYear tempString |
	
	tempString := ''.
			
	aString do:[ :char |
			char = $/ 
			ifTrue:[		expYear := tempString asNumber.
					tempString := ''.]
			ifFalse:[tempString := tempString, char asString]
		].
			
			expMonth := tempString asNumber.
			
	^Date year: expYear month: expMonth day: 1.
! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:55:27' prior: 50940264!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

FixedGregorianDate fromDate: (Date year: 2001 month: 6 day:4).!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 18:56:18' prior: 50940314!
processExpirationDateFrom: aString
	
	| expMonth expYear tempString |
	
	tempString := ''.
			
	aString do:[ :char |
			char = $/ 
			ifTrue:[		expYear := tempString asNumber.
					tempString := ''.]
			ifFalse:[tempString := tempString, char asString]
		].
			
			expMonth := tempString asNumber.
			
	^FixedGregorianDate fromDate: (Date year: expYear month: expMonth day: 1).
! !

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:02:15' prior: 50929498!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result| 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo: [
				:key |
				resultString := resultString, key , '|' , (list at: key) asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:05:01' prior: 50940371!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result| 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:06:08' prior: 50940396!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result catalog | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			catalog := storeOF createDefaultCatalog. 
			
			
			
			resultString := '0|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:08:12' prior: 50940414!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result catalog | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			catalog := storeOF createDefaultCatalog. 
			
			resultString := '0|'.
			
			catalog keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:09:18' prior: 50940434!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result catalog | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			catalog := storeOF createDefaultCatalog. 
			
			resultString := '0|'.
			
			catalog keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
			resultString  := resultString, 'TOTAL|', (list at: 'totalbooks') asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:10:23' prior: 50940458!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result catalog | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			catalog := storeOF createDefaultCatalog. 
			
			resultString := '0|'.
			
			self halt.
			
			catalog keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
			resultString  := resultString, 'TOTAL|', (list at: 'totalbooks') asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:13:02' prior: 50940486!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
			resultString  := resultString, 'TOTAL|', (list at: 'totalbooks') asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:15:01' prior: 50940517!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			self halt.
			
			list keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
			resultString  := resultString, 'TOTAL|', (list at: 'totalbooks') asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:16:27' prior: 50940549!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			self halt.
			
			list keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:16:32' prior: 50940577!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			"self halt."
			
			list keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := RestInterface listeningOn: 8080.!

librosServer destroy.!

librosServer destroy.!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:18:49'!
test13CannotCheckoutAPreviouslyUsedCart
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:19:04'!
test13CannotCheckoutAPreviouslyCheckoutedCart
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).! !

!methodRemoval: MockRestInterfaceTest #test13CannotCheckoutAPreviouslyUsedCart stamp: 'G.L.S 6/29/2021 19:19:04'!
test13CannotCheckoutAPreviouslyUsedCart
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:48:19' prior: 50940658!
test13CannotCheckoutAPreviouslyCheckoutedCart
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:49:49' prior: 50940716!
test13CannotCheckoutAPreviouslyCheckoutedCart
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				
	self testFail: [
			mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				] 
		withErrorMessage: 'Hola'.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:50:18' prior: 50940732!
test13CannotCheckoutAPreviouslyCheckoutedCart
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				
	self testFail: [
			mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				] 
		withErrorMessage: MockRestInterface errorCartIdDoesNotExist. ! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 6/29/2021 19:50:24' prior: 50940755!
test13CannotCheckoutAPreviouslyCheckoutedCart
	
	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				
	self testFail: [
			mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'.
				] 
		withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 6/29/2021 19:50:24'!
FAILURE!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 6/29/2021 19:50:55' prior: 50930495!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	
	self deleteCart: aCartId.
	
	transactionId := transactionId + 1.
	^transactionId.
! !
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:51:06'!
deleteCart: aCartId
	
	! !

d _ Dictionary new.
d add: '0'->'1'.!

d at:'0'!

d removeKey: '0'.!

d at: '0'.!
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:52:53' prior: 50940834!
deleteCart: aCartId
	
	carts deleteKey: aCartId.
	cartTimers deleteKey: aCartId.! !
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 6/29/2021 19:53:11' prior: 50940841!
deleteCart: aCartId
	
	carts removeKey: aCartId.
	cartTimers removeKey: aCartId.! !

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 6/29/2021 19:53:53'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 6/29/2021 19:53:57'!
PASSED!

----QUIT----(29 June 2021 19:54:11) CuisUniversity-4532.image priorSource: 19168673!

----STARTUP---- (29 June 2021 19:54:25) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


----QUIT----(29 June 2021 20:00:08) CuisUniversity-4532.image priorSource: 19496161!

----STARTUP---- (1 July 2021 18:07:17) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


self class!

self class!

self image: (Form fromBinaryStream: 'iVBORw0KGgoAAAANSUhEUgAAAbgAAAHiCAMAAACtASkQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASFBMVEVHcEx5pLODscGDssJKZG2Uydv+/v4AAADHERB3Cgp1nq12oK56prWEs8ONwNGIucptlKF2oa+EtMSArb0PFBZ8qLeFtcWArr6bh3oRAAAAAXRSTlMAQObYZgAACdFJREFUeNrt3ety4zYMQGG2VQKi93vf/0077Uymu93EpkgQBMhz/sda41tKlmXLpRARERERERERERERERERERERERERERERERERERERERERvSX3YmCpuNBLbwZebjbw8qpBlxUNu7xo0CVmgy6rGnh50aBLzIZcUjXk0rJBl5YNuaxsyGVlgy4tG3JZ2ZDLyoZcWjfkkrIh5+FW20NuvVvtDbmFbHUw5Ja4VYuQ83WrdiHn5VatQ87BrU4JuMlwdWLITXKrswNuglv1CDlrt+oVcJZu1THkzNyqb8jZuFX3kDNwqysCbtStLgq5Ibi6LuByurHk+uHq2oDL6caS64SrtbLkWHDInbPgPpaDLbgbS+42XK2VJYcbcE5wtSLHggPuRDfkgMMthBxwSeEEt+BuVYFLCafKksu54IDLdu79Bse+MiVcBS6nG0sOuOPc1hIDdxNu3ffBv4BT4Nrc3O5RMwQnwH0ycqubOAHnefJtHXBJ4UzolIPcAjgLO5bcGrhhPOCWuY3RAbcSTjjIJYWTCXACXGQ54Jay9csBt5atW045yC2/w7k1nMAWXu5gOIkQcDnduuTOPsiJpJU7GU4CxauTnG7AObq9fJa3nJ66r7Th+qyfv/rthz9//eavP3759rvvv/7px6lyp8IZmz1p3pI7Dc7PrN2Og5yt24tVxnInwg2bvX5Rq97vZnIHHuQG1F4fNL7yOtxOgutke32epxxwDWqvzQ3KATfi1ot2g85ADrgHaq89DckB1+c2ztYGd9ktOeBs2NrkrmsunJzq9jpSE9wFnBGcFVsr3LDcWQc5BzfgPOHs2NpenBjIHQXnsN7c4I46yM1fbzfgLuDMFtxrQjg9F+5lEdwFXKAF99rudvHqJOeCAy4r3AXcANyL+54SuKQLzgiung33AhxwrR9dAM7U7cXLDThjuBdvN+AsXpoMwzV/pBk4a7gXBzUnuH0grT9B2c1mB1dvwOXVa/zAcqtSL5op3G25jHrN3w+wWVVNbkvgkund+TrODK133dbB5dGb/N23lHAp6EK6LYcTFlxSuPB0UeCuyxSujsPFppMgcJcxnFrACXB33YLACXvKe2xh4OLSvf+vva61bIHgJBPcv6NbyRYJTrLBueBdd9wWwcWkeww3Ge+6psFVSzhJCTcN77puwpndF2oHuTY4e77rcdHgJMuLymfNZQsIJ5vAjRg2PKYAZ7inHPdrfrCAcLIr3DO/W48y96aVfT9fvt2u8kPBgT/2g7uhdwjcZe02Ea5RD7iQcM/19j7I5YZ7TAfc/ENcN1wFLincIzrg5sPVfrgKXFK4DHLA3aIDbvaLyjPhBLjwcsCxr4x1iHv02QWWXOAFB1xquIF9ZU0JJ9HcgEsKV/3hKvvKFQsOOOA4B08Gx5JbcYg7Fk6SL7h5cMg5LDjgki64Mbik+0rJ7DYTTqLDyfFwWZecxHALB8eSWwQn//t9gk/b4uWJM90Et0dw+kEbvHviSycz4N6X02ftAOdFZ+o2CvcfHXKubuNwb3Sp4RzoJB6cpoB7JjcZb5rbCNwDuZJKTha4LYXTFEuuRW6OnZi7WcH9Q7cJ3AQ9iQynCeBuyBnqyQw3QziNf5C7Kzeu9/zxh93G4XRLuH7BpketYeFkF7hbgq2PVYHzg3vXsu/vLNwM4PRYOHF2ew4nwEV0Ay6pW1U97GXlJm7HwW3pBlwaN+CSuvnACXBz3YBLwjYBToHzcANuD7dj4WzvAe/vdjKcm12twBnDedDVKW7Hw938eYVFbsB9+RQ7fhzDna2qH5ykgzPXq3YB985T7PlxDE804JrhBgWreToHTreFuy1Y5wRcL9zHltUhBc4QzjHg3n+KwAHn5wZceDgF7qOnCFxMudxwClxKOJ0Jp8ABB1ybG3Cx5YDLCafApYRT4J48xXxuB8AJcMDFcTsVToEDbokbcFHlFDjggIvjNhFOgAPuODj1gdP0cJrNDbiIcAoccLvDaTI34OLBKXAp4RQ44IAL5wZcNDngUsINjhy48G77w0nzMwQOuPluh8JpSDgFrgtOM7kBFwZOgUsJp8B1w2kiN+BiwClwKeEUuCE4zeMGXAA4BQ64Q+E0Cxtwy+EUuJRwClxKOAXOBk6zuAG3Uk6BSwmnwFlcAHeXU+BSwilwGeFUgTM9xDnJKXDmK85DToFLCafATYHTBG6cx7nLqQKXEE4VuIlwGt4NOE84VeAmw02hU+Ac4DQ02wH38up/gqHdgPOBU80DV7LD2dGpAucKZ0GnkwJuqpyqK5wAZ0GnMwNukp3ODrgJeuoQcNZ26hNwhnzqmMETk7PgggQccHl/6AM44IADbjac5IMT4IDbDK4U9pXAAQcccEkOccABdwRcAS46nAAHHHDDgx/8c+CAA27OvjK8G3DA7QQX3413mYHbCE4SwHEil9QNOOB2gRPgcp6BA5cSTpK4cSLX6AZcaLg8bsA1scVz4wy8hQ24uHCSzI0TuQY24ELCyfMKcOHgRIAbHa8/nEhet264wWFP///ybAPS3lZw/bN+NCIfOLlX2RLO5O2kGXJiVdkd7u3PPn+Au2MKB1dSwYnff+hZcru7AZeTzXhfuZlc2RFO94cre8Lp7nBlVzjdGq6UfeF0Y7iyNdwUuhBwZXc43RKulLRwosvolsOVcgacNd1iuJKnSXfhSQlXylFwtnbr4Eo5D86Qbg1cyZfh+O4OKwpcSZnp//t7k4oBV7JmPb72Ea2HK5lzgXP/iNneZofClT2yfnEXGK5s1ZZwcgBcAQ642HAFOOCAAw444Oy/iSPA7Q4nwI3ByfyhAZcUrgAXf18JXHg4AW6ni6nA5YQrwAHHe8xzJghc0iUHHHAc4jzPwYFLuuSAS7rkgMsJJ8ABB5yj3J2ZAQfcmadxlnLA5YSTsHClIDcVToALA1d84eQsOBO5mzMDDjjgRgYpceFKYckFhxPgjO7JVoBbJDd4A0vglsEN3aa5RIAr5VQ56WQDbjXcw4l23p1iyhn4iXCl7w5p3XeCmQEnwLVNdegWPsD5yX0y2vHbZdnDCXAmFeByynVtzd7tALji6eZzP6oz3Gzl+jYG3Gq43o3htlauAJdSzudSEm7WcgW4lHJDW8JtGV3xhhPcLORGt2PndhxccWEzOsoJbhZ0VhsxYDsTrpPOcBujaqe69dBZb+H2BUDgeujWX4/ArWO06y9HAHd/uiEuR+B2d7wxLkfgdmfGcS5H4NY850BvagOX801t3HaBY6o55ZhpTjkmmlKOceaUY5g56ZhkSjnGmFKOGeaUY4Ip6ZheRjzGltKOieWjY1Rp9JgLERERERERERERERERERERERERERERERERERERERER0Qn9DZbmWAkmd4vMAAAAAElFTkSuQmCC' base64Decoded asByteArray readStream)!

self image: (Form fromBinaryStream: 'iVBORw0KGgoAAAANSUhEUgAAAbgAAAHiCAMAAACtASkQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASFBMVEVHcEx5pLODscGDssJKZG2Uydv+/v4AAADHERB3Cgp1nq12oK56prWEs8ONwNGIucptlKF2oa+EtMSArb0PFBZ8qLeFtcWArr6bh3oRAAAAAXRSTlMAQObYZgAACdFJREFUeNrt3ety4zYMQGG2VQKi93vf/0077Uymu93EpkgQBMhz/sda41tKlmXLpRARERERERERERERERERERERERERERERERERERERERERvSX3YmCpuNBLbwZebjbw8qpBlxUNu7xo0CVmgy6rGnh50aBLzIZcUjXk0rJBl5YNuaxsyGVlgy4tG3JZ2ZDLyoZcWjfkkrIh5+FW20NuvVvtDbmFbHUw5Ja4VYuQ83WrdiHn5VatQ87BrU4JuMlwdWLITXKrswNuglv1CDlrt+oVcJZu1THkzNyqb8jZuFX3kDNwqysCbtStLgq5Ibi6LuByurHk+uHq2oDL6caS64SrtbLkWHDInbPgPpaDLbgbS+42XK2VJYcbcE5wtSLHggPuRDfkgMMthBxwSeEEt+BuVYFLCafKksu54IDLdu79Bse+MiVcBS6nG0sOuOPc1hIDdxNu3ffBv4BT4Nrc3O5RMwQnwH0ycqubOAHnefJtHXBJ4UzolIPcAjgLO5bcGrhhPOCWuY3RAbcSTjjIJYWTCXACXGQ54Jay9csBt5atW045yC2/w7k1nMAWXu5gOIkQcDnduuTOPsiJpJU7GU4CxauTnG7AObq9fJa3nJ66r7Th+qyfv/rthz9//eavP3759rvvv/7px6lyp8IZmz1p3pI7Dc7PrN2Og5yt24tVxnInwg2bvX5Rq97vZnIHHuQG1F4fNL7yOtxOgutke32epxxwDWqvzQ3KATfi1ot2g85ADrgHaq89DckB1+c2ztYGd9ktOeBs2NrkrmsunJzq9jpSE9wFnBGcFVsr3LDcWQc5BzfgPOHs2NpenBjIHQXnsN7c4I46yM1fbzfgLuDMFtxrQjg9F+5lEdwFXKAF99rudvHqJOeCAy4r3AXcANyL+54SuKQLzgiung33AhxwrR9dAM7U7cXLDThjuBdvN+AsXpoMwzV/pBk4a7gXBzUnuH0grT9B2c1mB1dvwOXVa/zAcqtSL5op3G25jHrN3w+wWVVNbkvgkund+TrODK133dbB5dGb/N23lHAp6EK6LYcTFlxSuPB0UeCuyxSujsPFppMgcJcxnFrACXB33YLACXvKe2xh4OLSvf+vva61bIHgJBPcv6NbyRYJTrLBueBdd9wWwcWkeww3Ge+6psFVSzhJCTcN77puwpndF2oHuTY4e77rcdHgJMuLymfNZQsIJ5vAjRg2PKYAZ7inHPdrfrCAcLIr3DO/W48y96aVfT9fvt2u8kPBgT/2g7uhdwjcZe02Ea5RD7iQcM/19j7I5YZ7TAfc/ENcN1wFLincIzrg5sPVfrgKXFK4DHLA3aIDbvaLyjPhBLjwcsCxr4x1iHv02QWWXOAFB1xquIF9ZU0JJ9HcgEsKV/3hKvvKFQsOOOA4B08Gx5JbcYg7Fk6SL7h5cMg5LDjgki64Mbik+0rJ7DYTTqLDyfFwWZecxHALB8eSWwQn//t9gk/b4uWJM90Et0dw+kEbvHviSycz4N6X02ftAOdFZ+o2CvcfHXKubuNwb3Sp4RzoJB6cpoB7JjcZb5rbCNwDuZJKTha4LYXTFEuuRW6OnZi7WcH9Q7cJ3AQ9iQynCeBuyBnqyQw3QziNf5C7Kzeu9/zxh93G4XRLuH7BpketYeFkF7hbgq2PVYHzg3vXsu/vLNwM4PRYOHF2ew4nwEV0Ay6pW1U97GXlJm7HwW3pBlwaN+CSuvnACXBz3YBLwjYBToHzcANuD7dj4WzvAe/vdjKcm12twBnDedDVKW7Hw938eYVFbsB9+RQ7fhzDna2qH5ykgzPXq3YB985T7PlxDE804JrhBgWreToHTreFuy1Y5wRcL9zHltUhBc4QzjHg3n+KwAHn5wZceDgF7qOnCFxMudxwClxKOJ0Jp8ABB1ybG3Cx5YDLCafApYRT4J48xXxuB8AJcMDFcTsVToEDbokbcFHlFDjggIvjNhFOgAPuODj1gdP0cJrNDbiIcAoccLvDaTI34OLBKXAp4RQ44IAL5wZcNDngUsINjhy48G77w0nzMwQOuPluh8JpSDgFrgtOM7kBFwZOgUsJp8B1w2kiN+BiwClwKeEUuCE4zeMGXAA4BQ64Q+E0Cxtwy+EUuJRwClxKOAXOBk6zuAG3Uk6BSwmnwFlcAHeXU+BSwilwGeFUgTM9xDnJKXDmK85DToFLCafATYHTBG6cx7nLqQKXEE4VuIlwGt4NOE84VeAmw02hU+Ac4DQ02wH38up/gqHdgPOBU80DV7LD2dGpAucKZ0GnkwJuqpyqK5wAZ0GnMwNukp3ODrgJeuoQcNZ26hNwhnzqmMETk7PgggQccHl/6AM44IADbjac5IMT4IDbDK4U9pXAAQcccEkOccABdwRcAS46nAAHHHDDgx/8c+CAA27OvjK8G3DA7QQX3413mYHbCE4SwHEil9QNOOB2gRPgcp6BA5cSTpK4cSLX6AZcaLg8bsA1scVz4wy8hQ24uHCSzI0TuQY24ELCyfMKcOHgRIAbHa8/nEhet264wWFP///ybAPS3lZw/bN+NCIfOLlX2RLO5O2kGXJiVdkd7u3PPn+Au2MKB1dSwYnff+hZcru7AZeTzXhfuZlc2RFO94cre8Lp7nBlVzjdGq6UfeF0Y7iyNdwUuhBwZXc43RKulLRwosvolsOVcgacNd1iuJKnSXfhSQlXylFwtnbr4Eo5D86Qbg1cyZfh+O4OKwpcSZnp//t7k4oBV7JmPb72Ea2HK5lzgXP/iNneZofClT2yfnEXGK5s1ZZwcgBcAQ642HAFOOCAAw444Oy/iSPA7Q4nwI3ByfyhAZcUrgAXf18JXHg4AW6ni6nA5YQrwAHHe8xzJghc0iUHHHAc4jzPwYFLuuSAS7rkgMsJJ8ABB5yj3J2ZAQfcmadxlnLA5YSTsHClIDcVToALA1d84eQsOBO5mzMDDjjgRgYpceFKYckFhxPgjO7JVoBbJDd4A0vglsEN3aa5RIAr5VQ56WQDbjXcw4l23p1iyhn4iXCl7w5p3XeCmQEnwLVNdegWPsD5yX0y2vHbZdnDCXAmFeByynVtzd7tALji6eZzP6oz3Gzl+jYG3Gq43o3htlauAJdSzudSEm7WcgW4lHJDW8JtGV3xhhPcLORGt2PndhxccWEzOsoJbhZ0VhsxYDsTrpPOcBujaqe69dBZb+H2BUDgeujWX4/ArWO06y9HAHd/uiEuR+B2d7wxLkfgdmfGcS5H4NY850BvagOX801t3HaBY6o55ZhpTjkmmlKOceaUY5g56ZhkSjnGmFKOGeaUY4Ip6ZheRjzGltKOieWjY1Rp9JgLERERERERERERERERERERERERERERERERERERERER0Qn9DZbmWAkmd4vMAAAAAElFTkSuQmCC' base64Decoded asByteArray readStream)!

self image: (Form fromBinaryStream: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAMCAggICAgICAgICAgKCAgKCggICAgICAgICAgICAgICAgICAgICAgICAgICAoICAgICgkLCAgLDQoIDQgICggBAwQEBgUGCgYGCg8OCg0NEA0QDQ4NDw4ODQ0PDQ8ODQ0PDQ0ODQ8ODw0PDQ0NDw0ODQ0NDQ4NDQgNDQ0NDQ0ICP/AABEIAIAAgAMBEQACEQEDEQH/xAAeAAEAAQQDAQEAAAAAAAAAAAAABgUHCAkDBAoCAf/EAFEQAAIBAwEEBQcFCA0NAAAAAAECAwAEEQUGEiExBxNBUWEICRQiQnGRI4GhscEyYnKCkqLC0xUkNENSU1WDlbLD0eEWFxglMzZjZHN2s7S1/8QAHAEBAAEFAQEAAAAAAAAAAAAAAAcBAwQFBgII/8QAPxEAAgECAgYFBwsDBQAAAAAAAAECAxEEBQYSITFBUWFxkaGxExQiMmKBwTM0QlJygpLC0eHwstLxBxUWIyT/2gAMAwEAAhEDEQA/ANqdAKAUAoBQCgFAKAUAoBQCgFAKAUAoBQCgFAKAUBT9oNfgtIJrm5lSC3hjeWWaVgkcUUal3kdjwVVUEknuoDUN5UvngNRuZ5LXZjFjZqxUX80KSXlzusPlIopg8VtC4B3VeJ5irAkwNlFAxmufLN24uAW/ZvWSp9qF5I1+YwIgHzYrGliaMXqynFPk5I2dLK8ZVjr06FSUeahJrtSsRlvKQ2v7de2kz46pqn6+q+cUvrx7UeXluLW+jP8ABL9Ce7Heci21sHT/AFzNcKnOG+hhuVcYxiRpY+v8d5Zlb77nm+mmrowZwlB6sk0+T2GbPk6eeYtbmSK12jsxYuxVf2Qs9+S0DEH1p7dy08CZAG9G9zxbJVFUsKng2R6Dr8F1BFc200dxbzRrJFPC6yRSxuN5XjdCVZWByCCQaA79AKAUAoBQCgFAKAUBqz88n5TckYttmLSQoJES6vyhxvRlmFratj2SVNxIvDOLfmCQQMBeifo3Qot1OoctxjjPFVAPB2HJieag8AMHiT6vFZ1mc4TeHp7Ob4u6vZdH+Oud9CtFKMqUcxxaUnLbCD3JfWa4t8FuS9Le/Ru2K4om4VQHS1TRYZ13ZY0kGPaUEj3Hmp8QQayKNepRetTk0+hmvxmX4bGw1MTTjNe0r26nvXWmmWV6Ruis2wM8GWg9pSctHk4zn2kycZ5jtzzrvMrzjzhqlV2T4PhL9H3eB8/6V6GPLovF4O7o/Si36UL9PGPeuN/WMpvNf+WlNoupQ6JfTM2j30yxxh8sLG+mcLFJGc+pBO53J0xuhmWb1N2YydORUbvKAUAoBQCgFAKAUAoDzceU1tw+tbU6vdsysJ9TmSNl5ejQyejWxHE53baKPJ5EgkAZwKpXdjKwlB160KS+lJLte3sLoaPahIo1AwAo4d3bj5qibMq3lcVUn7Vvcti7kfZWXUFQw1OnFWSitnLiQDpL6Umtn9HtwvWgAu7DITeGQqryLYIbJyACBg8cbjKsojiI+WrerwS49N+X86410u0yqZdV8zwaXlEk5Savq3V0ktzdrO7ukmlZv1Y5s9sxtFquDa2+o3KN7cEMqwc8cZEVIQM97Cu0oZTRj8nSXXa/e7kJ43SvMK3y+KkuhS1V+GFvAubs75AW1l1jNukTEZCzXkbOfxYGnYHwIBHbitosvaW2KS9xzMs6cn8pOT6HJ+J39o/Nw7XwxljapMMZ3Uud3/2BCn51FgrO8dW/Q0JZq5LVqSnb2ta3xMetuejPUNMk6q/s7i0c53eujZVfHMxyf7OQDvjZh41bnTlDZJWPdOrCorwaZum83X5fEO0lvHpV+er1u2txljjc1GGIKpuIzwAnAw00XiZE9XeWK2XTNygFAKAUAoBQEC6XenjR9BgFxq+oW9lGQ24JWJll3RlhDBGHnmYD2Yo3NAYgdK3nh9mYba5TTk1C/uTDKsDLbC3t+uKMIzLJcSRzJGHxvFLeRgOSmgNPPR3a710p/gqzfRuj6Wq5T3nUaN0tfGxf1U5d1viZKQ8h7h9VQtW+Ul1vxPrml6kepeBj5qul+lau0JziS7CE9oTeCsR7lBxUq5VH/wA1Jeyu8+Q9K6reaYqT4TkuzYvA2p+S9riehNZDC+jt8mg4AQPxAUdyuGzjlvL3122Hfo6vIiTFJ62tzMmejbbCK0kkMqsQ6qAyAErgkkYJHBs8cH2Rw7reKoSqpKL3F3BYmNCTclv5FzLfpZsW5yMv4Ub/AKKsK1TwdVcO83izCg+NvcyAdN+maJqtjLb3EMF1v49RoScnOCSSq4wpJDhgyHBUgjNZNCjVT1Zr0eKZiYrEUHHWpv0+DSs/f0Gl7pm2Jn2J2mtbnT5H3IpIb6zZmOerEhD20rDBYZSSF/4yJ13vuyKw8TR8lOy3cDZYPEeXp6z3rYz0CbKbRR3lrbXcJDRXFvDPGwOQ0c8ayoQRwIKsCD21imcVWgFAKAUBx3FwEVmY4VQST3ADJPwoDzW9PfTDebT65dajMzu9zOUt4nbhb2ocrbW6DLKixoRvBfVLmSQ5LsTbqVI04OctyVzKwuGnia0KFJXlOSiutu387Tk1roVSG2klM7GRI2cjcG4SozujjvDPLOfHHZXK0M8lVrxpqC1W7b9u3iS5j9AKWDwNTESrtzhByforVbSvZbb7d179NuBQOiyL5SVu5APi2f0a7SnvOT0TjetUlyil2v8AYyCtmyqn70fVUL4lWqzXtPxPqWg704v2V4Fh9evfQ9Z65gd1biOU47UbdZseOCw94qTsnqqWGpvkrdjsfJ2meFlSzXEwf0nrL70U/F29xmJsbtm8Dx3VpKOK5V1wyOjdhHJlYcwfA8CAR1sZW2oiqcL+jJF7tP8AKmO6BLZgt2tHNuqT4K0bEfltWWsRzRhPC8mfcvlU/wAGx+c3H2CD7aecdA816e4pF95UF2c9XbwJ4sZHx8GQfRXl4h8Ee1ho8WYI+Vt0mvqWoIZJetkhjKswwFVmbPVKBwAQAZA9pmzx3q1GJqa8jocFS8nDrN9vkz6RJb7N7P28yGOaLRNJikjOMpJFYW6OhwSMqykHBI4ViGwLlUAoBQCgKRtc2LS6P/Lz/wDiagPMt0acLyJsZ3N5seIUgfAnNY+Iw/nNOVK9r8TrNFpamZUqlr6t5W+60vG5dHbrXna1nHAAoRwHZkdprBoZHh8O1UV3Jbbt/BEtaQZtXrYCtDYk422LgQTopHGf3R/p1vKfEjvRFelWfRH8xfbTHzGn4I+gYqIcyhqYuqvbb7Xf4n0rgZa2Hpv2UuxWLfdMOw7zqtxCpaRBusoGWePOQVHaUJPDmQfAA7fJMwjRbo1HaL2p8n+5GenejtTHQjjcNG9SCtKK3yhvTS4uLvs3tPos4L0f9Ll1p/qLiWHPGCQkAHtKNzjJPPgVPapPGpGp1XHduPmyth1PfsZdyx8p2zI+UguEbuURyL+UXjP5tZKxEeKMF4OXBo4dT8qC2A+Rtp3b/iFIl+KtKfoo8QuCKrBy4tFuNqunW/ugyowt48cVgBDY++lOX8PVKDwrHnXb6DMp4SK2pXt3E88hDyeV2m2ktLGbHokQa8vBnBe1tmj3ohwOevlkhgbkQsjMDlRVkyT0RIgAAAwAMADkAOQFAfVAKAUAoCLdKupiDS9SmJwI7C8kJ7hHbyOT9FAeazozTNwfCJj9Kj7au09512i8b4xvlB+KXxJ5tf8Auab8A/WKvT3HfZz8yq/ZIt0Ufv8A/Nf2lW6XE5bRHfW+7+YvXs9LmIDuJH2/bUY6QUtTGN/WSfdb4H0Nk1TWwyXJtfH4lTrmzeEc2g6PbS5JaSIBz++ISjH344MfFga2mGzPEYdasJbOT2r9vccpmei+W5lJzr0vTf04vVk+u2x+9Mjg6CrPP3dx7t+P9Vmtp/yHE29WPY/7jll/pxll769Xq1o/2FW0/olsI+PU7575HZvzchfzaw6mc4uf07dSS79/ebrDaE5RQ2+R1nznJvuuo9xUNpdPSOzuEjREBhdd1FCj1lK8gAO2vOW6+IxlPXbbve7d9yv8DZZxh6OGyvEU6EIxTpyjaMUltVtytzJt5ona9LbbKGJiQbywvrZeHDfVUvcHuBWzbie3A7alE+QjerQCgFAKAUBarysf91dpf+39Z/8AnXNAed7otHy0n/SP9dKu0952uivzmf2PzIm2137mm/AP2VeluZ3GcfMqv2SK9FJ4z/zf9pVunxOU0R31vu/mLubM3WGKHtGR7xz+I+quS0lwrlTjXX0XZ9T3dj8Sbsir6s5Unx2rrX6rwJHUdHaigFAKAoO2c2IWXvDfAKc/Tiut0bo6+IlU4Rj3vZ4XOV0jq6uEcPrX7Ev8HX82zn/LfQMfx918PQLvP0Zrvj5EPQjQCgFAKAUBbLyn9PebZnaKKNS8kmhauiIObO+n3Coo8WYgD30B51ei+T5dx3xH6HSrtPednorK2KmucH/UicbW/uab8A1eluZ3ecfMqv2WRLopPrT+6P62q1T4nI6JP063VH4lxopSpBHMHNeqtKNWDpzV01ZkmU6kqclOO9O5LLLWUcDJCntBOOPhnnUU43J8RhptRi5R4SSvs6bbn/ESHhczo14puSjLim7dl953UkB5EH3VppwlDZJNdasbSM4y2xd+o+qtno45rhVGWIA8ayKOHqV5atOLb6CzVrQpLWqNJdJCNr9V3klb2VifHzKTn5/7qlXKsv8AMqGrL1ntfwXu8bkYZ9j/AC8KlRerGErdj2+/9C4XmmtlfSdtLGQ5xaWt/cYHI5tntBnwDXQPDHEDxrOPm83yUAoBQCgFAdLWtOE0MsJ4CSKRCfB0K/bQHmQjspNM1Ga2uV3Jbeee2nUcdySJ2ikHjuSIezjivUXZm5yjGRwmKjUn6u59T4+7Yye7QXKNazMGBUxPhgQQSVO7g+JwKyZPYSpmNWnPBVZqScXB2aezds7yG9Fj/KSj7wH4N/jVqnvON0Tf/dUXsrx/cuTV8k0UB+q5HI491eZRjJWkrrpPUZOLunZnIbx/4bflH++sZYOhHaqcfwr9C+8TWe+cvxM4i1ZSioqyRjtt7WULbe63LWXvICj8YgH6M15nuOfz2r5PA1HzWr2u3hczC8yNsismra1fEetb6fBbr3D024MjcO/9ogA92e+sUhY3B0AoBQCgFAKA11+cA82TLrt3JrehPFHqEij0qymbq4rx0UKs8M33MVwUAR0kxHLhX34mEhlA107b+QdtfptrcXl5otxFa26NJNKs1rMscaDLyMsFxIxRBlmdVIVQWJABIFbu1i2PRfJidx3xH6GT/GrtPedlorK2KkucH/VEuhWQSqU7aG8McErqcMEbB7jjAPzGqSdka3Ma0qGFqVI71F2fTwLX6Bb391IUtVu7iUIzlLdZpnCJxdysYZgi59ZiMDtxWJdkMLH4lPWVWd/tP9Tjg2uu8gLK5JIAHAkk8AOIPE161mZ1POMe2oxqybexbn8Cf6Bo1zkPcTsccRGpwM/fkAZx3DIPeRwN6KfFkh5fgsapKpjKzfsJ+LVuxbOm2x0vpTvMJFH3szH8UYH9Y/CvNRmq0sr2p06XNuXYrLxNpPmTNlhHoerXm5hp9UWHfIwXjtLWJ1wfaVXupQMcASw55qwRobGaAUAoBQCgFAKAoO3umCexvYSMiS0uYyDxBEkLoQR25BoDzM9Hk2LpB3q4/NLfZVyG86fRyerjoLmpLub+BdyskmEoe2p/as34I/rLXie40WeO2Bq9S8UZJeZfhztXecMgaFd59xvdNX7cVikKGJu2uynoGv3tkydX6Nqd1AEIxuiG4kjQDPZhVwe0YI5ivUd6NvlFvPaV/rLt4d5PKyycS3PSqw34e/df4ZGPqNWKhGulrXlKS42fijeT5srYh7HYvSFkAElwtxdnHal1cSyQE5A4m26knu5AkAE2TgTKWgFAKAUAoBQFH2w2tt7C1nvLp+qt4ImkkfBbdRBk4VQWZjyCqCWJAAJNAYI9IvnT13zHpmmb8XIzX0hVnGSCBBATugryZp2PHigxg1seNY093du1jdngTuOSu9w34zkA5AxxU8wOBzw4YqqdmZ+CxTw1aFeKvqu9ufBomtr0l25HrB0Pdu73wIP1gVf8oiTaWlGElG81KL5Wv3r9iN7YbcCdeqjBCZBYtwLY5DAzgZ488nA5Y425TvsRzGdZ8sZDyFFNQvdt73bcrcuPZu43K6EJruwheaGee1kuN3PUyvCzQrxj3yjKxDMWcK3Ajq3Gd4Yto4pspXSlspcXk5u1dpbh8da0khMkjDgJDLI3FgMKSzDgo7jmpWMrEWOk6sPVxJw+/iP529x+JqutI3X+9Y21vKy/nTvOfQuji4lmV7sHcBBYNJvPIB7GUYlQeR4qQDw41TfvNXWrzqy16knJ827+Jtk6HvOb2kYt7O+0oWVrHHHEktlIZY4EQLGg9GdFcRIg9iWRwFwEc1SxZ1jPnTNSjmjjmidZIpESSORCGR45FDI6sOBVlIYEcwRVD0dmgFAKAUAoCibbbG2+oWlxZXSb9vcRNHIoJUlW7VYcVZThlYciAaA189JHmsrxHZtJ1CCeLPCG9DQzKuOXXQpJHK2e0xwDHZw41ueNUsJth5u/aQkpLpAuVHKSG4tXB8UInWZfcVU+HKqizRaXX/N/6zCfW0fWBx/ebZ7hR88UUuPeWqguz40fyN9UhIb9gtYkYcjLp142PxRAq/FTiqi7JT/mA17+RNX/AKNvP1NDzYf6P+vfyJq/9G3n6mgsV3TvJK2llCldFvxvAEdZCYuB5Z60punwbBHdQrYlWieQLtVMwU6b1KnnJPdWiqvvCzPJ+TGaXFmX06MPNZzl0k1jUIkjBy1tYhndx2KbiVUWPPbuwyeDDmKXK6psH0PRYraGG3gQRwwxRxRRr9ykUSBI0HgqKFHuqh7O9QCgFAKAUAoBQCgFAKAUAoBQCgFAKAUAoD//2Q==' base64Decoded asByteArray readStream)!

WordsClientWindow open.!

WordsClientWindow open.!

Panel subclass: #LibrosClientWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/1/2021 18:44:53'!
Panel subclass: #LibrosClientWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

Object subclass: #LibrosClientModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/1/2021 18:45:06'!
Object subclass: #LibrosClientModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientWindow class methodsFor: 'no messages' stamp: 'G.L.S 7/1/2021 18:47:35'!
open
	
	^self new initializeWith: 'Ejercicio Libros Client Window'.! !
!LibrosClientWindow methodsFor: 'no messages' stamp: 'G.L.S 7/1/2021 18:47:53'!
initializeWith: aTitle! !
!LibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/1/2021 18:48:56' prior: 50941399!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #newWordsArrived send: #refreshListOfWords to: self"! !
!LibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/1/2021 18:49:18' overrides: 50936791!
defaultExtent

	^ 1035@485! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/1/2021 18:50:49' overrides: 50936705!
buildMorphicWindow! !

LibrosClientWindow open.!

LibrosClientWindow open.!

LibrosClientWindow open.!

LibrosClientWindow open.!

----QUIT----(1 July 2021 19:29:32) CuisUniversity-4532.image priorSource: 19496355!

----STARTUP---- (2 July 2021 19:20:40) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


LibrosClientWindow open.!

----QUIT----(2 July 2021 20:00:53) CuisUniversity-4532.image priorSource: 19512897!

----STARTUP---- (3 July 2021 15:01:25) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:10:35' prior: 50941422 overrides: 50936705!
buildMorphicWindow
	
	self addMorph: LayoutMorph newColumn.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:11:08' prior: 50941443 overrides: 50936705!
buildMorphicWindow

	| layout1 |
	layout1 := LayoutMorph newColumn.
	
	self addMorph: layout1.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:11:14' prior: 50941449 overrides: 50936705!
buildMorphicWindow

	| layout1 |
	
	layout1 := LayoutMorph newColumn.
	
	self addMorph: layout1.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:11:41' prior: 50941456 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:11:59' prior: 50941463 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:12:46' prior: 50941473 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beColumn.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:13:07' prior: 50941485 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beRow.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:13:33' prior: 50941498 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beRow.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.
	
	! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:14:56' prior: 50941511 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beRow.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.
	
	"layout2 addMorph: " ! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:15:05' prior: 50941524 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beColumn .
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.
	
	"layout2 addMorph: " ! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:15:30' prior: 50941537 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beRow.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.
	
	"layout2 addMorph: " ! !
!LibrosClientWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 15:15:51' prior: 50941404!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #newWordsArrived send: #refreshListOfWords to: self"! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:17:38' prior: 50941551 overrides: 50936705!
buildMorphicWindow

	| layout1 layout2 layout3 |
	
	self layoutMorph beRow.
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	layout3 := LayoutMorph newColumn.
	
	self addMorph: layout1.
	self addMorph: layout2.
	self addMorph: layout3.
	
	layout2 addMorph: ImageMorph initializedInstance.! !

LibrosClientWindow open.!

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 15:20:28' prior: 50941578 overrides: 50936705!
buildMorphicWindow

	| BorderLayout1 centerLayout BorderLayout2 |
	
	self layoutMorph beRow.
	
	BorderLayout1 := LayoutMorph newColumn.
	centerLayout := LayoutMorph newColumn.
	BorderLayout2 := LayoutMorph newColumn.
	
	self addMorph: BorderLayout1.
	self addMorph: centerLayout.
	self addMorph: BorderLayout2.
	
	centerLayout addMorph: ImageMorph initializedInstance.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:07:53' prior: 50941594 overrides: 50936705!
buildMorphicWindow

	| BorderLayout1 centerLayout BorderLayout2 |
	
	self layoutMorph beRow.
	
	BorderLayout1 := LayoutMorph newColumn.
	centerLayout := LayoutMorph newColumn.
	BorderLayout2 := LayoutMorph newColumn.
	
	centerLayout addMorph: ImageMorph initializedInstance.
	
	self addMorph: BorderLayout1.
	self addMorph: centerLayout.
	self addMorph: BorderLayout2.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:09:05' prior: 50941610 overrides: 50936705!
buildMorphicWindow

	| BorderLayout1 centerLayout BorderLayout2 |
	
	self layoutMorph beRow.
	
	BorderLayout1 := LayoutMorph newColumn.
	centerLayout := LayoutMorph newColumn.
	BorderLayout2 := LayoutMorph newColumn.
	
	centerLayout addMorph: ImageMorph initializedInstance.
	
	self addMorph: BorderLayout1.
	self addMorph: centerLayout.
	self addMorph: BorderLayout2.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:10:51' prior: 50941626 overrides: 50936705!
buildMorphicWindow

	| BorderLayout1 centerLayout BorderLayout2 |
	
	self layoutMorph beRow; center.
	
	"BorderLayout1 := LayoutMorph newColumn."
	centerLayout := LayoutMorph newColumn.
	"BorderLayout2 := LayoutMorph newColumn."
	
	centerLayout addMorph: ImageMorph initializedInstance.
	
	"self addMorph: BorderLayout1."
	self addMorph: centerLayout.
	"self addMorph: BorderLayout2."! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:11:58' prior: 50941642 overrides: 50936705!
buildMorphicWindow

	| BorderLayout1 centerLayout BorderLayout2 |
	
	self layoutMorph beRow.
	
	"BorderLayout1 := LayoutMorph newColumn."
	centerLayout := LayoutMorph newColumn.
	"BorderLayout2 := LayoutMorph newColumn."
	
	centerLayout addMorph: ImageMorph initializedInstance.
	
	"self addMorph: BorderLayout1."
	self addMorph: centerLayout.
	"self addMorph: BorderLayout2."! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:12:35' prior: 50941659 overrides: 50936705!
buildMorphicWindow

	| centerLayout |
	
	self layoutMorph beRow.
	
	centerLayout := LayoutMorph newColumn.
	
	centerLayout addMorph: ImageMorph initializedInstance.
	
	self addMorph: centerLayout.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:18:25' prior: 50941676 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; addMorph: ImageMorph initializedInstance.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:18:50' prior: 50941686 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	addMorph: ImageMorph initializedInstance.! !

LibrosClientWindow open.!

self updateMasterFromCopy!

self sourceCodeAt: #updateMasterFromCopy. !

self center. !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:24:50' prior: 50941694 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	addMorph: ImageMorph initializedInstance.! !

LibrosClientWindow open.!

LibrosClientWindow open.!

LibrosClientWindow open.!

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:35:55' prior: 50941705 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	"addMorph: ImageMorph initializedInstance."
	addMorph: LabelMorph contents: 'Usuario'.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:36:08' prior: 50941716 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	"addMorph: ImageMorph initializedInstance."
	addMorph: (LabelMorph contents: 'Usuario').! !

LibrosClientWindow open.!

!classDefinition: #LibrosClientWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 16:41:52'!
Panel subclass: #LibrosClientWindow
	instanceVariableNames: 'usernameTextMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 16:41:54'!
Panel subclass: #LibrosClientWindow
	instanceVariableNames: 'usernameTextMorph userpasswordTextMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:42:01' prior: 50941725 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	
	addMorph: (LabelMorph contents: 'Usuario');
	addMorph: usernameTextMorph;
	
	addMorph: (LabelMorph contents: 'Contraseña');
	addMorph: userpasswordTextMorph.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:42:20' prior: 50941752 overrides: 50936705!
buildMorphicWindow

	
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	
	addMorph: (LabelMorph contents: 'Usuario');
	addMorph: usernameTextMorph;
	
	addMorph: (LabelMorph contents: 'Contraseña');
	addMorph: userpasswordTextMorph.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:48:54' prior: 50941763 overrides: 50936705!
buildMorphicWindow

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5;
	
	addMorph: (LabelMorph contents: 'Usuario');
	addMorph: usernameTextMorph;
	
	addMorph: (LabelMorph contents: 'Contraseña');
	addMorph: userpasswordTextMorph.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:49:06'!
createUsernameTextMorph
	
	! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:49:20'!
createUserpasswordTextMorph! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:49:41' prior: 50941790!
createUserpasswordTextMorph

	! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:55:15' prior: 50941786!
createUsernameTextMorph
	
	"userBoxMorph := TextModelMorph textProvider: self model textGetter:     #sentenceText textSetter:     #sentenceText:. 
   	userBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key |     userBoxMorph textMorph acceptContents ] .
    	userBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
    	userBoxMorph morphHeight: 10."
	! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:56:19' prior: 50941798!
createUsernameTextMorph
	
	usernameTextMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
   	usernameTextMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextMorph textMorph acceptContents ] .
    	usernameTextMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
    	usernameTextMorph morphHeight: 10.
	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 16:56:37'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'no messages' stamp: 'G.L.S 7/3/2021 16:56:36'!
usernameText
	
	^username.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 16:57:01'!
usernameText: aUserName.

	username := aUserName.
	
	^true.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:58:42' prior: 50941774 overrides: 50936705!
buildMorphicWindow

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	
	self layoutMorph beRow; 
	axisEdgeWeight: 0.5.
	
	self addUsernameInput.
	self addUserpasswordInput.
	
	"addMorph: (LabelMorph contents: 'Usuario');
	addMorph: usernameTextMorph;"
	
	"addMorph: (LabelMorph contents: 'Contraseña');
	addMorph: userpasswordTextMorph."! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:59:10'!
addUsernameInput

	
! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 16:59:29' prior: 50941860!
addUsernameInput

	self layoutMorph
		addMorph: (LabelMorph contents: 'Usuario');
		addMorph: usernameTextMorph.
! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:00:04'!
addUserpasswordInput
	
	self layoutMorph 
		addMorph: (LabelMorph contents: 'Contraseña');
		addMorph: userpasswordTextMorph.
! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:00:30' prior: 50941846 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beRow; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	
	self addUsernameInput.
	self addUserpasswordInput.! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:01:18' prior: 50941794!
createUserpasswordTextMorph

	userpasswordTextMorph := TextModelMorph textProvider: self model textGetter: #userpasswordText textSetter: #userpasswordText:. 
   	userpasswordTextMorph textMorph setProperty: #keyStroke: toValue: [ :key | userpasswordTextMorph textMorph acceptContents ] .
    	userpasswordTextMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
    	userpasswordTextMorph morphHeight: 10.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 17:01:30'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:01:29'!
userpasswordText
	
	^userpassword.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:01:54'!
userpasswordText: aUserPassword.

	userpassword := aUserPassword.
	
	^true.! !

LibrosClientWindow open.!

self model!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:02:48' prior: 50941813!
createUsernameTextMorph
	
	usernameTextMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
   	usernameTextMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextMorph textMorph acceptContents ].
    	usernameTextMorph borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
    	usernameTextMorph morphHeight: 10.
	! !
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:02:57' prior: 50941888!
createUserpasswordTextMorph

	userpasswordTextMorph := TextModelMorph textProvider: self model textGetter: #userpasswordText textSetter: #userpasswordText:. 
   	userpasswordTextMorph textMorph setProperty: #keyStroke: toValue: [ :key | userpasswordTextMorph textMorph acceptContents ] .
    	userpasswordTextMorph borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
    	userpasswordTextMorph morphHeight: 10.! !

LibrosClientWindow open.!

Preferences standardCodeFont!
!LibrosClientModel methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 17:10:38' overrides: 16896425!
initialize! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:10:45' prior: 50941958 overrides: 16896425!
initialize
	
	username := ''.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:10:50' prior: 50941963 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.! !

LibrosClientWindow open.!
!LibrosClientWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:11:27' prior: 50941879 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	
	self addUsernameInput.
	self addUserpasswordInput.! !

LibrosClientWindow open.!

LibrosClientWindow open.!

self model usernameText .!

self model usernameText.!

self model usernameText.!

self model usernameText.!

!classRenamed: #LibrosClientWindow as: #LibrosClientLoginWindow stamp: 'G.L.S 7/3/2021 17:21:56'!
Smalltalk renameClassNamed: #LibrosClientWindow as: #LibrosClientLoginWindow!

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:22:38' prior: 50941975 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	
	self addUsernameInput.
	self addUserpasswordInput.
	
	self addSendInputButton.! !

!classDefinition: #LibrosClientLoginWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 17:23:25'!
Panel subclass: #LibrosClientLoginWindow
	instanceVariableNames: 'usernameTextMorph userpasswordTextMorph sendUserCredentialsButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:23:23'!
addSendInputButton
	
	self layoutMorph addMorph: sendUserCredentialsButton.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:23:49' prior: 50941997 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createSendInputButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	
	self addSendInputButton.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:23:52' prior: 50942024 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createSendInputButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addSendInputButton.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:24:39'!
createSendInputButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #showWordInTranscript 
								label: 'Entrar'.
! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 17:25:44' prior: 50942047!
createSendInputButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToEnterSystemWithUserCredentials
								label: 'Entrar'.
! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:25:58'!
tryToEnterSystemWithUserCredentials! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 17:26:01' prior: 50942066!
tryToEnterSystemWithUserCredentials
	
	! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 18:12:46'!
tryToCreateCartWithUserCredentials
	
	! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 18:12:46' prior: 50942056!
createSendInputButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Entrar'.
! !

!methodRemoval: LibrosClientModel #tryToEnterSystemWithUserCredentials stamp: 'G.L.S 7/3/2021 18:12:46'!
tryToEnterSystemWithUserCredentials
	
	!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:13:15' prior: 50942082!
createSendInputButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
! !

LibrosClientLoginWindow open.!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 18:15:27'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 18:15:24' prior: 50941968 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := RestInterface new.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 18:16:50' prior: 50942116 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := RestInterface listeningOn: 8080.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 18:17:42' prior: 50942123 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := RestInterface new.! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:19:05'!
port

	^port ifNil:[^8080].! !
!RestInterface methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:19:32' prior: 50942137!
port

	^port ifNil: [port:=8080].! !

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

!classRenamed: #RestInterface as: #LibrosServer stamp: 'G.L.S 7/3/2021 18:49:56'!
Smalltalk renameClassNamed: #RestInterface as: #LibrosServer!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 18:49:57' prior: 50942131 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosServer new.! !

Object subclass: #LibrosRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 18:50:21'!
Object subclass: #LibrosRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 18:50:36' prior: 50942153 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.! !
!LibrosRestInterface methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 18:51:34'!
url
	
	^'http://localhost:', self port asString! !

!classDefinition: #LibrosRestInterface category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 18:51:58'!
Object subclass: #LibrosRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 18:51:55'!
port

	^port ifNil: [port:=8080].! !
!LibrosRestInterface methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 18:52:36'!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	^ aParameter copyReplaceAll: ' ' with: '%20'.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:56:32' prior: 50942077!
tryToCreateCartWithUserCredentials
	
	| fieldDict |
	fieldDict := Dictionary new.
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:57:14' prior: 50942202!
tryToCreateCartWithUserCredentials
	
	| fieldDict |
	
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: username.
	fieldDict at: 'password' put: userpassword.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:58:26' prior: 50942208!
tryToCreateCartWithUserCredentials
	
	restInterface sendCreateCartRequestFor: username withPassword: userpassword.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:58:41' prior: 50942217!
tryToCreateCartWithUserCredentials
	
	restInterface sendCreateCartRequestFor: username withPassword: userpassword.
	
	! !
!LibrosRestInterface methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 18:59:06'!
sendCreateCartRequestFor: aUsername withPassword: aPassword! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 18:59:58' prior: 50942224!
tryToCreateCartWithUserCredentials
	
	restInterface sendCreateCartRequestFor: username withPassword: userpassword.
	
	"Activar ventana principal acá"
	
	! !
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:00:24' prior: 50942231!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict |
	fieldDict := Dictionary new.! !
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:01:07' prior: 50942245!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict |
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: aUsername.
	fieldDict at: 'password' put: aPassword.! !
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:01:11' prior: 50942252!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict |
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: aUsername.
	fieldDict at: 'password' put: aPassword.
	
	! !
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:02:44' prior: 50942262!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict |
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: aUsername.
	fieldDict at: 'password' put: aPassword.
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:02:56' prior: 50942272!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict |
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: aUsername.
	fieldDict at: 'password' put: aPassword.
	
	""
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:04:36' prior: 50942295!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict at: 'clientId' put: aUsername.
	fieldDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: ('') fields: fieldDict. 
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:04:48' prior: 50942318!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: ('') fields: fieldsDict. 
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:05:50' prior: 50942343!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: ('') fields: fieldsDict.
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:06:53' prior: 50942368!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:10:28' prior: 50942393!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:10:52' prior: 50942236!
tryToCreateCartWithUserCredentials
	
	restInterface sendCreateCartRequestFor: username withPassword: userpassword.
	
	"Activar ventana principal acá"
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:12:46' prior: 50942418!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:12:55' prior: 50942453!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 19:13:28' prior: 50942481!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 19:14:32'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:14:28' prior: 50942445!
tryToCreateCartWithUserCredentials
	
	cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword.
	
	"Activar ventana principal acá"
	
	! !

LibrosClientLoginWindow open.!

librosServer := LibrosServer listeningOn: 8080.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self class!

self content.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:26:01' prior: 50942544!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [].
	
	"Activar ventana principal acá"
	
	! !

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:27:00' prior: 50942563!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: ["Mostrar cartel de error acá"].
	
	"Activar ventana principal acá"
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:34:18' prior: 50942576!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: ["Mandar señal de error acá"].
	
	"Activar ventana principal acá"
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:35:20' prior: 50942586!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed on: self].
	
	"Activar ventana principal acá"
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:35:45' prior: 50942596!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self].
	
	"Activar ventana principal acá"
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:36:13' prior: 50942607!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	"Activar ventana principal acá"
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:36:53' prior: 50942618!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 19:38:16' prior: 50941564!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #newWordsArrived send: #refreshListOfWords to: self"
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 19:38:23'!
showCredentialError! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:38:39'!
showCartWindow! !

!classDefinition: #LibrosClientErrorWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 19:40:13'!
Object subclass: #LibrosClientErrorWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:39:59' prior: 50942659!
showCredentialError
	
	LibrosClientErrorWindow contents: MockRestInterface errorWrongUserCredentials.! !

Panel subclass: #LibrosClientErrorWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientErrorWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 19:40:29'!
Panel subclass: #LibrosClientErrorWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:40:53' prior: 50942663!
showCartWindow

	"Mostrar ventana principal acá"! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 19:41:16' prior: 50942694!
showCartWindow

	"Mostrar ventana principal acá"
	LibrosClientErrorWindow contents: 'Error - Todo está bien'.! !
!LibrosClientErrorWindow class methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 19:42:22'!
contents: anErrorDescription

	^self new initializeWith: anErrorDescription.! !
!LibrosClientErrorWindow methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 19:42:47'!
initializeWith: anErrorDescription! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 19:43:06' prior: 50942641!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:43:59' prior: 50942711!
initializeWith: anErrorDescription

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	"self model: (LibrosClientModel new)."
	"self morphExtent: (self defaultExtent)."
	"self buildMorphicWindow."
	self openInWorld.! !

LibrosClientErrorWindow open.!

LibrosClientErrorWindow contents: 'Hola'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:44:40' prior: 50942732!
initializeWith: anErrorDescription

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	"self model: (LibrosClientModel new)."
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:45:03' overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		addMorph: ''.! !

!classDefinition: #LibrosClientErrorWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 19:45:43'!
Panel subclass: #LibrosClientErrorWindow
	instanceVariableNames: 'description'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:45:41' prior: 50942746!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	"self model: (LibrosClientModel new)."
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:46:00' prior: 50942758 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		addMorph: (LabelMorph contents: description).! !

LibrosClientErrorWindow contents: 'Hola'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:46:24' prior: 50942785 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		beRow;
		addMorph: (LabelMorph contents: description).! !

LibrosClientErrorWindow contents: 'Hola'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:46:36' prior: 50942794 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: description).! !

LibrosClientErrorWindow contents: 'Hola'.!

LibrosClientErrorWindow contents: 'AAAAAAAAAAAAAAAAAAAAAAA'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:47:50' prior: 50942803 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: description).! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:48:47' prior: 50942772!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	"self model: (LibrosClientModel new)."
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.! !

LibrosClientLoginWindow open.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:50:22' prior: 50942815 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: description).! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:50:36' prior: 50942837 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: description).
		
	self morphExtent: ''.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:50:43' prior: 50942823!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	"self model: (LibrosClientModel new)."
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:51:25' prior: 50942845 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:51:40' prior: 50942866 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: errorLabel minimumExtent.! !

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaaaaaa'.!

LibrosClientErrorWindow contents: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaaaaaaaaaaaaaaaaaaaaaAAAAA'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:52:34' prior: 50942876 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + 0@10).! !

LibrosClientErrorWindow contents: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'.!

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaa'.!

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaa'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:53:35' prior: 50942892 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + (0@10)).! !

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaa'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:53:50' prior: 50942909 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + (100@0)).! !

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaa'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:53:59' prior: 50942922 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + (50@0)).! !

LibrosClientErrorWindow contents: 'aaaaaaaaaaaaaaaaa'.!

LibrosClientErrorWindow contents: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:55:55' prior: 50942854!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !

LibrosClientErrorWindow contents: ''.!

LibrosClientErrorWindow contents: ''.!

LibrosClientErrorWindow contents: ''.!

LibrosClientErrorWindow contents: ''.!
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:56:48' prior: 50942935 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + self errorMessagePanning).! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:57:01'!
errorMessagePanning

	^(50@0)! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:57:04' prior: 50942979!
errorMessagePanning

	^50@0! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 19:57:06' prior: 50942984!
errorMessagePanning

	^50@0.! !

LibrosClientErrorWindow contents: 'sssssssssssssssssssssssssssssssssssssssssssssss'.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosClientLoginWindow open.!

LibrosClientErrorWindow contents: ''.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

self model usernameText !

self model usernameText !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:05:00'!
showUserWindow

	"Mostrar ventana principal acá"
	LibrosClientErrorWindow contents: 'Error - Todo está bien'.! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:05:00' prior: 50942716!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showUserWindow to: self.! !

!methodRemoval: LibrosClientLoginWindow #showCartWindow stamp: 'G.L.S 7/3/2021 20:05:00'!
showCartWindow

	"Mostrar ventana principal acá"
	LibrosClientErrorWindow contents: 'Error - Todo está bien'.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:06:02' prior: 50942629!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyLogedIn with: self.
	
	! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:06:13' prior: 50943021!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

'pepe     ' withoutSeparators.!

'pepe     									' withoutSeparators. !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:09:00' prior: 50941840!
usernameText: aUserName.

	username := aUserName withoutSeparators.
	
	^true.! !

Panel subclass: #LibrosClientUserWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientUserWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:11:13'!
Panel subclass: #LibrosClientUserWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientUserWindow class methodsFor: 'no messages' stamp: 'G.L.S 7/3/2021 20:12:00'!
withModel: aModel
	
	^self new initializeWith: aModel.! !
!LibrosClientUserWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:13:16'!
initializeWith: aModel! !
!LibrosClientUserWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:14:03' prior: 50943106!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Pantalla Principal'.
	self model: aModel.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientUserWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:14:10' prior: 50943111!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Pantalla Principal'.
	self model: aModel.
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientUserWindow methodsFor: 'nil' stamp: 'G.L.S 7/3/2021 20:14:20' overrides: 50936705!
buildMorphicWindow! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:15:45' prior: 50943014!
showUserWindow

	"Mostrar ventana principal acá"
	LibrosClientUserWindow withModel: self model.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/3/2021 20:17:05' prior: 50943083!
usernameText: aUserName.

	username := aUserName.
	
	^true.! !
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/3/2021 20:17:21' prior: 50941917!
userpasswordText: aUserPassword.

	userpassword := aUserPassword asString withoutSeparators.
	
	^true.! !

librosServer destroy.!

librosServer destroy.!

LibrosClientLoginWindow open.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self model usernameText.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/3/2021 20:19:09' prior: 50943167!
userpasswordText: aUserPassword.

	userpassword := aUserPassword.
	
	^true.! !

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:01' prior: 50943142 overrides: 50936705!
buildMorphicWindow
	
	self createCreateCartButton.
	self createListPurchasesButton.
	
	self addCartButton.
	self createListPurchasesButton.! !
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:14' prior: 50943190 overrides: 50936705!
buildMorphicWindow
	
	self createCreateCartButton.
	self createListPurchasesButton.
	
	self addCartButton.
	self addListPurchasesButton.! !
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:28'!
createCreateCartButton
! !
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:37'!
createListPurchasesButton! !
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:45'!
addCartButton! !
!LibrosClientUserWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:21:52'!
addListPurchasesButton! !
!LibrosClientUserWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:22:32' prior: 50943207!
createCreateCartButton

	
! !

!classDefinition: #LibrosClientUserWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:23:21'!
Panel subclass: #LibrosClientUserWindow
	instanceVariableNames: 'createCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientUserWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:23:11' prior: 50943223!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.

	
! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:27:23' prior: 50943043!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:27:41' prior: 50943055!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showUserWindow to: self.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:28:04'!
showCartWindow

	"Mostrar ventana principal acá"
	LibrosClientUserWindow withModel: self model.! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:28:04' prior: 50943259!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.! !

!methodRemoval: LibrosClientLoginWindow #showUserWindow stamp: 'G.L.S 7/3/2021 20:28:04'!
showUserWindow

	"Mostrar ventana principal acá"
	LibrosClientUserWindow withModel: self model.!

!classRenamed: #LibrosClientUserWindow as: #LibrosClientCartWindow stamp: 'G.L.S 7/3/2021 20:28:24'!
Smalltalk renameClassNamed: #LibrosClientUserWindow as: #LibrosClientCartWindow!
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:28:25' prior: 50943274!
showCartWindow

	"Mostrar ventana principal acá"
	LibrosClientCartWindow withModel: self model.! !

!methodRemoval: LibrosClientCartWindow #createCreateCartButton stamp: 'G.L.S 7/3/2021 20:28:39'!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.

	
!

!methodRemoval: LibrosClientCartWindow #createListPurchasesButton stamp: 'G.L.S 7/3/2021 20:28:41'!
createListPurchasesButton!

!methodRemoval: LibrosClientCartWindow #addCartButton stamp: 'G.L.S 7/3/2021 20:28:43'!
addCartButton!

!methodRemoval: LibrosClientCartWindow #addListPurchasesButton stamp: 'G.L.S 7/3/2021 20:28:45'!
addListPurchasesButton!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:28:51' prior: 50943199 overrides: 50936705!
buildMorphicWindow! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:29:13' prior: 50943127!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Pantalla Principal'.
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:30:25' prior: 50942036 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createSendInputButton.
	self createListPurchasesButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addSendInputButton.
	self addListPurchasesButton.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:30:39'!
createListPurchasesButton.
	
	! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:30:47'!
addListPurchasesButton! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:31:15'!
addCreateCartButton
	
	self layoutMorph addMorph: sendUserCredentialsButton.! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:31:15' prior: 50943365 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createSendInputButton.
	self createListPurchasesButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addCreateCartButton.
	self addListPurchasesButton.! !

!methodRemoval: LibrosClientLoginWindow #addSendInputButton stamp: 'G.L.S 7/3/2021 20:31:15'!
addSendInputButton
	
	self layoutMorph addMorph: sendUserCredentialsButton.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:31:30'!
createCreateCartButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:31:30' prior: 50943393 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createCreateCartButton.
	self createListPurchasesButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addCreateCartButton.
	self addListPurchasesButton.! !

!methodRemoval: LibrosClientLoginWindow #createSendInputButton stamp: 'G.L.S 7/3/2021 20:31:30'!
createSendInputButton

	sendUserCredentialsButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
!

!classDefinition: #LibrosClientLoginWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:32:22'!
Panel subclass: #LibrosClientLoginWindow
	instanceVariableNames: 'usernameTextMorph userpasswordTextMorph sendUserCredentialsButton listPurchasesButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:32:20' prior: 50943378!
createListPurchasesButton.

	listPurchasesButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToListPurchasesWithUserCredentials
								label: 'List Purchases'.
	
	! !

!classDefinition: #LibrosClientLoginWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:32:36'!
Panel subclass: #LibrosClientLoginWindow
	instanceVariableNames: 'usernameTextMorph userpasswordTextMorph createCartButton listPurchasesButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:32:36' prior: 50943411!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 20:32:36' prior: 50943386!
addCreateCartButton
	
	self layoutMorph addMorph: createCartButton.! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:33:04' prior: 50943382!
addListPurchasesButton

	self layoutMorph addMorph: listPurchasesButton.! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:34:42' prior: 50943422 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5;
	separation: 25.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createCreateCartButton.
	self createListPurchasesButton.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addCreateCartButton.
	self addListPurchasesButton.! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:35:47' prior: 50943476!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:37:17' prior: 50943516!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
	
	createCartButton layoutSpec proportionalWidth: 30.
! !

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:37:54' prior: 50943527!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
	
	createCartButton layoutSpec proportionalWidth: 0.3.
! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:38:17' prior: 50943540!
createCreateCartButton

	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:38:34' prior: 50943501 overrides: 50936705!
buildMorphicWindow

	self layoutMorph beColumn; 
	axisEdgeWeight: 0.5;
	separation: 25.

	self createUsernameTextMorph.
	self createUserpasswordTextMorph.
	self createCreateCartButton.
	self createListPurchasesButton.
	
	self setButtonsWidth.
	
	self addUsernameInput.
	self addUserpasswordInput.
	self addCreateCartButton.
	self addListPurchasesButton.! !
!LibrosClientLoginWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:38:48'!
setButtonsWidth.
	
	createCartButton layoutSpec proportionalWidth: 0.3.
	listPurchasesButton layoutSpec proportionalWidth: 0.3.! !

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:45:16' prior: 50943281!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	self model when: #successfullyListedPurchases send: #showPurchasesWindow to: self.! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 20:45:20'!
showPurchasesWindow! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:46:51'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/3/2021 20:46:41' prior: 50943604!
showPurchasesWindow
	
	LibrosClientPurchasesWindow withModel: self model. ! !
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/3/2021 20:47:02' prior: 50943616!
showPurchasesWindow
	
	LibrosClientPurchasesWindow withModel: self model.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:47:43'!
tryToListPurchasesWithUserCredentials
	
	[cartId := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/3/2021 20:48:09'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:48:07' prior: 50943627!
tryToListPurchasesWithUserCredentials
	
	[purchases := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/3/2021 20:48:29' prior: 50943648!
tryToListPurchasesWithUserCredentials
	
	[purchases := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:53:16'!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:53:27' prior: 50943672!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:54:43' prior: 50942508!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^ WebClient jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:54:57' prior: 50943715!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebClient jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:55:34' prior: 50943744!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [^WebClient jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

WebClient jsonDecode: ((self content) readStream)!

WebUtils jsonDecode: ((self content) readStream)!

librosServer destroy.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 20:57:54' prior: 50943773!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

'0|1' copyReplacing: '0|' with: ''.!

'0|1' copyReplacing: '0|' with: $.!

'0|1' copyReplacing: '0|' with: ''.!

'0|1' copyFrom: 1 to: 4. !

'0|1' copyFrom: 1 to: 3.!

'0|1' copyFrom: 0 to: 3. '0|1' !

'0|1' copyFrom: 3 to: 3.  !

'0|1' copyFrom: 2 to: 3.   '1' !

'0|1' copyFrom: 2 to: 3.!

'0|1444' copyFrom: 3 to: 6. !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 21:02:56' prior: 50943811!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |temp|
			temp := WebUtils jsonDecode: ((resp content) readStream).
			^temp copyFrom: 3 to: temp size.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

jorge := '0|1444'.!

jorge copyFrom: 3 to: 6.  !

jorge copyFrom: 3 to: jorge size.!

jorge copyFrom: 3 to: jorge size.!

jorge := '0|1444555555555555555555'.!

jorge copyFrom: 3 to: jorge size. !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 21:03:49' prior: 50943851!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |temp|
			temp := WebUtils jsonDecode: ((resp content) readStream).
			^(temp copyFrom: 3 to: temp size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 21:04:25' prior: 50943889!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |temp|
			temp := WebUtils jsonDecode: ((resp content) readStream).
			^(temp copyFrom: 3 to: temp size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 21:04:40' prior: 50943921!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

jorge copyFrom: 3 to: jorge size asNumber..!

(jorge copyFrom: 3 to: jorge size) asNumber.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 21:06:55' prior: 50943341!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	"self morphExtent: (self defaultExtent)."
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/3/2021 21:07:30' prior: 50943953!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !

librosServer destroy.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 21:08:12' prior: 50943989!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/3/2021 21:08:27' overrides: 50936791!
defaultExtent
	
	^50@50.
! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 21:08:47' prior: 50944059 overrides: 50936791!
defaultExtent
	
	^1035@485
! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 21:08:48' prior: 50944064 overrides: 50936791!
defaultExtent
	
	^1035@485.
! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/3/2021 21:09:19' prior: 50943337 overrides: 50936705!
buildMorphicWindow
	
	! !
!LibrosClientPurchasesWindow class methodsFor: 'no messages' stamp: 'G.L.S 7/3/2021 21:09:46'!
withModel: aModel
	
	^self new initializeWith: aModel.! !
!LibrosClientPurchasesWindow methodsFor: 'no messages' stamp: 'G.L.S 7/3/2021 21:10:15'!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 21:10:35' overrides: 50936791!
defaultExtent
	
	^1035@485.! !

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/3/2021 21:11:35' overrides: 50936705!
buildMorphicWindow
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----QUIT----(3 July 2021 21:19:00) CuisUniversity-4532.image priorSource: 19513116!

----STARTUP---- (6 July 2021 15:22:29) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

jorge := '0|1444555555555555555555'.!

(jorge copyFrom: 3 to: jorge size) asNumber.!

jorge := '0|1444555555555555555555'.!

(jorge copyFrom: 3 to: jorge size) asNumber.!

(jorge copyFrom: 3 to: jorge size) asNumber.!

(jorge copyFrom: 3 to: jorge size) asNumber.!

 1444555555555555555555 !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:52:54' prior: 50944080 overrides: 50936705!
buildMorphicWindow
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:55:10' prior: 50944158 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:57:14' prior: 50944163 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 15:58:17'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'createCartButton addToCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:58:15'!
createAddToCartButton.
	
	addToCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #addSelectedItemToCart
								label: 'Add to cart'.	
	! !

Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 15:58:28'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:58:44'!
createRemoveFromCartButton

	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:58:48' prior: 50944186!
createAddToCartButton
	
	addToCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #addSelectedItemToCart
								label: 'Add to cart'.	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:58:58'!
createCheckoutButton
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:59:08'!
createLogoutButton
	
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 15:59:49'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 15:59:45' prior: 50944208!
createRemoveFromCartButton

	removeFromCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #removeSelectedItemFromCart
								label: 'Remove from cart'.	

	
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:00:34'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:00:27' prior: 50944222!
createCheckoutButton
	
	checkOutCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #checkoutCart
								label: 'Checkout'.
	
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:01:17'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:01:13' prior: 50944226!
createLogoutButton
	
	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:05:07' prior: 50944169 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:06:57' prior: 50944287 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	
	self createStoreItemList.
	self createCartItemList.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:07:11'!
createStoreItemList
	
	""
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:07:23'!
createCartItemList

	""	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:07:57' prior: 50944311!
createCartItemList

	self shouldBeImplemented.	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:08:08' prior: 50944307!
createStoreItemList
	
	self shouldBeImplemented.
	
	
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:16:48'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:16:46' prior: 50944321!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:16:55' prior: 50944337!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:16:57' prior: 50944348!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:19:33' prior: 50944359!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #getStoreItemList indexGetter: #storeItemListIndex indexSetter: #storeItemListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	
	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:26:07'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList cartItemsList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:26:06' prior: 50944316!
createCartItemList

	cartItemsList := PluggableListMorph model: self model listGetter: #getStoreItemList indexGetter: #storeItemListIndex indexSetter: #storeItemListIndex:.
	cartItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:26:28' prior: 50944393!
createCartItemList

	cartItemsList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	cartItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:29:13' prior: 50944297 overrides: 50936705!
buildMorphicWindow
	
	| buttonsColumn cartListColumn storeListColumn |
	self layoutMorph beColumn.
	
	storeListColumn := LayoutMorph beColumn.
	cartListColumn := LayoutMorph beColumn.
	buttonsColumn := LayoutMorph beColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addMorph: ''.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:29:34' prior: 50944417 overrides: 50936705!
buildMorphicWindow
	
	| buttonsColumn cartListColumn storeListColumn |
	
	self layoutMorph beColumn.
	
	storeListColumn := LayoutMorph beColumn.
	cartListColumn := LayoutMorph beColumn.
	buttonsColumn := LayoutMorph beColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addMorph: ''.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:30:06' prior: 50944434 overrides: 50936705!
buildMorphicWindow
	
	| buttonsColumn cartListColumn storeListColumn |
	
	self layoutMorph beColumn.
	
	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addMorph: ''.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:31:15' prior: 50944451 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	"storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn."
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:31:20'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList cartItemsList storeListColumn'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:31:21'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList cartItemsList storeListColumn cartListColumn'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:31:22'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList cartItemsList storeListColumn cartListColumn buttonsColumn'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:31:18' prior: 50944469 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:31:37' prior: 50944520 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:31:46'!
createLayoutColumns

	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:32:27' prior: 50944535 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addStoreList.
	self addCartList.
	self addButtons.
	
	self addLayouts.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:32:54'!
addStoreList
	
	storeListColumn addMorph: storeItemsList.

	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:33:04'!
addCartList.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:35:45' prior: 50944573!
addCartList
	
	cartListColumn addMorph: 	cartItemsList.
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:36:23'!
addButtons

	

	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:37:31' prior: 50944582!
addButtons

	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	

	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:38:28'!
addLayouts

	self layoutMorph addMorph:  storeListColumn.
	self layoutMorph addMorph:  cartListColumn.
	self layoutMorph addMorph:  buttonsColumn.
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:39:25'!
getStoreItemList
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:39:30' prior: 50944609!
getStoreItemList
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:41:38'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:41:39'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 16:41:36' prior: 50942172 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeItemList := OrderedCollection new.
	cartItemList := OrderedCollection new.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:41:49' prior: 50944614!
getStoreItemList
	^storeItemList.
	! !

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:42:24'!
storeItemListIndex
	self shouldBeImplemented.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:42:46'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:42:44' prior: 50944660!
storeItemListIndex
	^storeItemListIndex! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:44:01'!
storeItemListIndex: anIndex
	storeItemListIndex := anIndex.! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 16:45:51' prior: 50944644 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeItemList := OrderedCollection new.
	cartItemList := OrderedCollection new.
	storeItemListIndex := 0.! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:46:15'!
getCartItemList
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:46:24' prior: 50944700!
getCartItemList
	^cartItemList.! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:47:01'!
cartItemListIndex
	self shouldBeImplemented.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 16:47:17'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:47:14' prior: 50944710!
cartItemListIndex
	^cartItemListIndex.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 16:47:31' prior: 50944689 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeItemList := OrderedCollection new.
	cartItemList := OrderedCollection new.
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:47:58'!
cartItemListIndex: anIndex
	cartItemListIndex := anIndex.! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:48:48' prior: 50944555 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addStoreList.
	self addCartList.
	self addButtons.
	
	self addLayouts.
	! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:49:12'!
addSelectedItemToCart
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:49:25'!
removeSelectedItemFromCart
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:49:36'!
checkoutCart
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 16:49:46'!
logout
	self shouldBeImplemented.! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:53:48' prior: 50944546!
createLayoutColumns

	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	storeItemsList layoutSpec axisEdgeWeight: 0.5.
! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:54:25' prior: 50944782!
createLayoutColumns

	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	storeListColumn layoutSpec axisEdgeWeight: 0.5.
	cartListColumn layoutSpec axisEdgeWeight: 0.5.
	buttonsColumn layoutSpec axisEdgeWeight: 0.5.! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:54:48' prior: 50944792!
createLayoutColumns

	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	storeListColumn axisEdgeWeight: 0.5.
	cartListColumn axisEdgeWeight: 0.5.
	buttonsColumn axisEdgeWeight: 0.5.! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:56:06' prior: 50944370!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #getStoreItemList indexGetter: #storeItemListIndex indexSetter: #storeItemListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	storeItemsList layoutSpec proportionalHeight: 0.9.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:56:27' prior: 50944405!
createCartItemList

	cartItemsList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	cartItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	cartItemsList layoutSpec proportionalHeight: 0.9.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:56:37' prior: 50944830!
createCartItemList

	cartItemsList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	cartItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	cartItemsList layoutSpec proportionalHeight: 0.8.
	
	
	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:57:05' prior: 50944843!
createCartItemList

	cartItemsList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	cartItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	cartItemsList layoutSpec proportionalHeight: 0.85.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:57:21' prior: 50944817!
createStoreItemList
	
	storeItemsList := PluggableListMorph model: self model listGetter: #getStoreItemList indexGetter: #storeItemListIndex indexSetter: #storeItemListIndex:.
	storeItemsList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	storeItemsList layoutSpec proportionalHeight: 0.85.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:57:51' prior: 50944748 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self createStoreListText.
	self createCartListText
	
	self addStoreList.
	self addCartList.
	self addButtons.
	
	self addLayouts.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:58:05'!
createStoreListText
	
	


	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:58:15'!
createCartListText

	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:59:01' prior: 50944884 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	
	self addStoreList.
	self addCartList.
	self addButtons.
	
	self addLayouts.
	! !

!methodRemoval: LibrosClientCartWindow #createCartListText stamp: 'G.L.S 7/6/2021 16:59:03'!
createCartListText

	!

!methodRemoval: LibrosClientCartWindow #createStoreListText stamp: 'G.L.S 7/6/2021 16:59:06'!
createStoreListText
	
	


	!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:59:26' prior: 50944568!
addStoreList
	
	storeListColumn addMorph: (LabelMorph contents: 'Catalogo de la Tienda').
	storeListColumn addMorph: storeItemsList.

	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 16:59:47' prior: 50944577!
addCartList
	
	cartListColumn addMorph: (LabelMorph contents: 'Items del carrito actual').
	cartListColumn addMorph: 	cartItemsList.
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 17:18:31' prior: 50944043!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 17:19:22' prior: 50944945!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #catalogUpdated send: #refreshItemCatalog to: self.
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 17:23:39' prior: 50944967!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #catalogUpdated send: #refreshItemCatalog to: self.
	
	self model 
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

d _ Dictionary new.!

d add: '0'->'1'.!

d!

d asArray !

d _ Dictionary new.!

d add: 'pepe'->'1'.!

d asArray!

d asArray!

d keys !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:00:51'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:00:48'!
obtainCatalog
	
	[catalog := restInterface getCatalogRequest]
	on: Error
	do: [self triggerEvent: #catalogError with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:01:18' prior: 50945033!
obtainCatalog
	
	[catalog := restInterface getCatalogRequest]
	on: Error
	do: [self triggerEvent: #catalogError with: self.
		^self].
	
	self triggerEvent: #catalogUpdated with: self.
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:02:15' prior: 50944991!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #catalogUpdated send: #refreshItemCatalog to: self.
	self model when: #catalogError send: #showCatalogError to: self.
	
	self model 
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/6/2021 18:03:03'!
getCatalogRequest

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	! !

!methodRemoval: LibrosRestInterface #getCatalogRequest stamp: 'G.L.S 7/6/2021 18:03:31'!
getCatalogRequest

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	!

!methodRemoval: LibrosClientModel #obtainCatalog stamp: 'G.L.S 7/6/2021 18:03:44'!
obtainCatalog
	
	[catalog := restInterface getCatalogRequest]
	on: Error
	do: [self triggerEvent: #catalogError with: self.
		^self].
	
	self triggerEvent: #catalogUpdated with: self.
	
	!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:03:58' prior: 50945053!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
	self model 
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:04:31' prior: 50944731 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeItemList := OrderedCollection new.
	cartItemList := OrderedCollection new.
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	catalog := StoreObjectFactory createDefaultCatalog.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:04:45' prior: 50945131 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeItemList := OrderedCollection new.
	cartItemList := OrderedCollection new.
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:04:57'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:06:15'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:06:12' prior: 50945144 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory createDefaultCatalog.
	storeItemList := catalog keys.
	cartItemList := OrderedCollection new.
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:06:20' prior: 50945178 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory createDefaultCatalog.
	storeItemList := catalog keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:06:39' prior: 50945191 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog.
	storeItemList := catalog keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:08:48' prior: 50945204 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog keys.
	
	storeItemList := catalog keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:12:05'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalogKeyList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 18:12:05' prior: 50945223 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalogKeyList := StoreObjectFactory new createDefaultCatalog keys.
	
	storeItemList := catalogKeyList keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:12:19'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 18:12:19' prior: 50945248 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog keys.
	
	storeItemList := catalog keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:12:25' prior: 50945273 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog.
	
	storeItemList := catalog keys.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:12:33' prior: 50945286 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:12:47' prior: 50945299 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:13:36'!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:29:30' prior: 50944908 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	self createLayoutColumns.
	self createAddToCartButton.
	self createRemoveFromCartButton.
	self createCheckoutButton.
	self createLogoutButton.
	self createStoreItemList.
	self createCartItemList.
	self createCartItemAMountTextbox.
	
	self addStoreList.
	self addCartList.
	self addButtons.
	
	self addLayouts.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:29:59'!
createCartItemAMountTextbox

	
	! !

!classDefinition: #LibrosClientCartWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:30:09'!
Panel subclass: #LibrosClientCartWindow
	instanceVariableNames: 'addToCartButton removeFromCartButton checkOutCartButton logoutButton storeItemsList cartItemsList storeListColumn cartListColumn buttonsColumn itemAmountTextBox'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:30:07' prior: 50945343!
createCartItemAMountTextbox

	itemAmountTextBox := ''
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:30:11' prior: 50945360!
createCartItemAMountTextbox

	itemAmountTextBox := ''.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:31:10' prior: 50945365!
createCartItemAMountTextbox

	
	
	itemAmountTextBox := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	itemAmountTextBox textMorph setProperty: #keyStroke: toValue: [ :key | itemAmountTextBox textMorph acceptContents ] .
	itemAmountTextBox borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:31:26' prior: 50945370!
createCartItemAMountTextbox

	
	
	itemAmountTextBox := TextModelMorph textProvider: self model textGetter: #itemAmountText textSetter: #itemAmountText:. 
	itemAmountTextBox textMorph setProperty: #keyStroke: toValue: [ :key | itemAmountTextBox textMorph acceptContents ] .
	itemAmountTextBox borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	! !
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/6/2021 18:31:44' prior: 50944586!
addButtons
	
	buttonsColumn addMorph: itemAmountTextBox.
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	

	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/6/2021 18:32:29'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'getters' stamp: 'G.L.S 7/6/2021 18:32:27'!
itemAmountText
	
	^itemAmount.! !
!LibrosClientModel methodsFor: 'getters' stamp: 'G.L.S 7/6/2021 18:32:38' prior: 50945422!
itemAmountText
	
	^itemAmount.! !
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/6/2021 18:33:12'!
itemAmountText: anAmountOfItemsString

	itemAmount := anAmountOfItemsString.
	
	^true.! !
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/6/2021 18:33:16' prior: 50945430!
itemAmountText: anAmountOfItemsString

	itemAmount := anAmountOfItemsString asNumber.
	
	^true.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:45:37' prior: 50945323!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
	
	catalog keysDo: [:key |
		
		storeItemList add: key, '-', 'Nombre Libro'.
		
		].
! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:45:41' prior: 50945443!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
	
	catalog keysDo: [:key |
		storeItemList add: key, '-', 'Nombre Libro'.
		].
! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:46:27' prior: 50945311 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	catalog := StoreObjectFactory new createDefaultCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.! !
!LibrosClientModel methodsFor: 'setters' stamp: 'G.L.S 7/6/2021 18:46:44' prior: 50945436!
itemAmountText: anAmountOfItemsString

	itemAmount := anAmountOfItemsString.
	
	^true.! !

LibrosClientLoginWindow open.!

storeItemsList!

self getStoreItemList !

self model getStoreItemList !

self model getStoreItemList at: (self model storeItemListIndex)!

'aaaaa-bbbbb' copyUpTo: $-.!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/6/2021 18:51:28' prior: 50945451!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
	
	catalog keysDo: [:key |
		storeItemList add: key, ' - ', 'Nombre Libro'.
		].
! !

'aaaaa - bbbbb' copyUpTo: $-. !

'aaaaa - bbbbb' copyUpTo: $-.  !

'aaaaa - bbbbb' copyUpTo: $-.   'aaaaa ' withoutTrailingBlanks !

'aaaaa - bbbbb' copyUpTo: $-.   '   aaaaa ' withoutTrailingBlanks.!

'aaaaa - bbbbb' copyUpTo: $-.   'aaaaa ' withoutSeparators .!

'aaaaa - bbbbb' copyUpTo: $-.   '          aaaaa ' withoutSeparators.!

'aaaaa - bbbbb' copyUpTo: $-.   '          aaaaa - bbbbb' withoutSeparators.!

'aaaaa - bbbbb' copyUpTo: $- withoutSeparators.!

('aaaaa - bbbbb' copyUpTo: $-) withoutSeparators.!

('aaaaa - bbbbb' copyUpTo: $-) withoutSeparators.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:55:46' prior: 50945400!
addButtons
	
	buttonsColumn addMorph: (LabelMorph contents: 'Items del carrito actual').
	buttonsColumn addMorph: itemAmountTextBox.
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	

	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:55:48' prior: 50945512!
addButtons
	
	buttonsColumn addMorph: (LabelMorph contents: 'Items del carrito actual').
	buttonsColumn addMorph: itemAmountTextBox.
	
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	

	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:56:27' prior: 50944805!
createLayoutColumns

	storeListColumn := LayoutMorph newColumn.
	cartListColumn := LayoutMorph newColumn.
	buttonsColumn := LayoutMorph newColumn.
	
	storeListColumn axisEdgeWeight: 0.5.
	cartListColumn axisEdgeWeight: 0.5.
	buttonsColumn axisEdgeWeight: 0.5.! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:56:59' prior: 50945526!
addButtons
	
	| layout1 |
	layout1 := LayoutMorph newColumn.
	
	buttonsColumn addMorph: (LabelMorph contents: 'Items del carrito actual').
	buttonsColumn addMorph: itemAmountTextBox.
	
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	

	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:57:47' prior: 50945552!
addButtons
	
	| layout1 |
	
	layout1 := LayoutMorph newColumn.
	
	layout1 addMorph: (LabelMorph contents: 'Items del carrito actual').
	layout1 addMorph: itemAmountTextBox.
	
	buttonsColumn  addMorph: layout1.
	
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	
	
	

	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:58:18' prior: 50945567!
addButtons
	
	| layout1 layout2 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	
	layout1 addMorph: (LabelMorph contents: 'Items del carrito actual').
	layout1 addMorph: itemAmountTextBox.
	
	buttonsColumn  addMorph: layout1.
	
	buttonsColumn addMorph: addToCartButton.
	buttonsColumn addMorph: removeFromCartButton.
	buttonsColumn addMorph: checkOutCartButton.
	buttonsColumn addMorph: logoutButton.
	
	
	

	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 18:58:49' prior: 50945584!
addButtons
	
	| layout1 layout2 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	
	layout1 addMorph: (LabelMorph contents: 'Items del carrito actual').
	layout1 addMorph: itemAmountTextBox.
	
	layout2 addMorph: addToCartButton.
	layout2 addMorph: removeFromCartButton.
	layout2 addMorph: checkOutCartButton.
	layout2 addMorph: logoutButton.
	
	buttonsColumn  addMorph: layout1.
	buttonsColumn  addMorph: layout2.
	
	
	
	
	

	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 19:02:00' prior: 50945602!
addButtons
	
	| layout1 layout2 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	
	layout1 axisEdgeWeight: 0.5.
	layout2 axisEdgeWeight: 0.5.
	
	layout1 addMorph: (LabelMorph contents: 'Items del carrito actual').
	layout1 addMorph: itemAmountTextBox.
	
	layout2 addMorph: addToCartButton.
	layout2 addMorph: removeFromCartButton.
	layout2 addMorph: checkOutCartButton.
	layout2 addMorph: logoutButton.
	
	buttonsColumn  addMorph: layout1.
	buttonsColumn  addMorph: layout2.
	
	
	
	
	

	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 19:02:43' prior: 50945385!
createCartItemAMountTextbox

	
	
	itemAmountTextBox := TextModelMorph textProvider: self model textGetter: #itemAmountText textSetter: #itemAmountText:. 
	itemAmountTextBox textMorph setProperty: #keyStroke: toValue: [ :key | itemAmountTextBox textMorph acceptContents ] .
	itemAmountTextBox borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	itemAmountTextBox layoutSpec fixedHeight: 30.
	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 19:03:41' prior: 50945621!
addButtons
	
	| layout1 layout2 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	
	layout1 axisEdgeWeight: 0.5.
	layout2 axisEdgeWeight: 0.5.
	
	layout1 addMorph: (LabelMorph contents: 'Cantidad de items a manipular').
	layout1 addMorph: itemAmountTextBox.
	
	layout2 addMorph: addToCartButton.
	layout2 addMorph: removeFromCartButton.
	layout2 addMorph: checkOutCartButton.
	layout2 addMorph: logoutButton.
	
	buttonsColumn  addMorph: layout1.
	buttonsColumn  addMorph: layout2.
	
	
	
	
	

	! !

LibrosClientLoginWindow open.!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:09:09'!
test08CannotRemoveAnItemIfItIsNotInTheCart
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:09:11' prior: 50945680!
test08CannotRemoveAnItemIfItIsNotInTheCart

	
	
	
	! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/6/2021 19:11:25'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:11:33' prior: 50945685!
test08CannotRemoveAnItemIfItIsNotInTheCart

	
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:11:45' prior: 50945718!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:11:53' prior: 50945723!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:12:51' prior: 50945730!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error  
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:13:13'!
ERROR!
!Cart class methodsFor: 'error' stamp: 'G.L.S 7/6/2021 19:13:26'!
errorCannotRemoveAnItemNotInCart
	self shouldBeImplemented.! !
!Cart class methodsFor: 'error' stamp: 'G.L.S 7/6/2021 19:13:54' prior: 50945753!
errorCannotRemoveAnItemNotInCart
	^'Error - No se puede remover ese item, no está dentro del carrito'.! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:13:55'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:14:15' prior: 50945737!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:14:22'!
ERROR!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:14:49' prior: 50945768!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:14:50'!
FAILURE!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:15:06'!
FAILURE!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:15:15' prior: 50945785!
test08CannotRemoveAnItemIfItIsNotInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:15:16'!
ERROR!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:16:18'!
remove: anItem
	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:16:29' prior: 50945820!
remove: aBook
	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:16:47' prior: 50945824!
remove: aBook
	
	self remove: aBook amount: 1.
	! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:17:05'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/6/2021 19:17:15'!
remove: aString amount: aSmallInteger 
	self shouldBeImplemented.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:17:59' prior: 50945836!
remove: aString amount: anAmount
	self shouldBeImplemented.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:18:04' prior: 50945841!
remove: aString amount: anAmount

	self shouldBeImplemented.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:19:12' prior: 50945846!
remove: aString amount: anAmount

	self assertBookInCart: aString.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:19:29' prior: 50945851!
remove: aBook amount: anAmount

	self assertBookInCart: aBook.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:19:36'!
assertBookInCart: aBook
	
	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:20:14' prior: 50945861!
assertBookInCart: aBook
	
	(self isBookInCart: aBook) ifFalse: [self error: self class errorCannotRemoveAnItemNotInCart].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:20:24'!
isBookInCart: aBook
	
	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:21:54' prior: 50945871!
isBookInCart: aBook
	
	| found |
	found := false.
	
	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue: [found := true].
		].
	
	^found.! !

ju := Object new.!

ju includes: 9.!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:23:42'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:23:46'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:23:53'!
test09

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:25:50'!
test09CannotRemoveMoreItemsThatTheOnesTheCartHas

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !

!methodRemoval: CartTest #test09 stamp: 'G.L.S 7/6/2021 19:25:50'!
test09

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	
	self should: [
		carrito remove: smalltalk80.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:26:21' prior: 50945926!
test09CannotRemoveMoreItemsThatTheOnesTheCartHas

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	
	self should: [
		carrito remove: smalltalk80 amount: 450.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveAnItemNotInCart.
			].
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:26:42' prior: 50945951!
test09CannotRemoveMoreItemsThatTheOnesTheCartHas

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	
	self should: [
		carrito remove: smalltalk80 amount: 450.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveMoreItemsThanWhatTheCartHas.
			].
	
	
	! !

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:26:48'!
FAILURE!
!Cart class methodsFor: 'errors' stamp: 'G.L.S 7/6/2021 19:27:26'!
errorCannotRemoveMoreItemsThanWhatTheCartHas
	^'Error - No se puede remover una cantidad mayor de items de las que tiene el carrito'.! !

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:27:35'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:27:38'!
FAILURE!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:27:38'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:28:28' prior: 50945856!
remove: aBook amount: anAmount

	self assertBookInCart: aBook.
	
	""! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:29:38' prior: 50946003!
remove: aBook amount: anAmount

	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:29:49'!
assertCartCanRemove: anAmount ofItem: aBook

	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:31:16' prior: 50946014!
assertCartCanRemove: anAmount ofItem: aBook

	| itemToRemove |
	
	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue:[itemToRemove := aCartItem].
		].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:31:43' prior: 50946019!
assertCartCanRemove: anAmount ofItem: aBook

	| itemToRemove |
	
	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue:[itemToRemove := aCartItem].
		].
	
	itemToRemove second >= anAmount.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:31:56' prior: 50946027!
assertCartCanRemove: anAmount ofItem: aBook

	| itemToRemove |
	
	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue:[itemToRemove := aCartItem].
		].
	
	itemToRemove second >= anAmount.! !

4>= 5!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:32:55' prior: 50946036!
assertCartCanRemove: anAmount ofItem: aBook

	| itemToRemove |
	
	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue:[itemToRemove := aCartItem].
		].
	
	(itemToRemove second >= anAmount) ifFalse: [self error: self class errorCannotRemoveMoreItemsThanWhatTheCartHas].! !

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:33:00'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:33:02'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 19:37:56'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:38:08'!
test10

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	
	self should: [
		carrito remove: smalltalk80 amount: 450.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveMoreItemsThanWhatTheCartHas.
			].
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:42:30'!
test10NotRemovingEnoughOfAnItemWillLeaveRemainsInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	
	self should: [
		carrito remove: smalltalk80 amount: 450.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveMoreItemsThanWhatTheCartHas.
			].
	
	
	! !

!methodRemoval: CartTest #test10 stamp: 'G.L.S 7/6/2021 19:42:34'!
test10

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	
	self should: [
		carrito remove: smalltalk80 amount: 450.
		]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [
			:anError |
			self assert: anError messageText equals: Cart errorCannotRemoveMoreItemsThanWhatTheCartHas.
			].
	
	
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:43:07' prior: 50946109!
test10NotRemovingEnoughOfAnItemWillLeaveRemainsInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito remove: smalltalk80 amount: 19.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:43:30'!
test10RemovingAnItemTakesItOutOfTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito remove: smalltalk80 amount: 19.
	
	
	! !

!methodRemoval: CartTest #test10NotRemovingEnoughOfAnItemWillLeaveRemainsInTheCart stamp: 'G.L.S 7/6/2021 19:43:30'!
test10NotRemovingEnoughOfAnItemWillLeaveRemainsInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito remove: smalltalk80 amount: 19.
	
	
	!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 19:44:06' prior: 50946147!
test10RemovingAnItemTakesItOutOfTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito remove: smalltalk80.
	
	self deny: (carrito isBookInCart: smalltalk80).
	
	
	! !

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/6/2021 19:44:07'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:44:26' prior: 50946008!
remove: aBook amount: anAmount

	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	""! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:45:17' prior: 50946046!
assertCartCanRemove: anAmount ofItem: aBook

	((self cartItemForBook: aBook) second >= anAmount) ifFalse: [self error: self class errorCannotRemoveMoreItemsThanWhatTheCartHas].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:45:39'!
cartItemForBook: aBook

	cartItems do: [:aCartItem | 
		(aCartItem includes: aBook) ifTrue:[^aCartItem].
		].
	
	^nil.! !

p := OrderedCollection new.!

p add: 75.!

 75 !

 75 !

 75 !

 75 !

 75 !

p !

p add: 75.!

p add: 75.!

p add: 75.!

p add: 75.!

p add: 75.!

p add: 75.!

p add: 75.!

p !

p remove: 75.!

p!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p remove: 75.!

p add: 75.!

p add: 75.!

p add: 75.!

p remove: 75.!

p remove: 75.!

p!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 19:53:12' prior: 50946179!
remove: aBook amount: anAmount

	| itemToRemove |
	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	itemToRemove := self cartItemForBook: aBook.
	
	cartItems remove: itemToRemove! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 20:01:41' prior: 50946214!
remove: aBook amount: anAmount

	| itemToRemove |
	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	itemToRemove := self cartItemForBook: aBook.
	
	cartItems remove: itemToRemove.! !

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/6/2021 20:01:51'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/6/2021 20:01:54'!
PASSED!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 20:03:30' prior: 50865715!
add: aBook amount: anAmount 
	| tuplaLibroCant |
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	cartItems add: tuplaLibroCant.! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 20:04:19'!
test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito remove: smalltalk80.
	
	self deny: (carrito isBookInCart: smalltalk80).
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 20:04:35' prior: 50946282!
test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 10.
	carrito remove: smalltalk80.
	
	self assert: (carrito isBookInCart: smalltalk80).
	
	
	! !

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/6/2021 20:04:39'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 20:06:34' prior: 50946224!
remove: aBook amount: anAmount

	| itemToRemove |
	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	itemToRemove := self cartItemForBook: aBook.
	
	(itemToRemove second - 1) <= 0 
		ifTrue: [
			cartItems remove: itemToRemove.
			]
		ifFalse:[
			itemToRemove at:2 put: (itemToRemove second - 1)
			].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 20:06:36' prior: 50946308!
remove: aBook amount: anAmount

	| itemToRemove |
	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	itemToRemove := self cartItemForBook: aBook.
	
	(itemToRemove second - 1) <= 0 
		ifTrue: [
			cartItems remove: itemToRemove.
			]
		ifFalse:[
			itemToRemove at:2 put: (itemToRemove second - 1).
			].! !

p!

p add: 75.!

p add: 75.!

p add: 75.!

p!

p at: 2!

p at: 2 put: 10!

p at: 2 put: 10!

p!

p at: 2 put: 10!

p at: 2 put: 10!

p at: 2 put: 10!

p at: 2 put: 10!

p at: 2 put: 10!

p at: 2 put: 10!

p.!

p at: 1 put: 50.!

p.!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 20:08:02' prior: 50946322!
remove: aBook amount: anAmount

	| itemToRemove |
	self assertBookInCart: aBook.
	self assertCartCanRemove: anAmount ofItem: aBook.
	
	itemToRemove := self cartItemForBook: aBook.
	
	(itemToRemove second - anAmount) = 0 
		ifTrue: [
			cartItems remove: itemToRemove.
			]
		ifFalse:[
			itemToRemove at:2 put: (itemToRemove second - anAmount).
			].! !

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/6/2021 20:08:08'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/6/2021 20:08:10'!
PASSED!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 20:41:32' prior: 50944259!
createCheckoutButton
	
	checkOutCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #checkoutCart
								label: 'Checkout'.
	
	checkOutCartButton layoutSpec proportionalWidth: 0.8.
	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 20:41:40' prior: 50944278!
createLogoutButton
	
	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	logoutButton layoutSpec proportionalWidth: 0.8.
	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 20:41:42' prior: 50946416!
createLogoutButton
	
	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	
	logoutButton layoutSpec proportionalWidth: 0.8.
	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 20:41:52' prior: 50944239!
createRemoveFromCartButton

	removeFromCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #removeSelectedItemFromCart
								label: 'Remove from cart'.	

	removeFromCartButton layoutSpec proportionalWidth: 0.8.
	
	! !
!LibrosClientCartWindow methodsFor: 'Interface Creation' stamp: 'G.L.S 7/6/2021 20:42:07' prior: 50944213!
createAddToCartButton
	
	addToCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #addSelectedItemToCart
								label: 'Add to cart'.	
	
	addToCartButton layoutSpec proportionalWidth: 0.8.! !

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:31:15'!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 10.
	carrito remove: smalltalk80.
	
	self assert: (carrito isBookInCart: smalltalk80).
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:31:34' prior: 50946470!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	carrito remove: smalltalk80 amount: 2.
	
	self assert: (carrito isBookInCart: smalltalk80).
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:31:41' prior: 50946481!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito |
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	carrito remove: smalltalk80 amount: 2.
	
	self deny: (carrito isBookInCart: smalltalk80).
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:32:14' prior: 50946493!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	carrito remove: smalltalk80 amount: 2.
	
	self deny: (carrito isBookInCart: smalltalk80).
	self assert: #No equals: huboError.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:32:47' prior: 50946505!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	
	[carrito remove: smalltalk80 amount: 2.] 
		on: Error 
		do: []. 
	
	self deny: (carrito isBookInCart: smalltalk80).
	self assert: #No equals: huboError.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/6/2021 21:32:55' prior: 50946519!
test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	
	[carrito remove: smalltalk80 amount: 2.] 
		on: Error 
		do: [huboError := #Si]. 
	
	self deny: (carrito isBookInCart: smalltalk80).
	self assert: #No equals: huboError.
	
	
	! !

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/6/2021 21:32:57'!
FAILURE!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/6/2021 22:00:32'!
FAILURE!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:01:41' prior: 50946271!
add: aBook amount: anAmount 
	
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	(self isBookInCart: aBook)
		ifTrue: []
		ifFalse: [self addNewBook: aBook amount: anAmount].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:02:02'!
addNewBook: aBook amount: anAmount
	
	| tuplaLibroCant |
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	cartItems add: tuplaLibroCant.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:02:06' prior: 50946566!
addNewBook: aBook amount: anAmount
	
	| tuplaLibroCant |
	
	tuplaLibroCant := OrderedCollection new.
	tuplaLibroCant add: aBook.
	tuplaLibroCant add: anAmount.
	
	cartItems add: tuplaLibroCant.! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:02:31' prior: 50946557!
add: aBook amount: anAmount 
	
	
	self assertBookIsAllowed: aBook.
	self assertAmountIsValid: anAmount.
	
	(self isBookInCart: aBook)
		ifTrue: [self increaseAmountOf: aBook by: anAmount]
		ifFalse: [self addNewBook: aBook amount: anAmount].! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:02:42'!
increaseAmountOf: aBook by: anAmount

	! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:03:14' prior: 50946594!
increaseAmountOf: aBook by: anAmount

	| itemToIncrease |
	itemToIncrease := self cartItemForBook: aBook.
	
	itemToIncrease! !
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/6/2021 22:03:35' prior: 50946598!
increaseAmountOf: aBook by: anAmount

	| itemToIncrease |
	
	itemToIncrease := self cartItemForBook: aBook.
	
	itemToIncrease at:2 put: (itemToIncrease second + anAmount).! !

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/6/2021 22:03:43'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/6/2021 22:03:45'!
PASSED!

----QUIT----(6 July 2021 22:09:53) CuisUniversity-4532.image priorSource: 19599453!

----STARTUP---- (7 July 2021 12:38:23) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:48:09'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 15:48:10'!
PASSED!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 15:51:38'!
createDefaultNameCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 15:54:13' prior: 50946727!
createDefaultNameCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> ''.
	catalog add: designPatterns -> ''.
	catalog add: objectThinking -> ''.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 15:55:36' prior: 50946737!
createDefaultNameCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 'SMALLTALK-80'.
	catalog add: designPatterns -> ''.
	catalog add: objectThinking -> ''.
	
	^catalog! !

!methodRemoval: StoreObjectFactory #createDefaultNameCatalog stamp: 'G.L.S 7/7/2021 15:56:45'!
createDefaultNameCatalog

	| catalog |
	
	catalog := Dictionary new.
	catalog add: smalltalk80 -> 'SMALLTALK-80'.
	catalog add: designPatterns -> ''.
	catalog add: objectThinking -> ''.
	
	^catalog!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 15:57:17' prior: 50924927!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50."
	
	catalog add: smalltalk80 -> Dictionary new.
	catalog add: designPatterns -> Dictionary new.
	catalog add: objectThinking -> Dictionary new.
	
	^catalog! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/7/2021 15:57:21'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/7/2021 15:57:22'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/7/2021 15:57:22'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/7/2021 15:57:22'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/7/2021 15:57:22'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 15:57:22'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/7/2021 15:57:33'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 15:58:15'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 15:59:02' prior: 50872585 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := StoreObjectFactory new createDefaultCatalog
	"Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50."! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 15:59:03' prior: 50946899 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := StoreObjectFactory new createDefaultCatalog
	
	"Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50."! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:00:04' prior: 50946766!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50."
	
	catalog add: smalltalk80 -> Dictionary new.
	(catalog at: smalltalk80) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: smalltalk80) at: 'precio' put: 10.
	
	catalog add: designPatterns -> Dictionary new.
	catalog add: objectThinking -> Dictionary new.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:01:09' prior: 50946927!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50."
	
	catalog add: smalltalk80 -> Dictionary new.
	(catalog at: smalltalk80) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: smalltalk80) at: 'precio' put: 10.
	
	catalog add: designPatterns -> Dictionary new.
	(catalog at: designPatterns) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: designPatterns) at: 'precio' put: 100.
	
	catalog add: objectThinking -> Dictionary new.
	(catalog at: objectThinking) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: objectThinking) at: 'precio' put: 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:01:45' prior: 50946945!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50."
	
	catalog add: smalltalk80 -> Dictionary new.
	(catalog at: smalltalk80) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: smalltalk80) at: 'precio' put: 10.
	
	catalog add: designPatterns -> Dictionary new.
	(catalog at: designPatterns) at: 'nombre' put: 'The Design Patterns Smalltalk Companion'.
	(catalog at: designPatterns) at: 'precio' put: 100.
	
	catalog add: objectThinking -> Dictionary new.
	(catalog at: objectThinking) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: objectThinking) at: 'precio' put: 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:02:26' prior: 50946970!
createDefaultCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: smalltalk80 -> 10.
	catalog add: designPatterns -> 100.
	catalog add: objectThinking -> 50."
	
	catalog add: smalltalk80 -> Dictionary new.
	(catalog at: smalltalk80) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: smalltalk80) at: 'precio' put: 10.
	
	catalog add: designPatterns -> Dictionary new.
	(catalog at: designPatterns) at: 'nombre' put: 'The Design Patterns Smalltalk Companion'.
	(catalog at: designPatterns) at: 'precio' put: 100.
	
	catalog add: objectThinking -> Dictionary new.
	(catalog at: objectThinking) at: 'nombre' put: 'Object Thinking'.
	(catalog at: objectThinking) at: 'precio' put: 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:03:04' prior: 50925053!
createSingleItemCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: donQuixote -> 50."
	
	catalog add: donQuixote -> Dictionary new.
	
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:03:24' prior: 50947022!
createSingleItemCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: donQuixote -> 50."
	
	catalog add: donQuixote -> Dictionary new.
	(catalog at: donQuixote) at: 'nombre' put: 'SMALLTALK-80'.
	(catalog at: donQuixote) at: 'precio' put: 50.
	
	^catalog! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:03:44' prior: 50947031!
createSingleItemCatalog

	| catalog |
	
	catalog := Dictionary new.
	"catalog add: donQuixote -> 50."
	
	catalog add: donQuixote -> Dictionary new.
	(catalog at: donQuixote) at: 'nombre' put: 'Don Quixote (Don Quijote de la Mancha)'.
	(catalog at: donQuixote) at: 'precio' put: 50.
	
	^catalog! !

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 16:04:05'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:04:13' prior: 50946913 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := StoreObjectFactory new createDefaultCatalog.
	
	"Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50."! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:05:06'!
test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80.
	carrito add: smalltalk80.
	
	[carrito remove: smalltalk80 amount: 2.] 
		on: Error 
		do: [huboError := #Si]. 
	
	self deny: (carrito isBookInCart: smalltalk80).
	self assert: #No equals: huboError.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:05:36' prior: 50947110!
test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito add: objectThinking amount: 3.
	
	self assert: #No equals: huboError.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:06:22' prior: 50947126!
test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice

	| carrito huboError |
	
	huboError := #No.
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito add: objectThinking amount: 3.
	
	self assert: 350 equals: carrito totalItemPrice.
	
	
	! !
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:06:29' prior: 50947138!
test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice

	| carrito |
	
	carrito := Cart createNewWithCatalog: catalog1.
	carrito add: smalltalk80 amount: 20.
	carrito add: objectThinking amount: 3.
	
	self assert: 350 equals: carrito totalItemPrice.
	
	
	! !

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/7/2021 16:06:32'!
ERROR!
!Cart methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 16:07:11' prior: 50865708!
totalItemPrice
	
	^cartItems sum: [:bookAmountTuple | ((catalog at: bookAmountTuple first) at:'precio') * bookAmountTuple second].! !

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/7/2021 16:07:44'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/7/2021 16:07:47'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/7/2021 16:07:51'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/7/2021 16:07:51'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/7/2021 16:07:51'!
ERROR!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/7/2021 16:07:51'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/7/2021 16:07:51'!
ERROR!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/7/2021 16:07:51'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/7/2021 16:07:51'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/7/2021 16:07:51'!
FAILURE!

!classDefinition: #CashierTest category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 16:08:29'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'smalltalk80 designPatterns objectThinking catalog1 emptyCatalog catalog2 donQuixote workingCreditCard expiredCreditCard sales stolenCreditCard merchantProcessor fakeCreditCard creditCardWithoutMoney listToAdd emptyListToAdd listToAdd2 storeFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:08:28' prior: 50869873 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := 
	"Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50."
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:08:49' prior: 50947268 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	"Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50."
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:09:10' prior: 50947321 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:09:21' prior: 50947375 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	emptyListToAdd := storeFactory createEmptyCatalog.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/7/2021 16:09:30'!
PASSED!
!CashierTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:09:54' prior: 50947425 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	sales := OrderedCollection new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	emptyCatalog := storeFactory createEmptyCatalog.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	emptyListToAdd := Dictionary new.
	
	listToAdd := Dictionary new.
	listToAdd add: donQuixote -> 1.
	
	listToAdd2 := Dictionary new.
	listToAdd2 add: smalltalk80 -> 3.
	listToAdd2 add: designPatterns -> 5.
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	expiredCreditCard := CreditCard forOwner: 'Jorge' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate yesterday.
	stolenCreditCard := CreditCard forOwner: 'Gervasio' withNumber: '1234567891011120' withExpirationDate: FixedGregorianDate tomorrow.
	fakeCreditCard := CreditCard  forOwner: 'Pepe' withNumber: '1000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	creditCardWithoutMoney := CreditCard  forOwner: 'Ivan' withNumber: '1200000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerStolenCard: stolenCreditCard.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	merchantProcessor registerCard: creditCardWithoutMoney withBalance: 0.	! !

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/7/2021 16:09:56'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/7/2021 16:10:04'!
PASSED!
!CartTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 16:10:47' prior: 50947097 overrides: 16927572!
setUp

	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := StoreObjectFactory new createDefaultCatalog.! !

!classDefinition: #MockRestInterfaceTest category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 16:11:19'!
TestCase subclass: #MockRestInterfaceTest
	instanceVariableNames: 'mockInterface userData sales smalltalk80 designPatterns objectThinking donQuixote emptyCatalog catalog1 catalog2 workingCreditCard merchantProcessor timer storeFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 7/7/2021 16:11:17' prior: 50929868 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := Dictionary new.
	catalog1 add: smalltalk80 -> 10.
	catalog1 add: designPatterns -> 100.
	catalog1 add: objectThinking -> 50.
	
	catalog2 := Dictionary new.
	catalog2 add: donQuixote -> 50.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 7/7/2021 16:11:42' prior: 50947652 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 7/7/2021 16:11:45' prior: 50947688 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 16:11:49'!
PASSED!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 16:12:33' prior: 50945486!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
	
	catalog keysDo: [:key |
		storeItemList add: key, ' - ', (catalog at: key).
		].
! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 16:12:47' prior: 50947802!
prepareStoreItemList
	
	storeItemList := OrderedCollection new.
	
	catalog keysDo: [:key |
		storeItemList add: key, ' - ', ((catalog at: key) at:'nombre').
		].
! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:22:50' prior: 50944762!
addSelectedItemToCart
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:24:50' prior: 50947842!
addSelectedItemToCart
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: '']
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:24:56' prior: 50947854!
addSelectedItemToCart
	
	
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: '']
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:26:08' prior: 50947865!
addSelectedItemToCart
	
	| amount |
	amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: '']
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:26:18' prior: 50947876!
addSelectedItemToCart
	
	| amount |
	
	amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: amount]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:27:02' prior: 50947890!
addSelectedItemToCart
	
	| amount |
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: amount]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !

''=''!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:27:39' prior: 50947904!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ''.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: '' amount: amount]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:27:48' prior: 50947921!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ''.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:28:51' prior: 50947938!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.! !

'asbsdsdadasd' copyUpTo: $-.!

'asbsdsd        -       adasd' copyUpTo: $-.!

('asbsdsd        -       adasd' copyUpTo: $-) withoutSeparators.!

('asbsdsd-adasd' copyUpTo: $-) withoutSeparators.!

('asbsdsd-adasd' copyUpTo: $-) withoutSeparators.!

('asbsdsd-adasd' copyUpTo: $-) withoutSeparators.!

('asbsdsd-adasd' copyUpTo: $-) withoutSeparators.!

('asbsdsd-adasd' copyUpTo: $-) withoutSeparators.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:30:57' prior: 50947955!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #successfullyAddedItemToCart with: self.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 16:32:21' prior: 50945108!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."
	
	"do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #successfullyAddedItemToCart with: self."! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 16:32:57' prior: 50948006!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."
	
	"do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #successfullyAddedItemToCart with: self."! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:33:11' prior: 50947987!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:34:35' prior: 50948076!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:34:53' prior: 50948098!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	"CONTROLAR QUE SE PUEDA CALCULAR ISBN".
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:34:54' prior: 50948118!
addSelectedItemToCart
	
	| amount isbn |
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	"CONTROLAR QUE SE PUEDA CALCULAR ISBN"
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:35:51'!
sendAddToCartRequestWithCart: aSmallInteger bookISBN: aString amount: aSmallInteger3 
	self shouldBeImplemented.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:36:24' prior: 50943700!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: ["TERMINAR AAAAAAAAAAAAAAAAAAAAA"]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:36:46' prior: 50948171!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [self shouldBeImplemented]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:39:10' prior: 50948164!
sendAddToCartRequestWithCart: aCartId bookISBN: aString amount: aSmallInteger3 
	self shouldBeImplemented.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:39:16' prior: 50948202!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: aSmallInteger3 
	self shouldBeImplemented.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:39:20' prior: 50948209!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	self shouldBeImplemented.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:39:29' prior: 50948216!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:40:48' prior: 50948223!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [self shouldBeImplemented]
		ifFalse: [^self error: resp content].
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:41:02' prior: 50948229!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/addToCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [self shouldBeImplemented]
		ifFalse: [^self error: resp content].
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:41:12' prior: 50948246!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/addToCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:42:58' prior: 50948263!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/addToCart') fields: fieldsDict.
	
	resp isSuccess
		ifFalse: [^self error: resp content].
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:43:07' prior: 50948279!
sendAddToCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount 
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/addToCart') fields: fieldsDict.
	
	resp isSuccess ifFalse: [^self error: resp content].
	! !
!LibrosClientCartWindow methodsFor: 'nil' stamp: 'G.L.S 7/7/2021 16:44:10'!
refreshCartList
	
	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:44:26' prior: 50948310!
refreshCartList
	
	self model ! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:44:40'!
listCart! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:44:41' prior: 50948319!
listCart
	
	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:44:53' prior: 50948315!
refreshCartList
	
	self model listCart.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:44:54' prior: 50948327!
refreshCartList
	
	self model listCart.
	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:45:53' prior: 50948332!
refreshCartList
	
	self model listCart.
	cartItemsList updateList.
	cartItemsList setSelectionIndex: 0.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:45:57' prior: 50948337!
refreshCartList
	
	self model listCart.
	
	cartItemsList updateList.
	cartItemsList setSelectionIndex: 0.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:47:10'!
sendListCartFor: aCartId

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [self shouldBeImplemented]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:49:36' prior: 50948323!
listCart

	[restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:50:21' prior: 50948363!
listCart

	[cartItemList := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:52:52' prior: 50948372!
listCart

	| listToDecode |
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList  := listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:52:58' prior: 50948381!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList  := listToDecode.
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 16:53:49' prior: 50948350!
sendListCartFor: aCartId

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	
	resp := WebClient htmlSubmit: (self url, '/listCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [self shouldBeImplemented]
		ifFalse: [^self error: resp content].
	
	! !

c _ '0|pepe|1|carlos|2|jorge|14'!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:56:24' prior: 50948392!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList  := listToDecode.
	
	! !

d _ c copyFrom: 2.!

d _ c copyFrom: 2.!

d!

d _ c copyFrom: '0|'.!

d!

d!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

d _ c copyFrom: '0|'.!

d.!

d _ c copyFrom: 2.!

d _ c copyFrom: 2.!

d _ c copyFrom: 2.!

d.!

d _ c copyFrom: 2 to: c size.!

d _ c copyFrom: 2 to: c size.!

d _ c copyFrom: 2 to: c size.!

d _ c copyFrom: 2 to: c size.!

d _ c copyFrom: 2 to: c size.!

d.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

d.!

d _ c copyFrom: 2 to: c size.!

d.!

d _ c copyFrom: 3 to: c size.!

d.!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 16:59:20' prior: 50948417!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	listToDecode := listToDecode copyFrom: 3 to: listToDecode size. 
	
	cartItemList  := ''.
	
	! !

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ c copyFrom: 3 to: c size.!

c.!

c copyReplaceAll: '|' with: ' - '.!

c!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ c copyFrom: 3 to: c size.!

c _ c copyFrom: 3 to: c size.!

c _ c copyFrom: 3 to: c size.!

c _ c copyFrom: 3 to: c size.!

c _ c copyFrom: 3 to: c size.!

c _ c copyReplaceAll: '|' with: ' - '.!

c.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ c copyFrom: 3 to: c size.!

c _ c copyReplaceAll: '|' with: ' - '.!

c.!

d _ ''.!

c _ '0|pepe|1|carlos|2|jorge|14'.!

c _ c copyFrom: 3 to: c size.!

c !

c _ 'pepe|1|carlos|2|jorge|14'.!

c _ 'pepe|1|carlos|2|jorge|14'.!

c _ 'pepe|1|carlos|2|jorge|14'.!

c!

c _ c copyUpTo: $-.!

c _ c copyUpTo: $|.!

c _ c copyUpTo: $|.!

 'pepe' !

 'pepe' !

c _ c copyUpTo: $|.!

c _ 'pepe|1|carlos|2|jorge|14'.!

c _ 'pepe|1|carlos|2|jorge|14'.!

c!

d _ c copyUpTo: $|.!

d!

c!

c _ c copyAfter: $|.!

c!

c _ c copyAfter: $|.!

c _ c copyAfter: $|.!

c _ c copyAfter: $|.!

c _ c copyAfter: $|.!

c _ c copyAfter: $|.!

c _ 'pepe|1|carlos|2|jorge|14'.!

(c = '')!

arr _ OrderedCollection new.!

c _ 'pepe|1|carlos|2|jorge|14'.!

(c = '') whileFalse: [
	d _ ''.
	d _ c copyUpTo: $|.
	c _ c copyAfter: $|.
	d _ d, ' - ', c copyUpTo: $|.
	c _ c copyAfter: $|.
	
	arr add: d.
	].!

c _ 'pepe|1|carlos|2|jorge|14'.!

[c = ''] whileFalse: [
	d _ ''.
	d _ c copyUpTo: $|.
	c _ c copyAfter: $|.
	d _ d, ' - ', c copyUpTo: $|.
	c _ c copyAfter: $|.
	
	arr add: d.
	].!

arr!
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:10:32' prior: 50948453!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	listToDecode := listToDecode copyFrom: 3 to: listToDecode size. 
	cartItemList  := OrderedCollection new.
	
	[listToDecode = ''] whileFalse: [ | d |
		d _ ''.
		d _ listToDecode copyUpTo: $|.
		listToDecode _ listToDecode copyAfter: $|.
		d _ d, ' - ', listToDecode copyUpTo: $|.
		listToDecode _ listToDecode copyAfter: $|.
		
		cartItemList add: d.
	].
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:10:43' prior: 50948531!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	listToDecode := listToDecode copyFrom: 3 to: listToDecode size. 
	cartItemList  := OrderedCollection new.
	
	[listToDecode = ''] whileFalse: [ | tempString |
		tempString _ ''.
		tempString _ listToDecode copyUpTo: $|.
		listToDecode _ listToDecode copyAfter: $|.
		tempString _ tempString, ' - ', listToDecode copyUpTo: $|.
		listToDecode _ listToDecode copyAfter: $|.
		
		cartItemList add: tempString.
	].
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:11:28' prior: 50948552!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:12:49'!
decodeCartItemsList: listToDecode
	
	| decodedList listToDecodeCopy |
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString |
		tempString _ ''.
		tempString _ listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		tempString _ tempString, ' - ', listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		
		decodedList add: tempString.
	].

	^decodedList
	
	! !
!LibrosClientModel methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:13:01' prior: 50948586!
decodeCartItemsList: listToDecode
	
	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString |
		tempString _ ''.
		tempString _ listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		tempString _ tempString, ' - ', listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		
		decodedList add: tempString.
	].

	^decodedList.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self model!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:18:23' prior: 50948139!
addSelectedItemToCart
	
	| amount isbn |
	
	self halt.
	
	isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.
	"CONTROLAR QUE SE PUEDA CALCULAR ISBN"
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:20:04' prior: 50948634!
addSelectedItemToCart
	
	| amount isbn |
	
	self halt.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[0] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 17:20:55' prior: 50948040!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
		
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."
	
	"do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #successfullyAddedItemToCart with: self."! !

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:21:53' prior: 50948661!
addSelectedItemToCart
	
	| amount isbn |
	
	self halt.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:23:30' prior: 50948724!
addSelectedItemToCart
	
	| amount isbn |
	
	"self halt."
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:23:45' prior: 50948344!
refreshCartList
	
	self halt.
	
	self model listCart.
	
	cartItemsList updateList.
	cartItemsList setSelectionIndex: 0.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self model!
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:25:02' prior: 50948782!
refreshCartList
	
	self model listCart.
	
	cartItemsList updateList.
	cartItemsList setSelectionIndex: 0.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:25:16' prior: 50948759!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:25:22' prior: 50948575!
listCart

	| listToDecode |
	
	self halt.
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:31:41' prior: 50948402!
sendListCartFor: aCartId

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	
	resp := WebClient htmlSubmit: (self url, '/listCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: []
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:32:26' prior: 50948839!
sendListCartFor: aCartId

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	
	resp := WebClient htmlSubmit: (self url, '/listCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:33:15' prior: 50948824!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 17:35:35' prior: 50948606!
decodeCartItemsList: listToDecode
	
	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ' listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		
		decodedList add: tempString.
	].

	^decodedList.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 17:35:44' prior: 50948882!
decodeCartItemsList: listToDecode
	
	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		
		decodedList add: tempString.
	].

	^decodedList.
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 17:39:53' prior: 50948684!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	
	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:40:41'!
showISBNCalculationError
	self shouldBeImplemented.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:41:30' prior: 50948954!
showISBNCalculationError
	LibrosClientErrorWindow contents: 'Error - Hubo un error calculando el ISBN, quizá no está selecionado un libro'.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:41:50'!
showAddToCartError
	self shouldBeImplemented.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:42:12' prior: 50948968!
showAddToCartError
	LibrosClientErrorWindow contents: 'Error - No se pudo agregar el elemento al carrito'.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:42:59'!
showAmountCalculationError
	self shouldBeImplemented.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 17:47:11' prior: 50948980!
showAmountCalculationError
	LibrosClientErrorWindow contents: 'Error - No se pudo calcular la cantidad de libros a agregar, verifique que sea un número'.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:48:38' prior: 50944767!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:49:23' prior: 50948994!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:57:55' prior: 50949016!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 17:58:41' prior: 50949038!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 17:59:01' prior: 50948928!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #refreshCartList to: self.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 17:59:14' prior: 50949083!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:00:00'!
sendRemoveFromCartRequestWithCart: aCartId bookISBN: aISBN amount: anAmount
	
	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'bookIsbn' put: aISBN.
	fieldsDict at: 'bookQuantity' put: anAmount.
	
	resp := WebClient htmlSubmit: (self url, '/removeFromCart') fields: fieldsDict.
	
	resp isSuccess ifFalse: [^self error: resp content].
	! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/7/2021 18:00:27'!
startRemoveFromCartService

	self addInterfaceService: '/addToCart' withAction: [
		:request | 
		|cartId bookIsbn bookQuantity result| 
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/7/2021 18:00:36' prior: 50949152!
startRemoveFromCartService

	self addInterfaceService: '/removeFromCart' withAction: [
		:request | 
		|cartId bookIsbn bookQuantity result| 
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface add: bookQuantity ofItem: bookIsbn toCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		].! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:03:35'!
test04CannotRemoveFromUnexistentCart

	self testFail: [mockInterface remove: 17 ofItem: smalltalk80 toCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:03:48'!
test14CannotRemoveFromUnexistentCart

	self testFail: [mockInterface remove: 17 ofItem: smalltalk80 toCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!methodRemoval: MockRestInterfaceTest #test04CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:03:48'!
test04CannotRemoveFromUnexistentCart

	self testFail: [mockInterface remove: 17 ofItem: smalltalk80 toCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:03:51'!
ERROR!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:04:06'!
remove: aSmallInteger ofItem: aString toCart: aSmallInteger3 
	self shouldBeImplemented.! !

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:04:08'!
FAILURE!
!MockRestInterface methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:04:21' prior: 50949222!
remove: aSmallInteger ofItem: aString toCart: aSmallInteger3 
	
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:04:49' prior: 50949232!
remove: aSmallInteger ofItem: aString toCart: aCartID 
	
	| cart |
	cart := self cartForId: aCartID.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:05:05' prior: 50949238!
remove: anAmount ofItem: aBook toCart: aCartID 
	
	| cart |
	cart := self cartForId: aCartID.
	! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:05:21'!
remove: anAmount ofItem: aBook fromCart: aCartID 
	
	| cart |
	cart := self cartForId: aCartID.
	! !
!MockRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:05:21' prior: 50949201!
test14CannotRemoveFromUnexistentCart

	self testFail: [mockInterface remove: 17 ofItem: smalltalk80 fromCart: 0] withErrorMessage: MockRestInterface errorCartIdDoesNotExist.! !

!methodRemoval: MockRestInterface #remove:ofItem:toCart: stamp: 'G.L.S 7/7/2021 18:05:21'!
remove: anAmount ofItem: aBook toCart: aCartID 
	
	| cart |
	cart := self cartForId: aCartID.
	!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:05:44' prior: 50949251!
remove: anAmount ofItem: aBook fromCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	
	cart remove: aBook amount: anAmount.! !

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:05:51'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:12:16'!
test15AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	[mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:12:30'!
test15RemovingItemsFromCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	[mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !

!methodRemoval: MockRestInterfaceTest #test15AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:12:30'!
test15AddingItemsToCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	[mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:13:20' prior: 50949304!
test15RemovingItemsFromCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface remove: 17 ofItem: smalltalk80 fromCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self deny: (cartList) isEmpty.
	self assert: smalltalk80 equals: cartList first first.
	self assert: 17 equals: cartList first second.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:13:38' prior: 50949346!
test15RemovingItemsFromCartWorksAsExpected

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface remove: 17 ofItem: smalltalk80 fromCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self assert: (cartList) isEmpty.
	! !

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:13:39'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 18:14:40' prior: 50930051!
test11CannotUseACartAfterItExpired

	| password usuario cartId |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	mockInterface listCart: cartId.
	
	timer passTime: 35.
	
	self testFail: [mockInterface add: 17 ofItem: smalltalk80 toCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface remove: 17 ofItem: smalltalk80 fromCart: cartId] withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface listCart: cartId]  withErrorMessage: MockRestInterface errorCartExpired.
	
	self testFail: [mockInterface checkOutCart: cartId 
				withCreditCard: '0000000000000000' 
				withExpirationDate: FixedGregorianDate tomorrow 
				withOwner: 'Marco'] 
		withErrorMessage: MockRestInterface errorCartExpired.
	
! !

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 18:14:47'!
FAILURE!
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:15:17' prior: 50949273!
remove: anAmount ofItem: aBook fromCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart remove: aBook amount: anAmount.
	
	self updateCartTimerFor: aCartID.! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 18:15:30' prior: 50949484!
remove: anAmount ofItem: anItemID fromCart: aCartID 
	
	| cart |
	
	cart := self cartForId: aCartID.
	
	self assertCartTimerDidNotExpireFor: aCartID.
	
	cart remove: anItemID amount: anAmount.
	
	self updateCartTimerFor: aCartID.! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/7/2021 18:15:34'!
PASSED!
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/7/2021 18:16:00' prior: 50949170!
startRemoveFromCartService

	self addInterfaceService: '/removeFromCart' withAction: [
		:request | 
		|cartId bookIsbn bookQuantity result| 
			cartId := (request fields at:'cartId') asNumber.
			bookIsbn := (request fields at:'bookIsbn').
			bookQuantity := (request fields at:'bookQuantity') asNumber.
			
			mockInterface remove: bookQuantity ofItem: bookIsbn fromCart: cartId.
			
        			result := WebUtils jsonEncode: ('0|', 'OK').
    			request send200Response: result.
		].! !
!LibrosServer methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 18:16:30' prior: 50929192!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	self startAddToCartService.
	self startRemoveFromCartService.
	self startListCartService.
	self startCheckOutCartService.
	self startListPurchasesService.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 18:17:17' prior: 50949110!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:22:02' prior: 50949060!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'private' stamp: 'G.L.S 7/7/2021 18:31:32' prior: 50948795!
refreshCartList
	
	self model listCart.
	
	cartItemsList updateList.
	"cartItemsList setSelectionIndex: 0."! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 18:35:46' prior: 50949597!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:35:59' prior: 50944772!
checkoutCart
	self shouldBeImplemented.
	
	"#checkoutSuccessful"! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:36:21' prior: 50949706!
checkoutCart

	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:39:03' prior: 50949711!
checkoutCart
	
	[restInterface sendCheckOutRequestFor: cartId creditCardNumber: '' creditCardExpiration: '' creditCardOwner: '']
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:43:56' prior: 50949717!
checkoutCart
	
	| checkoutId |
	[checkoutId := restInterface sendCheckOutRequestFor: cartId creditCardNumber: '' creditCardExpiration: '' creditCardOwner: '']
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:46:08' prior: 50949729!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId creditCardNumber: '' creditCardExpiration: '' creditCardOwner: '']
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 18:46:32'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 18:46:39' prior: 50945460 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	catalog := storeFactory  createDefaultCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 18:46:41' prior: 50949768 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	catalog := storeFactory createDefaultCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:49:52'!
createDefaultCreditCardOwner
	
	^'Marco'.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:50:07'!
createDefaultCreditCardNumber

	^'0000000000000000'! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 18:50:23'!
createDefaultCreditCardExpirationDate

	^FixedGregorianDate tomorrow.! !

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 18:58:55' prior: 50949742!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId 
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 19:14:52'!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 19:15:13' prior: 50949834!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 19:15:21' prior: 50949872!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	
	! !
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 7/7/2021 19:33:24' prior: 50947721 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := Dictionary new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 19:33:27'!
ERROR!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 19:33:27'!
ERROR!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 19:33:27'!
ERROR!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/7/2021 19:33:27'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 19:33:51'!
ERROR!
!MockRestInterfaceTest methodsFor: 'setUp/tearDown' stamp: 'G.L.S 7/7/2021 19:34:17' prior: 50949936 overrides: 16927572!
setUp
	
	storeFactory := StoreObjectFactory new.
	
	smalltalk80 := '9780201113723'.
	designPatterns := '9780201184624'.
	objectThinking := '9780735619654'.
	donQuixote := '9781400132171'.
	
	sales := OrderedCollection new.
	
	emptyCatalog := Dictionary new.
	
	catalog1 := storeFactory createDefaultCatalog.
	
	catalog2 := storeFactory createSingleItemCatalog.
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	timer := (MockTimer new).
	
	workingCreditCard := CreditCard forOwner: 'Marco' withNumber: '0000000000000000' withExpirationDate: FixedGregorianDate tomorrow.
	
	merchantProcessor := MockMerchantProcesor new.
	merchantProcessor registerCard: workingCreditCard withBalance: 1000.
	
	mockInterface := MockRestInterface createFor: userData withCatalog: catalog1 withTimer: timer withSalesBook: sales withMerchantProcesor: merchantProcessor.
	! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/7/2021 19:34:20'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/7/2021 19:34:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/7/2021 19:34:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/7/2021 19:34:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/7/2021 19:34:21'!
PASSED!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/7/2021 19:40:22' prior: 50940807!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	
	self deleteCart: aCartId.
	
	^transactionId.
! !
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/7/2021 19:40:29' prior: 50950117!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	self deleteCart: aCartId.
	
	^transactionId.
! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 19:41:53'!
test16

	| password usuario huboError cartId cartList |
	
	usuario := 'pepe'.
	password := '5678'.
	
	huboError := #No.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	[mockInterface remove: 17 ofItem: smalltalk80 fromCart: cartId.] 
		on: Error 
		do: [huboError := #Si].
	
	cartList := (mockInterface listCart: cartId).
	
	self assert: #No equals: huboError.
	self assert: (cartList) isEmpty.
	! !
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 19:45:55' prior: 50950172!
test16
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).! !

!methodRemoval: MockRestInterfaceTest #test16 stamp: 'G.L.S 7/7/2021 19:48:55'!
test16
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco'.
	
	self deny: (transactionId1 = transactionId2).!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 19:59:54' prior: 50949783 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	catalog := self obtainCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 20:00:05'!
obtainCatalog
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:00:53'!
getCatalog

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 20:01:32' prior: 50950247 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:02:14' prior: 50950264!
getCatalog

	| listToDecode |
	
	[listToDecode := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:02:29' prior: 50950289!
getCatalog

	| listToDecode |
	
	[listToDecode := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	"cartItemList := self decodeCartItemsList: listToDecode."
	catalog := listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:02:31' prior: 50950300!
getCatalog

	| listToDecode |
	
	[listToDecode := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	"cartItemList := self decodeCartItemsList: listToDecode."
	
	catalog := listToDecode.
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:03:13'!
sendGetCatalog

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 20:03:48'!
startGetCatalogService

	self addInterfaceService: '/getCatalog' withAction: [
		:request | 
		|cartId cartList resultString result|
			
			cartId := (request fields at:'cartId') asNumber.
			cartList := mockInterface listCart: cartId.
			
			resultString := '0|'.
			
			cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 20:04:42' prior: 50950334!
startGetCatalogService

	self addInterfaceService: '/getCatalog' withAction: [
		:request | 
		|catalog resultString result|
		
			catalog := mockInterface getCatalog.
			
			resultString := '0|'.
			
			"cartList do: [ :cartItem |
					resultString := resultString, cartItem first asString, '|'.
					resultString := resultString, cartItem second asString, '|'.
				]."
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].! !
!MockRestInterface methodsFor: 'operations' stamp: 'G.L.S 7/7/2021 20:05:02'!
getCatalog
	
	^catalog.! !

d _ Dictionary new.!

d at: 'pepe' -> 3.!

d add: 'pepe' -> 3.!

d add: 'jorge' -> 4.!

d!

WebUtils jsonEncode: d.!

e _ WebUtils jsonEncode: d.!

e!

WebUtils jsonDecode: e.!

WebUtils jsonDecode: (e content) readStream.!

WebUtils jsonDecode: e readStream.!

d _ Dictionary new.!

d _ Dictionary new.!

d add: 'pepe' -> Dictionary new.!

(d at: 'pepe') add: '1' -> 4.!

(d at: 'pepe') add: '2' -> 4.!

d add: 'jorge' -> 4.!

d!

e _ WebUtils jsonEncode: d.!

e!

WebUtils jsonDecode: e readStream. !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 20:10:48' prior: 50950355!
startGetCatalogService

	self addInterfaceService: '/getCatalog' withAction: [
		:request | 
		|catalog result|
		
			catalog := mockInterface getCatalog.
			
        			result := WebUtils jsonEncode: (catalog).
    			request send200Response: result.
		].! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:11:28' prior: 50950312!
getCatalog

	
	
	[catalog := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:11:35' prior: 50950404!
getCatalog
	
	[catalog := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #listCartFailed with: self.
		^self].
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:12:24' prior: 50950412!
getCatalog
	
	[catalog := restInterface sendGetCatalog]
	on: Error - MessageNotUnderstood
	do: [self error: self class errorCatalogCouldNotBeDownloaded].
	
	! !
!LibrosClientModel class methodsFor: 'errors' stamp: 'G.L.S 7/7/2021 20:12:59'!
errorCatalogCouldNotBeDownloaded
	^'Error - No se pudo conseguir el catalogo'.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:13:52' prior: 50950323!
sendGetCatalog

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp) readStream)]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:13:58' prior: 50950440!
sendGetCatalog

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:14:03' prior: 50950452!
sendGetCatalog

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	self halt.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self content!

librosServer destroy.!
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 20:15:15' prior: 50950393!
startGetCatalogService

	self addInterfaceService: '/getCatalog' withAction: [
		:request | 
		|catalog result|
		
			catalog := mockInterface getCatalog.
			
        			result := WebUtils jsonEncode: (catalog).
    			request send200Response: result.
		].! !
!LibrosServer methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 20:15:29' prior: 50949581!
initializeWith: aPortNumber
	
	storeOF := StoreObjectFactory new.
	
	mockInterface := storeOF createDefaultMockInterface.
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	self startCreateCartService.
	self startAddToCartService.
	self startRemoveFromCartService.
	self startGetCatalogService.
	self startListCartService.
	self startCheckOutCartService.
	self startListPurchasesService.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 20:16:02' prior: 50950464!
sendGetCatalog

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	
	resp := WebClient htmlSubmit: (self url, '/getCatalog') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:22:57' prior: 50944116 overrides: 50936705!
buildMorphicWindow
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:23:26' prior: 50950537 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:24:13'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:24:14'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:24:08' prior: 50950549 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph beColumn.
	rightLayout := LayoutMorph beColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:24:23' prior: 50950579 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph newColumn.
	rightLayout := LayoutMorph newColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:24:36'!
createPurchasesList

	""
	
	! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:26:38'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout purchacesList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:26:37' prior: 50950608!
createPurchasesList

	purchacesList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:26:54'!
createPurchacesList

	purchacesList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 20:26:54' prior: 50950594 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph newColumn.
	rightLayout := LayoutMorph newColumn.
	
	self createPurchacesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !

!methodRemoval: LibrosClientPurchasesWindow #createPurchasesList stamp: 'G.L.S 7/7/2021 20:26:54'!
createPurchasesList

	purchacesList := PluggableListMorph model: self model listGetter: #getCartItemList indexGetter: #cartItemListIndex indexSetter: #cartItemListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:27:25' prior: 50950635!
createPurchacesList

	purchacesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:28:20'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout purchacesList totalPriceLabel'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:28:16'!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: 'Total: $'.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:34:29' prior: 50950700!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: 'Total: $'.
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self contents: 'Pepe'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:35:48' prior: 50950707!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: ''.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:36:00'!
createLogoutButton

	
	
	! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:36:51'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout purchacesList totalPriceLabel logoutButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:36:49' prior: 50950724!
createLogoutButton

	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	
	logoutButton layoutSpec proportionalWidth: 0.8.

	
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:40:41'!
createCreateCartButton

	
	! !

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 20:43:24'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout purchacesList totalPriceLabel logoutButton createCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:43:22' prior: 50950749!
createCreateCartButton
	
	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:52:39'!
addPurchaseList
	
	leftLayout addMorph: (LabelMorph contents: 'Historial de compras').
	leftLayout addMorph: purchacesList.
	
	
	
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:52:42' prior: 50950775!
addPurchaseList
	
	leftLayout addMorph: (LabelMorph contents: 'Historial de compras').
	leftLayout addMorph: purchacesList.
	
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:53:10'!
addTotalPriceLabel
	
	leftLayout addMorph: totalPriceLabel.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:53:52'!
addLogoutButton
	
	rightLayout addMorph: logoutButton.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 20:54:08'!
addCreateCartButton

	rightLayout addMorph: createCartButton.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/7/2021 21:00:28'!
test16

	| password usuarioNoExistente list |
	
	usuarioNoExistente := 'pepe'.
	password := '5678'.
	
	list := mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password.
	
	self assert: list isEmpty.! !

!testRun: #MockRestInterfaceTest #test16 stamp: 'G.L.S 7/7/2021 21:00:30'!
FAILURE!

!methodRemoval: MockRestInterfaceTest #test16 stamp: 'G.L.S 7/7/2021 21:01:31'!
test16

	| password usuarioNoExistente list |
	
	usuarioNoExistente := 'pepe'.
	password := '5678'.
	
	list := mockInterface listPurchasesForUser: usuarioNoExistente withPassword: password.
	
	self assert: list isEmpty.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 21:03:36' prior: 50943622!
showPurchasesWindow
	
	self halt.
	LibrosClientPurchasesWindow withModel: self model.! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 21:04:02' prior: 50950842!
showPurchasesWindow
	
	LibrosClientPurchasesWindow withModel: self model.! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:05:17' prior: 50948187!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: (resp)]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:05:37' prior: 50950855!
sendListPurchasesRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/listPurchases') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [^WebUtils jsonDecode: ((resp content) readStream)]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:06:58' prior: 50943660!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	purchases := self decodePurchaseList: listToDecode.
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:07:28'!
createPurchasesList

	purchacesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 21:07:28' prior: 50950649 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph newColumn.
	rightLayout := LayoutMorph newColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	! !

!methodRemoval: LibrosClientPurchasesWindow #createPurchacesList stamp: 'G.L.S 7/7/2021 21:07:28'!
createPurchacesList

	purchacesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchacesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchacesList layoutSpec proportionalHeight: 0.85.
	
	!

!classDefinition: #LibrosClientPurchasesWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 21:07:33'!
Panel subclass: #LibrosClientPurchasesWindow
	instanceVariableNames: 'leftLayout rightLayout purchasesList totalPriceLabel logoutButton createCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 21:07:33' prior: 50950783!
addPurchaseList
	
	leftLayout addMorph: (LabelMorph contents: 'Historial de compras').
	leftLayout addMorph: purchasesList.
	
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 21:07:33' prior: 50950902!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:07:52'!
decodePurchaseList: listToDecode.
	
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:08:21' prior: 50950974!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
		listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:10:26' prior: 50950979!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		
		(isbn = '') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:10:37' prior: 50951000!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size. 
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !

c _ c copyFrom: 1 to: (c size - 1). !

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ c copyFrom: 1 to: (c size - 1).!

c!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:13:15' prior: 50951029!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ 'pepe|1|carlos|2|jorge|14|'.!

c _ c copyFrom: 1 to: c size - 1.!

c. !

d _ OrderedCollection new.!

e _ OrderedCollection new.!

e add: 5.!

e add: 10.!

e add: 6.!

d _ e copyFrom: 1 to: e size -1. !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:17:59' prior: 50950887!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:18:57' prior: 50951108!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmountWith: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:19:26' prior: 50951064!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ listToDecodeCopy copyUpTo: $|.
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:20:29'!
updateTotalAmountWith: aTotalString.
	
	"totalString := aTotalString."
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:21:15' prior: 50951125!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self triggerEvent: #updateTotalAmount  withArguments: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

!methodRemoval: LibrosClientModel #updateTotalAmountWith: stamp: 'G.L.S 7/7/2021 21:21:19'!
updateTotalAmountWith: aTotalString.
	
	"totalString := aTotalString."
	
	!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:21:25' prior: 50951178!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self triggerEvent: #updateTotalAmount withArguments: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:22:34' prior: 50944089!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:23:27' prior: 50951203!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self triggerEvent: #updateTotalAmount withArguments: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:23:53' prior: 50951238!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 21:24:14'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:24:12'!
updateTotalAmount: aTotalString

	totalAmount := aTotalString.
	
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:24:27' prior: 50950276 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 21:25:16'!
totalAmount

	^totalAmount.
	! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:26:37' prior: 50951223!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:26:53'!
updateDisplay
	
	purchasesList updateList.! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:27:33' prior: 50951331!
updateDisplay
	
	purchasesList updateList.
	totalPriceLabel contents: 'Total $', self model totalAmount.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

----QUIT----(7 July 2021 21:28:22) CuisUniversity-4532.image priorSource: 19680250!

----STARTUP---- (7 July 2021 21:28:28) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

listToDecode!

librosServer destroy.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:31:46' prior: 50951144!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = ''] whileTrue: [isbn _ listToDecodeCopy copyUpTo: $|].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !

true not!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:33:01' prior: 50951356!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [isbn _ listToDecodeCopy copyUpTo: $|].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----STARTUP---- (7 July 2021 21:34:58) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:31:46' prior: 50951144!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = ''] whileTrue: [isbn _ listToDecodeCopy copyUpTo: $|].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:33:01' prior: 50951424!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [isbn _ listToDecodeCopy copyUpTo: $|].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 21:35:40' prior: 50951454!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [
			isbn _ listToDecodeCopy copyUpTo: $|.
			listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
			].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'getters - pricelist' stamp: 'G.L.S 7/7/2021 21:36:42'!
getPurchases
	self shouldBeImplemented.! !
!LibrosClientModel methodsFor: 'getters - pricelist' stamp: 'G.L.S 7/7/2021 21:37:00' prior: 50951525!
getPurchases
	^purchases.! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:37:42' prior: 50950962!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.
	
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:38:03' prior: 50951295 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:38:06' prior: 50951549 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 21:38:41'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:38:39' prior: 50951565 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	
	purchasesListIndex := 0.
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:38:47' prior: 50951594 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	purchasesListIndex := 0.
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 21:39:03'!
purchasesListIndex
	
	^purchasesListIndex.
	! !
!LibrosClientModel methodsFor: 'getters - pricelist' stamp: 'G.L.S 7/7/2021 21:39:31'!
purchasesListIndex: anIndex
	
	purchasesListIndex := anIndex.
	! !
!LibrosClientModel methodsFor: 'setters - cart' stamp: 'G.L.S 7/7/2021 21:39:40' prior: 50944682!
storeItemListIndex: anIndex

	storeItemListIndex := anIndex.! !
!LibrosClientModel methodsFor: 'setters - cart' stamp: 'G.L.S 7/7/2021 21:39:45' prior: 50944741!
cartItemListIndex: anIndex
	
	cartItemListIndex := anIndex.! !

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:40:41' prior: 50950916 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph newColumn.
	rightLayout := LayoutMorph newColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	self layoutMorph addMorph: leftLayout.
	self layoutMorph addMorph: rightLayout.
	! !

LibrosClientLoginWindow open.!

self model totalAmount!

self model totalAmount!

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

 '' !

self model!

self model!

self contents:'pepeeeeeeeee'!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:45:16' prior: 50951651 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beRow.
	
	leftLayout := LayoutMorph newColumn.
	leftLayout axisEdgeWeight: 0.5.
	
	rightLayout := LayoutMorph newColumn.
	rightLayout  axisEdgeWeight: 0.5.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createLogoutButton.
	self createCreateCartButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addLogoutButton.
	self addCreateCartButton.
	
	self layoutMorph addMorph: leftLayout.
	self layoutMorph addMorph: rightLayout.
	! !

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:45:41' prior: 50950739!
createLogoutButton

	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	
	logoutButton layoutSpec proportionalWidth: 0.5.

	
	
	! !
!LibrosClientPurchasesWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 21:45:53' prior: 50950765!
createCreateCartButton
	
	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
								
	createCartButton layoutSpec proportionalWidth: 0.5.! !

----SNAPSHOT----(7 July 2021 21:46:09) CuisUniversity-4532.image priorSource: 19830243!

----SNAPSHOT----(7 July 2021 21:46:14) CuisUniversity-4532.image priorSource: 19842243!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

librosServer := LibrosServer listeningOn: 8080.!

librosServer := LibrosServer listeningOn: 8080.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances !

instanceList := LibrosServer allInstances!

instanceList do: [:instance | instance destroy]!

instanceList!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

purchases := #('aaaa' 'aaaa' 'aaaa' 'aaaa') asOrderedCollection.!

self updateDisplay!
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:35' prior: 50951313!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self
	
	self updateDisplay.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:41' prior: 50951762!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self updateDisplay.
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:44' prior: 50951781!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self updateDisplay.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:23:01' prior: 50951800!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self model tryToListPurchasesWithUserCredentials
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

LibrosClientLoginWindow open.!

----STARTUP---- (7 July 2021 22:24:10) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:35' prior: 50951313!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self
	
	self updateDisplay.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:41' prior: 50951844!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self updateDisplay.
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:21:44' prior: 50951863!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self updateDisplay.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:23:01' prior: 50951882!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	self model tryToListPurchasesWithUserCredentials
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----SNAPSHOT----(7 July 2021 22:24:35) CuisUniversity-4532.image priorSource: 19842332!

----STARTUP---- (7 July 2021 22:24:52) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:25:16' prior: 50951901!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyListedPurchases send: #updateDisplay to: self.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:25:35' prior: 50951933!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

self tryToListPurchasesWithUserCredentials!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:27:20' prior: 50951258!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self halt.
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 22:28:35' prior: 50949676!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:31:07' prior: 50949910!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:31:56' prior: 50952030!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !

LibrosClientLoginWindow open.!

self content!

FixedGregorianDate tomorrow asString!

FixedGregorianDate tomorrow month!

FixedGregorianDate tomorrow monthIndex !

FixedGregorianDate tomorrow !

FixedGregorianDate tomorrow month!

FixedGregorianDate tomorrow month!

self number !

FixedGregorianDate tomorrow month number!

FixedGregorianDate tomorrow year number!

FixedGregorianDate tomorrow month!

FixedGregorianDate tomorrow month number.!

FixedGregorianDate tomorrow year number.!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:40:03' prior: 50949807!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year number asString.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:40:37' prior: 50952097!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year number asString.
	
	^ yearNumber,'/', monthNumber. ! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:40:39' prior: 50952110!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year number asString.
	
	^ yearNumber,'/', monthNumber.! !

StoreObjectFactory new createDefaultCreditCardExpirationDate!

StoreObjectFactory new createDefaultCreditCardExpirationDate!

 '2021/07' !

 '2021/07' !

 '2021/07' !

 '2021/07' !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:43:22' prior: 50952057!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	"self halt."
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 22:43:46' prior: 50940328!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			
			self halt.
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:46:03' prior: 50952148!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	self halt.
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 22:46:33' prior: 50952172!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			
			"self halt."
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:46:45' prior: 50952202!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	"self halt."
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:46:56' prior: 50949817!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances !

LibrosServer allInstances do:[ :instance | instance destroy].!

----SNAPSHOT----(7 July 2021 22:49:05) CuisUniversity-4532.image priorSource: 19848810!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 22:49:59' prior: 50952226!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId | 
			
			self halt.
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

FixedGregorianDate tomorrow!

FixedGregorianDate tomorrow tomorrow!

FixedGregorianDate tomorrow month!

FixedGregorianDate tomorrow + 1 month!

FixedGregorianDate tomorrow + (1*month)!

FixedGregorianDate tomorrow month!

FixedGregorianDate tomorrow month next!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:54:59' prior: 50952124!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month next number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year number asString.
	
	^ yearNumber,'/', monthNumber.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:55:08' prior: 50952365!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year number asString.
	
	^ yearNumber,'/', monthNumber.! !
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 22:55:16' prior: 50952379!
createDefaultCreditCardExpirationDate

	| monthNumber yearNumber |
	monthNumber := FixedGregorianDate tomorrow month number.
	
	monthNumber := (monthNumber < 10) ifTrue:['0', monthNumber asString] ifFalse:[monthNumber asString].
	
	yearNumber := FixedGregorianDate tomorrow year next number asString.
	
	^ yearNumber,'/', monthNumber.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:57:25' prior: 50951973!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	"self halt."
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 22:57:54' prior: 50952326!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			transactionId := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 22:59:54' prior: 50952415!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:01:54' prior: 50952458!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self halt.
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:05:15' prior: 50952483!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	self halt.
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

librosServer destroy.!
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 23:05:44' prior: 50940599!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo:[ :key |
				resultString := resultString, '|', key, '|', (list at: key) asString, '|'
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 23:06:46' prior: 50952536!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo:[ :key |
				(key = 'totalBooks') ifFalse: [resultString := resultString, '|', key, '|', (list at: key) asString, '|'].
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 23:06:59' prior: 50952558!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo:[ :key |
				(key = 'totalBooks') ifFalse: [resultString := resultString, key, '|', (list at: key) asString, '|'].
				].
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/7/2021 23:07:35' prior: 50952581!
startListPurchasesService
	
	self addInterfaceService: '/listPurchases' withAction: [
		:request | 
		|clientId password list resultString result | 
			
			clientId := (request fields at:'clientId').
      			password := (request fields at:'password').
			
			list := mockInterface listPurchasesForUser: clientId withPassword: password.
			
			resultString := '0|'.
			
			list keysDo:[ :key |
				(key = 'totalBooks') ifFalse: [resultString := resultString, key, '|', (list at: key) asString, '|'].
				].
			
			resultString := resultString, 'totalBooks|', (list at: 'totalBooks') asString, '|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		]
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:08:46' prior: 50952516!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self halt.
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/7/2021 23:12:30' prior: 50951485!
decodePurchaseList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [
			isbn _ listToDecodeCopy copyUpTo: $|.
			listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
			].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:14:00'!
showCheckoutTicket
	
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 23:14:39' prior: 50952683!
showCheckoutTicket
	
	"Mostrar Ventana Tickets"
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 23:14:40' prior: 50952687!
showCheckoutTicket
	
	"Mostrar Ventana Tickets".
	
	
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:16:01' prior: 50944777!
logout
	self triggerEvent: #logout with: self.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:16:29' prior: 50951993!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #showCheckoutError to: self.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:16:37' prior: 50952702!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:16:44'!
returnToLogin
	
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:17:13' prior: 50952770!
returnToLogin

	! !

self closeBoxHit!

Workspace!

self messages!

self selectors!
!LibrosClientCartWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:21:20' prior: 50952775!
returnToLogin

	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.

	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:22:25' prior: 50952781!
returnToLogin
	
	LibrosClientLoginWindow open.
	
	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.

	! !

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:23:02' prior: 50952796!
returnToLogin
	
	LibrosClientLoginWindow open.
	
	self closeWindow.

	! !
!LibrosClientCartWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:23:10'!
closeWindow
	
	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.

	! !
!LibrosClientLoginWindow methodsFor: 'window closing' stamp: 'G.L.S 7/7/2021 23:23:43'!
closeWindow
	
	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.! !
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 23:23:56' prior: 50943309!
showCartWindow

	"Mostrar ventana principal acá"
	LibrosClientCartWindow withModel: self model.
	self closeWindow.! !
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 23:24:02' prior: 50952829!
showCartWindow

	LibrosClientCartWindow withModel: self model.
	self closeWindow.! !

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/7/2021 23:25:37' prior: 50950849!
showPurchasesWindow
	
	LibrosClientPurchasesWindow withModel: self model.
	self closeWindow.! !

Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:28:37'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'no messages' stamp: 'G.L.S 7/7/2021 23:29:03' overrides: 50936705!
buildMorphicWindow! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:31:14' prior: 50952862 overrides: 50936705!
buildMorphicWindow
	
	! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:32:33' prior: 50952867 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createCreateCartButton.
	self createListPurchasesButton.
	self createLogoutButton.
	
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addCreateCartButton.
	self addListPurchasesButton.
	self addLogoutButton.
	! !
!LibrosClientTicketWindow class methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:33:55'!
for: aCartList withTotal: aTotal

	^self new initializeFor: aCartList  withTotal: aTotal.! !
!LibrosClientTicketWindow class methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:34:00' prior: 50952886!
for: aCartList withTotal: aTotal

	^self new initializeFor: aCartList withTotal: aTotal.! !
!LibrosClientTicketWindow methodsFor: 'nil' stamp: 'G.L.S 7/7/2021 23:34:09'!
initializeFor: aCartList  withTotal: aTotal! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:34:20' prior: 50952899!
initializeFor: aCartList  withTotal: aTotal

	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:35:23'!
initializeFor: aCartList  withTotal: aTotal withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !

!methodRemoval: LibrosClientTicketWindow #initializeFor:withTotal: stamp: 'G.L.S 7/7/2021 23:35:27'!
initializeFor: aCartList  withTotal: aTotal

	!
!LibrosClientTicketWindow class methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:35:44'!
for: aCartList withTotal: aTotal withModel: aModel

	^self new initializeFor: aCartList withTotal: aTotal withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow class #for:withTotal: stamp: 'G.L.S 7/7/2021 23:35:47'!
for: aCartList withTotal: aTotal

	^self new initializeFor: aCartList withTotal: aTotal.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:36:07'!
updateDisplay! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:36:08' prior: 50952939!
updateDisplay
	
	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:36:30' prior: 50952909!
initializeFor: aCartList  withTotal: aTotal withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !
!LibrosClientTicketWindow class methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:37:27'!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new initializeFor: aCartList withTotal: aTotal withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow class #for:withTotal:withModel: stamp: 'G.L.S 7/7/2021 23:37:27'!
for: aCartList withTotal: aTotal withModel: aModel

	^self new initializeFor: aCartList withTotal: aTotal withModel: aModel.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:38:11'!
initializeFor: aCartList  withTotal: aTotal withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !
!LibrosClientTicketWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:38:11' prior: 50952959!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new initializeFor: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow #initializeFor:withTotal:withModel: stamp: 'G.L.S 7/7/2021 23:38:11'!
initializeFor: aCartList  withTotal: aTotal withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.!
!LibrosClientTicketWindow methodsFor: 'nil' stamp: 'G.L.S 7/7/2021 23:38:57' overrides: 50936791!
defaultExtent

	^ 1035@485! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:41:51' prior: 50952630!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:42:30'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: 'purchasesList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:42:28'!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:42:40' prior: 50953055!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getCartPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:43:13' prior: 50953068!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getCartPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:46:56' prior: 50951336!
updateDisplay
	
	purchasesList updateList.
	purchasesList setSelectionIndex: 0.
	totalPriceLabel contents: 'Total $', self model totalAmount.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:47:32' prior: 50952943!
updateDisplay
	
	purchasesList updateList.
	purchasesList setSelectionIndex: 0.
	! !

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:47:49'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: 'purchasesList totalPriceLabel'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:47:48'!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: ''.
	
	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:48:01' prior: 50953110!
updateDisplay
	
	purchasesList updateList.
	purchasesList setSelectionIndex: 0.
	totalPriceLabel contents: 'Total $', self model totalAmount.! !

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:48:50'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: 'purchasesList totalPriceLabel createCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:48:49'!
createCreateCartButton
	
	createCartButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToCreateCartWithUserCredentials
								label: 'Create Cart'.
								
	createCartButton layoutSpec proportionalWidth: 0.5.! !

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:49:02'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: 'purchasesList totalPriceLabel createCartButton logoutButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:49:00'!
createLogoutButton

	logoutButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #logout
								label: 'Logout'.
	
	logoutButton layoutSpec proportionalWidth: 0.5.

	
	
	! !

!classDefinition: #LibrosClientTicketWindow category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:49:32'!
Panel subclass: #LibrosClientTicketWindow
	instanceVariableNames: 'purchasesList totalPriceLabel createCartButton logoutButton listPurchasesButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:49:30'!
createListPurchasesButton.

	listPurchasesButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToListPurchasesWithUserCredentials
								label: 'List Purchases'.
	
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:49:40' prior: 50952872 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createCreateCartButton.
	self createListPurchasesButton.
	self createLogoutButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addCreateCartButton.
	self addListPurchasesButton.
	self addLogoutButton.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:51:54' prior: 50953200 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	self axisEdgeWeight: 0.5.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createCreateCartButton.
	self createListPurchasesButton.
	self createLogoutButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addCreateCartButton.
	self addListPurchasesButton.
	self addLogoutButton.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:52:28'!
addPurchaseList
	
	self layoutMorph addMorph: purchasesList.! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:53:09' prior: 50953230!
addPurchaseList
	
	self layoutMorph addMorph: (LabelMorph contents: 'Resumen del carrito').
	self layoutMorph addMorph: purchasesList.! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:53:40'!
addTotalPriceLabel

	self layoutMorph addMorph: totalPriceLabel.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:54:13'!
addCreateCartButton
	
	self layoutMorph addMorph: createCartButton.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:54:43'!
addListPurchasesButton

	self layoutMorph addMorph: listPurchasesButton.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:54:44' prior: 50953256!
addListPurchasesButton

	self layoutMorph addMorph: listPurchasesButton.
	
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/7/2021 23:55:06'!
addLogoutButton

	self layoutMorph addMorph: logoutButton.
	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:56:30'!
withTotal: aTotal withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !
!LibrosClientTicketWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:56:31' prior: 50952988!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new withTotal: aTotal withTicketId: aTicketId withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow #initializeFor:withTotal:withTicketId:withModel: stamp: 'G.L.S 7/7/2021 23:56:31'!
initializeFor: aCartList  withTotal: aTotal withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:56:52'!
withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !
!LibrosClientTicketWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:56:52' prior: 50953286!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new withTicketId: aTicketId withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow #withTotal:withTicketId:withModel: stamp: 'G.L.S 7/7/2021 23:56:52'!
withTotal: aTotal withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:57:03'!
withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.! !
!LibrosClientTicketWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/7/2021 23:57:03' prior: 50953321!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow #withTicketId:withModel: stamp: 'G.L.S 7/7/2021 23:57:03'!
withTicketId: aTicketId withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.!
!LibrosClientTicketWindow class methodsFor: 'initialization' stamp: 'G.L.S 7/7/2021 23:57:12'!
withModel: aModel

	^self new withModel: aModel.! !

!methodRemoval: LibrosClientTicketWindow class #for:withTotal:withTicketId:withModel: stamp: 'G.L.S 7/7/2021 23:57:22'!
for: aCartList withTotal: aTotal withTicketId: aTicketId withModel: aModel

	^self new withModel: aModel.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:58:08' prior: 50952275!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	self triggerEvent: #checkoutSuccessful with: self.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/7/2021 23:58:30'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex transactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:58:29' prior: 50953383!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	transactionId := checkoutId.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/7/2021 23:59:56' prior: 50953415!
checkoutCart
	
	| checkoutId |
	
	[checkoutId := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	transactionId := checkoutId.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/8/2021 00:07:18' prior: 50950145!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser checkoutResume |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	checkoutResume := Dictionary new.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	self deleteCart: aCartId.
	
	^transactionId.
! !
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/8/2021 00:08:14' prior: 50953459!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser checkoutResume |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	checkoutResume := Dictionary new.
	checkoutResume add: 'id' -> transactionId.
	checkoutResume add: 'total' -> cartToCheckout totalItemPrice.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	self deleteCart: aCartId.
	
	^transactionId.
! !
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/8/2021 00:09:11' prior: 50953488!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser checkoutResume |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	checkoutResume := Dictionary new.
	checkoutResume add: 'id' -> transactionId.
	checkoutResume add: 'total' -> cartToCheckout totalItemPrice.
	
	self addCartItemsFrom: aCartId to: checkoutResume.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	self deleteCart: aCartId.
	
	^transactionId.
! !
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/8/2021 00:09:25' prior: 50953521!
checkOutCart: aCartId withCreditCard: aCreditCardNumber withExpirationDate: aDate withOwner: anOwner
	
	| cartToCheckout creditCard cashier cartUser checkoutResume |
	
	cartToCheckout := self cartForId: aCartId.
	cartUser := self userOfCart: aCartId.
	creditCard := CreditCard forOwner: anOwner withNumber: aCreditCardNumber withExpirationDate: aDate.
	
	cashier := Cashier withCatalog: catalog.
	
	self assertCartTimerDidNotExpireFor: aCartId.
	
	cashier checkout: cartToCheckout 
		withCreditCard: creditCard 
		onDate: FixedGregorianDate today
		registerOn: salesBook
		forMerchantProcessor: merchantProcesor.
	
	transactionId := transactionId + 1.
	
	checkoutResume := Dictionary new.
	checkoutResume add: 'id' -> transactionId.
	checkoutResume add: 'total' -> cartToCheckout totalItemPrice.
	
	self addCartItemsFrom: aCartId to: checkoutResume.
	
	self updatePurchasesFor: cartUser withCart: aCartId withTotal: cartToCheckout totalItemPrice.
	self deleteCart: aCartId.
	
	^checkoutResume.
! !
!MockRestInterface methodsFor: 'checkout' stamp: 'G.L.S 7/8/2021 00:09:35'!
addCartItemsFrom: aCartId to: checkoutResume.

	
! !
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 7/8/2021 00:10:09' prior: 50953590!
addCartItemsFrom: aCartId to: checkoutResume.

	(self listCart: aCartId) do:[].
	
! !
!MockRestInterface methodsFor: 'private' stamp: 'G.L.S 7/8/2021 00:11:35' prior: 50953595!
addCartItemsFrom: aCartId to: checkoutResume.

	(self listCart: aCartId) do:[
		:aBookAmountTuple |
		checkoutResume add: (aBookAmountTuple first) -> aBookAmountTuple second.
		].
	
! !

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:12:02'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:12:06'!
PASSED!
!MockRestInterfaceTest methodsFor: 'testing' stamp: 'G.L.S 7/8/2021 00:12:59' prior: 50930450!
test12SuccesfulCheckoutsProduceDifferentTransactionIds
	
	| password usuario cartId transactionId1 transactionId2 |
	
	usuario := 'pepe'.
	password := '5678'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId1 := (mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco') at: 'id'.
	
	cartId := mockInterface createCartForUser: usuario password: password.
	
	mockInterface add: 17 ofItem: smalltalk80 toCart: cartId.
	
	transactionId2 := (mockInterface checkOutCart: cartId 
					withCreditCard: '0000000000000000' 
					withExpirationDate: FixedGregorianDate tomorrow 
					withOwner: 'Marco') at: 'id'.
	
	self deny: (transactionId1 = transactionId2).! !

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 00:13:00'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/8/2021 00:13:05'!
PASSED!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/8/2021 00:13:06'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/8/2021 00:13:06'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/8/2021 00:13:06'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/8/2021 00:13:07'!
PASSED!
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:13:47' prior: 50952434!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := (mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco).
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:14:18' prior: 50953888!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result transactionId checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
							
			transactionId := checkoutResume at: 'id'.
			
			resultString := '0|', transactionId asString.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:14:50' prior: 50953913!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', ((checkoutResume at: 'id') asString).
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:15:02' prior: 50953939!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', ((checkoutResume at: 'id') asString).
			
			
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:16:04' prior: 50953964!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', ((checkoutResume at: 'id') asString).
			
			checkoutResume keysDo:[ :key |
				(key = 'total' or: [key = 'id']) ifFalse: [resultString := resultString, key, '|', (checkoutResume at: key) asString, '|'].
				].
			
			resultString := resultString, 'total|', (checkoutResume at: 'total') asString, '|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosServer methodsFor: 'service startup' stamp: 'G.L.S 7/8/2021 00:16:34' prior: 50953989!
startCheckOutCartService

	self addInterfaceService: '/checkOutCart' withAction: [
		:request | 
		|cartId ccn cced cco resultString result checkoutResume |
			
			cartId := (request fields at:'cartId') asNumber.
			ccn := (request fields at:'ccn').
			cced := self processExpirationDateFrom: (request fields at:'cced').
			cco := (request fields at:'cco'). 
			
			checkoutResume := mockInterface checkOutCart: cartId  
							withCreditCard: ccn
							withExpirationDate: cced 
							withOwner: cco.
			
			resultString := '0|', ((checkoutResume at: 'id') asString), '|'.
			
			checkoutResume keysDo:[ :key |
				(key = 'total' or: [key = 'id']) ifFalse: [resultString := resultString, key, '|', (checkoutResume at: key) asString, '|'].
				].
			
			resultString := resultString, 'total|', (checkoutResume at: 'total') asString, '|'.
			
        			result := WebUtils jsonEncode: (resultString).
    			request send200Response: result.
		].
! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:17:03' prior: 50953434!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	transactionId := listToDecode.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:17:38' prior: 50954055!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := 
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:19:00' prior: 50954074!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode copyAfter: $|.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:19:30' prior: 50954095!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode copyAfter: $|.
	
	self decodeTicketCartList: listToDecode.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:19:42'!
decodeTicketCartList: listToDecode.

	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 00:20:14' prior: 50954142!
decodeTicketCartList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 3 to: listToDecode size - 1.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [
			isbn _ listToDecodeCopy copyUpTo: $|.
			listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
			].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 00:20:33' prior: 50954147!
decodeTicketCartList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 1 to: listToDecode size.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [
			isbn _ listToDecodeCopy copyUpTo: $|.
			listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
			].
		
		(isbn = 'totalBooks') 
			ifTrue:[
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 00:20:39' prior: 50954176!
decodeTicketCartList: listToDecode

	| decodedList listToDecodeCopy |
	
	listToDecodeCopy := listToDecode copyFrom: 1 to: listToDecode size.
	decodedList  := OrderedCollection new.
	
	[listToDecodeCopy = ''] whileFalse: [ | tempString isbn |
		tempString _ ''.
		isbn _ ''.
		[isbn = '' and: [(listToDecodeCopy = '') not]] whileTrue: [
			isbn _ listToDecodeCopy copyUpTo: $|.
			listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
			].
		
		(isbn = 'total') 
			ifTrue:[
					tempString _ listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				]
			ifFalse:[
					tempString _ isbn, ' - ', ((catalog at: isbn) at: 'nombre'), ' - ', listToDecodeCopy copyUpTo: $|.
					listToDecodeCopy _ listToDecodeCopy copyAfter: $|.
				].
		
		decodedList add: tempString.
	].

	^decodedList.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/8/2021 00:21:45'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex transactionId ticketCartList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:21:44' prior: 50954118!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode copyAfter: $|.
	
	ticketCartList := self decodeTicketCartList: listToDecode.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:21:59' prior: 50951611 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	purchasesListIndex := 0.
	
	ticketCartList := OrderedCollection new.
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:23:11' prior: 50954248!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	ticketCartList := self decodeTicketCartList: listToDecode.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!
!LibrosClientCartWindow methodsFor: 'windows' stamp: 'G.L.S 7/8/2021 00:24:48' prior: 50952692!
showCheckoutTicket
	
	LibrosClientTicketWindow withModel: self model.
	self closeWindow.
	
	
	
	! !
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:25:32' prior: 50954274 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	purchasesListIndex := 0.
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:25:40' prior: 50954297!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	purchases := self decodeTicketCartList: listToDecode.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/8/2021 00:26:00'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex transactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/8/2021 00:26:36' prior: 50953215 overrides: 50936705!
buildMorphicWindow
	
	self layoutMorph beColumn.
	self layoutMorph axisEdgeWeight: 0.5.
	
	self createPurchasesList.
	self createTotalPriceLabel.
	self createCreateCartButton.
	self createListPurchasesButton.
	self createLogoutButton.
	
	self addPurchaseList.
	self addTotalPriceLabel.
	self addCreateCartButton.
	self addListPurchasesButton.
	self addLogoutButton.
	! !
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/8/2021 00:27:19' prior: 50953082!
createPurchasesList

	purchasesList := PluggableListMorph model: self model listGetter: #getPurchases indexGetter: #purchasesListIndex indexSetter: #purchasesListIndex:.
	purchasesList  borderColor: Color skyBlue; borderWidth: 1; morphWidth: 300.
	
	purchasesList layoutSpec proportionalHeight: 0.85.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientTicketWindow methodsFor: 'interface creation' stamp: 'G.L.S 7/8/2021 00:28:51' prior: 50953189!
createListPurchasesButton.

	listPurchasesButton := PluggableButtonMorph model: self model 
								stateGetter: nil  
								action: #tryToListPurchasesWithUserCredentials
								label: 'List Purchases'.
	
	listPurchasesButton layoutSpec proportionalWidth: 0.5.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:29:54' prior: 50954376!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:30:21' prior: 50954464!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:32:24' prior: 50951951!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self updateDisplay.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self.
	self model when: #successfullyLogedIn send: #showUserWindow to: self."! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:32:36' prior: 50954528!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self updateDisplay.! !
!LibrosClientTicketWindow methodsFor: 'nil' stamp: 'G.L.S 7/8/2021 00:32:58'!
returnToLogin
	
	LibrosClientLoginWindow open.
	
	self closeWindow.! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 00:33:30'!
closeWindow
	
	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.! !
!LibrosClientPurchasesWindow methodsFor: 'window closing' stamp: 'G.L.S 7/8/2021 00:36:43'!
returnToLogin
	
	LibrosClientLoginWindow open.
	
	self closeWindow.
! !
!LibrosClientPurchasesWindow methodsFor: 'window closing' stamp: 'G.L.S 7/8/2021 00:36:53'!
closeWindow
	
	Preferences dismissAllOnOptionClose ifTrue:
		[Sensor rawMacOptionKeyPressed ifTrue:
			[^ self world closeUnchangedWindows]].
	self delete.

	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:37:44' prior: 50954546!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self updateDisplay.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:38:39' prior: 50954591!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Compras anteriores'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	
	self updateDisplay.! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:39:08'!
showCartWindow
	! !
!LibrosClientPurchasesWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:39:36' prior: 50954623!
showCartWindow

	LibrosClientCartWindow withModel: self model.
	self closeWindow.! !

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:46:29'!
showCheckoutError
	
	
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 00:46:51' prior: 50954653!
showCheckoutError
	
	LibrosClientErrorWindow contents: 'Error - No se pudo realizar el checkout'.
	
	
	! !

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 00:48:49' prior: 50954492!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

----SNAPSHOT----(8 July 2021 00:49:54) CuisUniversity-4532.image priorSource: 19861399!

----QUIT----(8 July 2021 00:49:57) CuisUniversity-4532.image priorSource: 19937665!

----STARTUP---- (8 July 2021 12:06:13) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 12:08:02' prior: 50953341!
withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	
	self updateDisplay.! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 12:08:17' prior: 50954716!
withModel: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Resumen de compra'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	self model when: #successfullyListedPurchases send: #showPurchasesWindow to: self.
	
	self updateDisplay.! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 12:08:29' prior: 50954559!
returnToLogin
	
	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 12:08:46' prior: 50954750!
returnToLogin
	
	LibrosClientLoginWindow open.
	
	self closeWindow.

	! !
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 12:08:50' prior: 50954754!
returnToLogin
	
	LibrosClientLoginWindow open.
	self closeWindow.! !

----SNAPSHOT----(8 July 2021 12:09:29) CuisUniversity-4532.image priorSource: 19937754!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientTicketWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:36:50'!
showCartWindow
	
	! !
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/8/2021 14:36:59' prior: 50952836!
showCartWindow

	LibrosClientCartWindow withModel: self model.
	self closeWindow.! !
!LibrosClientTicketWindow methodsFor: 'windows' stamp: 'G.L.S 7/8/2021 14:37:15' prior: 50954775!
showCartWindow

	LibrosClientCartWindow withModel: self model.
	self closeWindow.! !
!LibrosClientTicketWindow methodsFor: 'windows' stamp: 'G.L.S 7/8/2021 14:37:36'!
showPurchasesWindow
	
	LibrosClientPurchasesWindow withModel: self model.
	self closeWindow.! !

----SNAPSHOT----(8 July 2021 14:37:49) CuisUniversity-4532.image priorSource: 19939652!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:39:45' prior: 50952736!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self updateDisplay.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:40:01'!
updateDisplay
	
	cartItemsList updateList.
	
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

!methodRemoval: LibrosClientCartWindow #updateDisplay stamp: 'G.L.S 7/8/2021 14:40:57'!
updateDisplay
	
	cartItemsList updateList.
	
	
	!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:41:13' prior: 50954809!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self model refreshCartList.
	
	
	! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 14:41:31'!
refreshCartList
	
	cartItemList := OrderedCollection new.
! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 14:42:37' prior: 50954890!
refreshCartList
	
	cartItemList := OrderedCollection new.
	
	self triggerEvent: #	refreshedCart with: self.
! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:43:38' prior: 50954856!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self model when: #refreshedCart send: #updateDisplay to: self.
	
	self model refreshCartList.
	
	
	! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:44:37' prior: 50954906!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self model when: #refreshedCart send: #refreshCartList to: self.
	
	self model refreshCartList.
	
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

[1/0] on: Error do: [:error | error messageText]. !

[] value: 5.!

[1/0] on: Error do: [].!

[] valueWithArguments: {'pepe'. 'pepe'. 'pepe'. 'pepe'.}.!

[1+1] valueWithArguments: {'pepe'. 'pepe'. 'pepe'. 'pepe'.}.!
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48'!
contents: anErrorDescription withModel: aModel 

	^self new initializeWith: anErrorDescription.! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50941871!
addUserpasswordInput
	
	self layoutMorph 
		addMorph: (LabelMorph contents: 'Contraseña' withModel: self model);
		addMorph: userpasswordTextMorph.
! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50950954!
addPurchaseList
	
	leftLayout addMorph: (LabelMorph contents: 'Historial de compras' withModel: self model).
	leftLayout addMorph: purchasesList.
	
	
	! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50941864!
addUsernameInput

	self layoutMorph
		addMorph: (LabelMorph contents: 'Usuario' withModel: self model);
		addMorph: usernameTextMorph.
! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50953095!
updateDisplay
	
	purchasesList updateList.
	purchasesList setSelectionIndex: 0.
	totalPriceLabel contents: 'Total $', self model totalAmount withModel: self model.! !
!LibrosClientPurchasesWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50950718!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: '' withModel: self model.
	
	! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50953236!
addPurchaseList
	
	self layoutMorph addMorph: (LabelMorph contents: 'Resumen del carrito' withModel: self model).
	self layoutMorph addMorph: purchasesList.! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50953131!
updateDisplay
	
	purchasesList updateList.
	purchasesList setSelectionIndex: 0.
	totalPriceLabel contents: 'Total $', self model totalAmount withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50954658!
showCheckoutError
	
	LibrosClientErrorWindow contents: 'Error - No se pudo realizar el checkout' withModel: self model.
	
	
	! !
!LibrosClientTicketWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50953125!
createTotalPriceLabel

	totalPriceLabel := LabelMorph contents: '' withModel: self model.
	
	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50944929!
addStoreList
	
	storeListColumn addMorph: (LabelMorph contents: 'Catalogo de la Tienda' withModel: self model).
	storeListColumn addMorph: storeItemsList.

	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50945660!
addButtons
	
	| layout1 layout2 |
	
	layout1 := LayoutMorph newColumn.
	layout2 := LayoutMorph newColumn.
	
	layout1 axisEdgeWeight: 0.5.
	layout2 axisEdgeWeight: 0.5.
	
	layout1 addMorph: (LabelMorph contents: 'Cantidad de items a manipular' withModel: self model).
	layout1 addMorph: itemAmountTextBox.
	
	layout2 addMorph: addToCartButton.
	layout2 addMorph: removeFromCartButton.
	layout2 addMorph: checkOutCartButton.
	layout2 addMorph: logoutButton.
	
	buttonsColumn  addMorph: layout1.
	buttonsColumn  addMorph: layout2.
	
	
	
	
	

	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50948986!
showAmountCalculationError
	LibrosClientErrorWindow contents: 'Error - No se pudo calcular la cantidad de libros a agregar, verifique que sea un número' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50944937!
addCartList
	
	cartListColumn addMorph: (LabelMorph contents: 'Items del carrito actual' withModel: self model).
	cartListColumn addMorph: 	cartItemsList.
	
	! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50948960!
showISBNCalculationError
	LibrosClientErrorWindow contents: 'Error - Hubo un error calculando el ISBN, quizá no está selecionado un libro' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50948973!
showAddToCartError
	LibrosClientErrorWindow contents: 'Error - No se pudo agregar el elemento al carrito' withModel: self model.! !
!LibrosClientErrorWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50942968 overrides: 50936705!
buildMorphicWindow
	
	| errorLabel |
	errorLabel := LabelMorph contents: description withModel: self model.
	
	self layoutMorph
		beRow;
		axisEdgeWeight: 0.5;
		addMorph: (errorLabel).
	
	self morphExtent: (errorLabel minimumExtent + self errorMessagePanning).! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 14:52:48' prior: 50942675!
showCredentialError
	
	LibrosClientErrorWindow contents: MockRestInterface errorWrongUserCredentials withModel: self model.! !

!methodRemoval: LibrosClientErrorWindow class #contents: stamp: 'G.L.S 7/8/2021 14:52:48'!
contents: anErrorDescription

	^self new initializeWith: anErrorDescription.!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/8/2021 14:53:03'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/8/2021 14:53:05'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/8/2021 14:53:07'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 14:53:10'!
PASSED!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----STARTUP---- (8 July 2021 14:54:44) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!


librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 14:55:42' prior: 50943247!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 14:57:30' prior: 50952736!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self.
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self.
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #checkoutFailed send: #showCheckoutError to: self.
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self refreshCartList.
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----SNAPSHOT----(8 July 2021 14:58:02) CuisUniversity-4532.image priorSource: 19940671!
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12'!
contents: anErrorDescription withModel: aModel 

	^self new initializeWith: anErrorDescription.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948986!
showAmountCalculationError
	LibrosClientErrorWindow contents: 'Error - No se pudo calcular la cantidad de libros a agregar, verifique que sea un número' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948960!
showISBNCalculationError
	LibrosClientErrorWindow contents: 'Error - Hubo un error calculando el ISBN, quizá no está selecionado un libro' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948973!
showAddToCartError
	LibrosClientErrorWindow contents: 'Error - No se pudo agregar el elemento al carrito' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:13' prior: 50954658!
showCheckoutError
	
	LibrosClientErrorWindow contents: 'Error - No se pudo realizar el checkout' withModel: self model.
	
	
	! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:13' prior: 50942675!
showCredentialError
	
	LibrosClientErrorWindow contents: MockRestInterface errorWrongUserCredentials withModel: self model.! !

!methodRemoval: LibrosClientErrorWindow class #contents: stamp: 'G.L.S 7/8/2021 15:00:13'!
contents: anErrorDescription

	^self new initializeWith: anErrorDescription.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:06'!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:02:06' prior: 50954866!
contents: anErrorDescription withModel: aModel 

	^self new initializeWith: anErrorDescription withModel: aModel.! !

!methodRemoval: LibrosClientErrorWindow #initializeWith: stamp: 'G.L.S 7/8/2021 15:02:06'!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.!
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:21' prior: 50954924!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:35' prior: 50954952!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

!testRun: #CartTest #test01CartThatWasJustCreatedIsEmpty stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test02CartWithAnItemIsNotEmpty stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test03CartWithSeveralItemsAddedContainsTheRightItemsAndAmounts stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test04CartCannotAddItemsThatAreNotAllowed stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test05CartCannotAddANonIntegerAmountOfAnItem stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test06CartCannotAddANegativeAmountOfAnItem stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test07CartCannotAddAZeroAmountOfAnItem stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test08CannotRemoveAnItemIfItIsNotInTheCart stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test09CannotRemoveMoreItemsThatTheOnesTheCartHas stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test10RemovingAnItemTakesItOutOfTheCart stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test11RemovingLessItemsThanWhatTheCartHasLeavesSomeInTheCart stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test12AddingItemMultipleTimesToTheCartCorrectlyChangesTheAmount stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CartTest #test13ThePriceOfTheCartItemsIsEqualToTheQuantityOfEachOneOfThemTimesTheirPrice stamp: 'G.L.S 7/8/2021 15:03:03'!
PASSED!

!testRun: #CashierTest #test01CashierCannotCheckoutWithAnEmptyCart stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test02CashierCannotCheckoutWithACartWithThatDoesntHaveAMatchingCatalog stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test03CheckoutReturnsTheRightAmount stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test04CashierCannotCheckOutWithAnExpiredCard stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test05CashierCheckoutRegistersSale stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test06CashierCannotCheckoutAStolenCard stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test07CashierCannotCheckoutWithAFakeCard stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CashierTest #test08CashierCannotCheckoutWithACardWithoutMoney stamp: 'G.L.S 7/8/2021 15:03:05'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardCannotHaveEmptyOwner stamp: 'G.L.S 7/8/2021 15:03:07'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberForACreditCardCannotHaveLessThan16Digits stamp: 'G.L.S 7/8/2021 15:03:07'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberForACreditCardCannotHaveMoreThan16Digits stamp: 'G.L.S 7/8/2021 15:03:07'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 15:03:11'!
PASSED!

!testRun: #MockRestInterfaceTest #test01CannotCreateCartWithTheWrongUserPassword stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test02CreateCartForAnExistingUserDoesNotFail stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test03CannotCreateCartForAUserThatDoesntExist stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test04CannotAddItemToAnUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test05AddingItemsToCartWorksAsExpected stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test06DifferentCartsCannotHaveTheSameId stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test07CannotListCartAnUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test08CannotListPurchasesWithAnUserThatDoesntExist stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test09CannotCheckOutWithACartThatDoesNotExist stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test10SuccessfulCheckoutAltersUserListPurchase stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test11CannotUseACartAfterItExpired stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test12SuccesfulCheckoutsProduceDifferentTransactionIds stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test13CannotCheckoutAPreviouslyCheckoutedCart stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test14CannotRemoveFromUnexistentCart stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

!testRun: #MockRestInterfaceTest #test15RemovingItemsFromCartWorksAsExpected stamp: 'G.L.S 7/8/2021 15:03:21'!
PASSED!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/8/2021 15:04:39'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex transactionId errorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:04:37' prior: 50954360 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	errorMessage := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	purchasesListIndex := 0.
	! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:05:35' prior: 50954963!
initializeWith: anErrorDescription withModel: aModel 
	
	description := 'Error - ', aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:05:58'!
errorMessage
	
	^errorMessage.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:06:32' prior: 50954808!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error messageText.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:10' prior: 50955230!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error contents.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:33' prior: 50955247!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error content.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:45' prior: 50955260!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error messageText.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:13:03' prior: 50929600!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: ('1|#', anError messageText, '#')]
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:13:44' prior: 50955286!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:14:51' prior: 50944010!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:15:24' prior: 50952251!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	"self halt."
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:16:34' prior: 50955308!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:16:48' prior: 50955371!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

WebUtils jsonDecode: ((self content) readStream)!

((self content) readStream)!

self content !

self content copyAfter: '<p>'!

self content !

self content copyAfter: '<p>1'!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:22:11' prior: 50955391!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:22:21' prior: 50955342!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	"self halt."
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !

self asString!

self getContent !

----STARTUP---- (8 July 2021 15:27:04) as /media/Datos/Cuis/Ej-Libros/linux64/CuisUniversity-4532.image!

!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12'!
contents: anErrorDescription withModel: aModel 

	^self new initializeWith: anErrorDescription.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948986!
showAmountCalculationError
	LibrosClientErrorWindow contents: 'Error - No se pudo calcular la cantidad de libros a agregar, verifique que sea un número' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948960!
showISBNCalculationError
	LibrosClientErrorWindow contents: 'Error - Hubo un error calculando el ISBN, quizá no está selecionado un libro' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:12' prior: 50948973!
showAddToCartError
	LibrosClientErrorWindow contents: 'Error - No se pudo agregar el elemento al carrito' withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:13' prior: 50954658!
showCheckoutError
	
	LibrosClientErrorWindow contents: 'Error - No se pudo realizar el checkout' withModel: self model.
	
	
	! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:00:13' prior: 50942675!
showCredentialError
	
	LibrosClientErrorWindow contents: MockRestInterface errorWrongUserCredentials withModel: self model.! !

!methodRemoval: LibrosClientErrorWindow class #contents: stamp: 'G.L.S 7/8/2021 15:27:07'!
contents: anErrorDescription

	^self new initializeWith: anErrorDescription.!
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:06'!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:02:06' prior: 50955470!
contents: anErrorDescription withModel: aModel 

	^self new initializeWith: anErrorDescription withModel: aModel.! !

!methodRemoval: LibrosClientErrorWindow #initializeWith: stamp: 'G.L.S 7/8/2021 15:27:07'!
initializeWith: anErrorDescription
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.!
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:21' prior: 50955524!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:02:35' prior: 50955552!
initializeWith: anErrorDescription withModel: aModel 
	
	description := anErrorDescription.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !

!classDefinition: #LibrosClientModel category: 'Ejercicio-Libros' stamp: 'G.L.S 7/8/2021 15:27:07'!
Object subclass: #LibrosClientModel
	instanceVariableNames: 'username userpassword restInterface cartId purchases storeItemList cartItemList storeItemListIndex cartItemListIndex catalog itemAmount storeFactory totalAmount purchasesListIndex transactionId errorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Ejercicio-Libros'!
!LibrosClientModel methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:04:37' prior: 50954360 overrides: 16896425!
initialize
	
	username := ''.
	userpassword := ''.
	errorMessage := ''.
	
	restInterface := LibrosRestInterface new.
	
	storeFactory := StoreObjectFactory new.
	
	self getCatalog.
	
	self prepareStoreItemList.
	
	cartItemList := OrderedCollection new.
	
	storeItemListIndex := 0.
	cartItemListIndex := 0.
	
	itemAmount := ''.
	totalAmount := ''.
	
	purchases := OrderedCollection new.
	purchasesListIndex := 0.
	! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:05:35' prior: 50955563!
initializeWith: anErrorDescription withModel: aModel 
	
	description := 'Error - ', aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientModel methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:05:58'!
errorMessage
	
	^errorMessage.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:06:32' prior: 50954808!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error messageText.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:10' prior: 50955621!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error contents.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:33' prior: 50955634!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error content.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:07:45' prior: 50955647!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error |
		errorMessage := error messageText.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:13:03' prior: 50929600!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: ('1|#', anError messageText, '#')]
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:13:44' prior: 50955673!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: ('1|', anError messageText)]
		].! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:14:51' prior: 50944010!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	"| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content]."
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:15:24' prior: 50952251!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	"self halt."
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:16:34' prior: 50955695!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:16:48' prior: 50955755!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:22:11' prior: 50955775!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:22:21' prior: 50955729!
sendCheckOutRequestFor: aCartId creditCardNumber: aCreditCardNumber creditCardExpiration: aCreditCardExpirationDate creditCardOwner: aCreditCardOwner

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'cartId' put: aCartId.
	fieldsDict at: 'ccn' put: aCreditCardNumber.
	fieldsDict at: 'cced' put: aCreditCardExpirationDate.
	fieldsDict at: 'cco' put: aCreditCardOwner.
	
	"self halt."
	
	resp := WebClient htmlSubmit: (self url, '/checkOutCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^decodedResult]
		ifFalse: [^self error: resp content].
	
	
	! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:28:44' prior: 50955684!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError | | encodedError |
			encodedError := '1|', anError messageText.
			request send400Response: ('')]
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:28:57' prior: 50955840!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError | | encodedError |
			encodedError := '1|', anError messageText.
			request send400Response: (encodedError)]
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:29:39' prior: 50955852!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError | | encodedError |
			encodedError := WebUtils jsonEncode: ('1|', anError messageText).
			request send400Response: (encodedError)]
		].! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:30:06' prior: 50955796!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:30:37' prior: 50955878!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:30:51' prior: 50955907!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	self halt.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

WebUtils jsonDecode: ((self content) readStream)!
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:33:13' prior: 50955865!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError | | encodedError |
			encodedError := WebUtils jsonEncode: ('1|', anError messageText).
			request send400Response: encodedError]
		].! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:34:59' prior: 50955927!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: (WebUtils jsonDecode: ((resp content) readStream))].
	
	! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:36:21' prior: 50955966!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: '1|', anError messageText]
		].! !
!LibrosServer methodsFor: 'private' stamp: 'G.L.S 7/8/2021 15:36:31' prior: 50955999!
addInterfaceService: aServiceName withAction: anActionBlock

	webServer addService: aServiceName action: [ 
		:request |
		[anActionBlock value: request]
		on: Error
		do:[ :anError |
			request send400Response: '1|#', anError messageText, '#'].
		].! !
!LibrosRestInterface methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:36:47' prior: 50955979!
sendCreateCartRequestFor: aUsername withPassword: aPassword

	| fieldsDict resp |
	fieldsDict := Dictionary new.
	fieldsDict at: 'clientId' put: aUsername.
	fieldsDict at: 'password' put: aPassword.
	
	resp := WebClient htmlSubmit: (self url, '/createCart') fields: fieldsDict.
	
	resp isSuccess
		ifTrue: [ |decodedResult|
			decodedResult := WebUtils jsonDecode: ((resp content) readStream).
			^(decodedResult copyFrom: 3 to: decodedResult size) asNumber.]
		ifFalse: [^self error: resp content].
	
	! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

'123123213214124124214 #cosa # 123123123213' copyAfter: $#.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:38:39' prior: 50955660!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error | | messageToDecode |
		messageToDecode := error messageText.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

('123123213214124124214 #cosa # 123123123213' copyAfter: $#) copyUpTo: $#!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:40:47' prior: 50956047!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error | | messageToDecode |
		messageToDecode := error messageText.
		errorMessage := messageToDecode copyUpTo: $#.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:41:59' prior: 50956063!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error | | messageToDecode |
		messageToDecode := error messageText copyAfter: $#.
		errorMessage := messageToDecode copyUpTo: $#.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:42:21' prior: 50955606!
initializeWith: anErrorDescription withModel: aModel 
	
	description := aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:42:41'!
withModel: aModel 
	
	description := aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:42:41' prior: 50955535!
contents: anErrorDescription withModel: aModel 

	^self new withModel: aModel.! !

!methodRemoval: LibrosClientErrorWindow #initializeWith:withModel: stamp: 'G.L.S 7/8/2021 15:42:41'!
initializeWith: anErrorDescription withModel: aModel 
	
	description := aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----SNAPSHOT----(8 July 2021 15:42:54) CuisUniversity-4532.image priorSource: 19942760!
!LibrosClientErrorWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 15:43:06' prior: 50956111!
withModel: aModel 
	
	description := aModel errorMessage.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'ERROR'.
	self buildMorphicWindow.
	self openInWorld.! !

LibrosClientLoginWindow open.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer destroy.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:44:33' prior: 50956084!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error | 
		self registerErrorMessage.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:45:00'!
registerErrorMessage: anError
	
	| messageToDecode |
	
	messageToDecode := anError messageText copyAfter: $#.
	errorMessage := messageToDecode copyUpTo: $#.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:45:10' prior: 50956160!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [:error | 
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:45:33' prior: 50953028!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [ :error |
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:46:10' prior: 50954672!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [ :error | 
		self registerErrorMessage: error.
		self triggerEvent: #checkoutFailed with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:46:38' prior: 50948868!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [ :error |
		self registerErrorMessage: error.
		self triggerEvent: #listCartFailed with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:46:53' prior: 50948802!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:47:04' prior: 50956258!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:47:10' prior: 50956281!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:47:30' prior: 50956306!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #amountCalculationError with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:48:05' prior: 50949631!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:48:22' prior: 50956358!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:48:31' prior: 50956181!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [	:error | 
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 15:50:52' prior: 50864711!
errorCannotCheckoutEmptyCart
	^'Error - No se puede hacer checkout de un carrito vacio'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 15:50:57' prior: 50865305!
errorCannotCheckoutACartWithADifferentCatalog
	^'Error - No se puede hacer checkout de un carrito con un catalogo diferente'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 15:51:01' prior: 50868528!
errorCardDoesNotHaveEnoughBalance

	^'Error - La tarjeta de credito no tiene suficiente saldo'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 15:51:06' prior: 50866331!
errorExpiredCard
	^'Error - No se puede hacer checkout con una tarjeta de credito vacía'.! !
!Cashier class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 15:51:14' prior: 50867637!
errorStolenCard
	^'Error - No se puede realizar una transaccion con una tarjeta robada'.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:53:17' prior: 50956332!
addSelectedItemToCart
	
	| amount isbn |
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:53:38' prior: 50956382!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:53:55' prior: 50956490!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #isbnCalculationError  with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 15:55:30' prior: 50956518!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !

----SNAPSHOT----(8 July 2021 15:56:19) CuisUniversity-4532.image priorSource: 19983762!
!StoreObjectFactory methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 15:56:50' prior: 50925033!
createDefaultUserData
	
	| userData |
	
	userData := Dictionary new.
	userData add: 'pepe' -> '5678'.
	userData add: 'ramon' -> '1234'.
	
	^ userData.! !

librosServer destroy.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----SNAPSHOT----(8 July 2021 16:00:04) CuisUniversity-4532.image priorSource: 19997901!

----SNAPSHOT----(8 July 2021 16:01:38) CuisUniversity-4532.image priorSource: 19998371!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:09:19' prior: 50956462!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := #No.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:09:29' prior: 50956606!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := #No.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		huboError := #Si.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError with: self].
	
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:10:15' prior: 50956635!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		huboError := true.
		self triggerEvent: #isbnCalculationError with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		huboError := true.
		self triggerEvent: #amountCalculationError with: self].
	
	huboError ifFalse: [
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	].
	
	self triggerEvent: #itemAddedToCart with: self.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'error windows' stamp: 'G.L.S 7/8/2021 16:11:54' prior: 50955486!
showISBNCalculationError
	LibrosClientErrorWindow withModel: self model.! !
!LibrosClientErrorWindow class methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 16:12:23'!
withModel: aModel 

	^self new withModel: aModel.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 16:12:23' prior: 50955477!
showAmountCalculationError
	LibrosClientErrorWindow withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 16:12:24' prior: 50955495!
showAddToCartError
	LibrosClientErrorWindow withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 16:12:24' prior: 50955503!
showCheckoutError
	
	LibrosClientErrorWindow withModel: self model.
	
	
	! !
!LibrosClientLoginWindow methodsFor: 'as yet unclassified' stamp: 'G.L.S 7/8/2021 16:12:24' prior: 50955511!
showCredentialError
	
	LibrosClientErrorWindow withModel: self model.! !

!methodRemoval: LibrosClientErrorWindow class #contents:withModel: stamp: 'G.L.S 7/8/2021 16:12:24'!
contents: anErrorDescription withModel: aModel 

	^self new withModel: aModel.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientCartWindow methodsFor: 'error windows' stamp: 'G.L.S 7/8/2021 16:13:37'!
showError
	LibrosClientErrorWindow withModel: self model.! !
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 16:14:57' prior: 50954825!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	"self model when: #addItemToCartFailed send: #showAddToCartError to: self.
	self model when: #amountCalculationError send: #showAmountCalculationError to: self.
	self model when: #isbnCalculationError send: #showISBNCalculationError to: self."
	
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	"self model when: #removeItemFromCartFailed send: #showRemoveFromCartError to: self."
	
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	"self model when: #checkoutFailed send: #showCheckoutError to: self."
	
	self model when: #lougout send: #returnToLogin to: self.
	
	self model when: #errorHappened send: #showError to: self.
	
	self refreshCartList.
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:15:51' prior: 50956664!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		huboError := true.
		"self triggerEvent: #isbnCalculationError with: self"
		self triggerEvent: #errorHappened with: self.].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		huboError := true.
		self triggerEvent: #amountCalculationError with: self.
		self triggerEvent: #errorHappened with: self].
	
	huboError ifFalse: [
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		^self].
	].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:15:56' prior: 50956789!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		huboError := true.
		"self triggerEvent: #isbnCalculationError with: self"
		self triggerEvent: #errorHappened with: self.].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		huboError := true.
		self triggerEvent: #amountCalculationError with: self.
		self triggerEvent: #errorHappened with: self].
	
	huboError ifFalse: [
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		self triggerEvent: #addItemToCartFailed with: self.
		self triggerEvent: #errorHappened with: self.
		^self].
	].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:05' prior: 50956823!
addSelectedItemToCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((storeItemList at: storeItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro'.
		huboError := true.
		"self triggerEvent: #isbnCalculationError with: self"
		self triggerEvent: #errorHappened with: self.].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		huboError := true.
		"self triggerEvent: #amountCalculationError with: self."
		self triggerEvent: #errorHappened with: self].
	
	huboError ifFalse: [
	[restInterface sendAddToCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [:error |
		self registerErrorMessage: error.
		"self triggerEvent: #addItemToCartFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	].
	
	self triggerEvent: #itemAddedToCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:14' prior: 50956214!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [ :error | 
		self registerErrorMessage: error.
		"self triggerEvent: #checkoutFailed with: self."
		self triggerEvent: #errorHappened with: self
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:24' prior: 50956245!
listCart

	| listToDecode |
	
	[listToDecode := restInterface sendListCartFor: cartId]
	on: Error - MessageNotUnderstood
	do: [ :error |
		self registerErrorMessage: error.
		"self triggerEvent: #listCartFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	
	cartItemList := self decodeCartItemsList: listToDecode.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:38' prior: 50956557!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		"self triggerEvent: #isbnCalculationError with: self."
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #amountCalculationError  with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:44' prior: 50956941!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		"self triggerEvent: #isbnCalculationError with: self."
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		"self triggerEvent: #amountCalculationError  with: self."
		self triggerEvent: #errorHappened with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #removeItemFromCartFailed with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:16:52' prior: 50956971!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		"self triggerEvent: #isbnCalculationError with: self."
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		"self triggerEvent: #amountCalculationError  with: self."
		self triggerEvent: #errorHappened with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		"self triggerEvent: #removeItemFromCartFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:18:29' prior: 50956409!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [	:error | 
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		self triggerEvent: #errorHappened with: self
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:18:30' prior: 50957036!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [	:error | 
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		self triggerEvent: #errorHappened with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:18:35' prior: 50956194!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [ :error |
		self registerErrorMessage: error.
		self triggerEvent: #userCredentialsFailed with: self.
		self triggerEvent: #errorHappened with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:18:38' prior: 50957066!
tryToListPurchasesWithUserCredentials
	
	| listToDecode |
	
	[listToDecode := restInterface sendListPurchasesRequestFor: username withPassword: userpassword]
	on: Error
	do: [ :error |
		self registerErrorMessage: error.
		"self triggerEvent: #userCredentialsFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	
	listToDecode := self decodePurchaseList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	self updateTotalAmount: (listToDecode at: listToDecode size).
	
	self triggerEvent: #successfullyListedPurchases with: self.
	
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:18:44' prior: 50957051!
tryToCreateCartWithUserCredentials
	
	[cartId := restInterface sendCreateCartRequestFor: username withPassword: userpassword]
	on: Error
	do: [	:error | 
		self registerErrorMessage: error.
		"self triggerEvent: #userCredentialsFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	
	self triggerEvent: #successfullyCreatedCart with: self.
	
	! !
!LibrosClientLoginWindow methodsFor: 'windows' stamp: 'G.L.S 7/8/2021 16:19:04'!
showError
	
	LibrosClientErrorWindow withModel: self model.! !
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 16:19:20' prior: 50943586!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	"self model when: #userCredentialsFailed send: #showCredentialError to: self."
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	self model when: #successfullyListedPurchases send: #showPurchasesWindow to: self.
	
	self model when: #errorHappened send: #showError to: self.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientLoginWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 16:19:54' prior: 50957131!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LibrosClientModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #successfullyCreatedCart send: #showCartWindow to: self.
	self model when: #successfullyListedPurchases send: #showPurchasesWindow to: self.
	
	self model when: #errorHappened send: #showError to: self.! !

!methodRemoval: LibrosClientLoginWindow #showCredentialError stamp: 'G.L.S 7/8/2021 16:19:59'!
showCredentialError
	
	LibrosClientErrorWindow withModel: self model.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

!methodRemoval: LibrosClientCartWindow #showAddToCartError stamp: 'G.L.S 7/8/2021 16:20:36'!
showAddToCartError
	LibrosClientErrorWindow withModel: self model.!

!methodRemoval: LibrosClientCartWindow #showAmountCalculationError stamp: 'G.L.S 7/8/2021 16:20:42'!
showAmountCalculationError
	LibrosClientErrorWindow withModel: self model.!

!methodRemoval: LibrosClientCartWindow #showCheckoutError stamp: 'G.L.S 7/8/2021 16:20:46'!
showCheckoutError
	
	LibrosClientErrorWindow withModel: self model.
	
	
	!

!methodRemoval: LibrosClientCartWindow #showISBNCalculationError stamp: 'G.L.S 7/8/2021 16:20:49'!
showISBNCalculationError
	LibrosClientErrorWindow withModel: self model.!
!LibrosClientCartWindow methodsFor: 'initialization' stamp: 'G.L.S 7/8/2021 16:21:24' prior: 50956753!
initializeWith: aModel

	self titleMorph showButtonsNamed: #( close collapse ).
	self model: aModel.
	self setLabel: 'Gestion de carrito'.
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #logout send: #returnToLogin to: self.
	
	self model when: #itemAddedToCart send: #refreshCartList to: self.
	self model when: #itemRemovedFromCart send: #refreshCartList to: self.
	self model when: #checkoutSuccessful send: #showCheckoutTicket to: self.
	self model when: #lougout send: #returnToLogin to: self.
	
	self model when: #errorHappened send: #showError to: self.
	
	self refreshCartList.
	! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:21:57' prior: 50957003!
removeSelectedItemFromCart
	
	| amount isbn |
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #errorHappened with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #errorHappened with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:22:05' prior: 50957231!
removeSelectedItemFromCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #errorHappened with: self].
	
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #errorHappened with: self.
		^self].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:22:30' prior: 50957259!
removeSelectedItemFromCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #errorHappened with: self].
	
	huboError ifFalse: [
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #errorHappened with: self.
		^self]
	].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:22:49' prior: 50957288!
removeSelectedItemFromCart
	
	| amount isbn huboError |
	
	huboError := false.
	
	[isbn := ((cartItemList at: cartItemListIndex) copyUpTo: $-) withoutSeparators.]
	on: Error
	do: [	:error |
		errorMessage := 'Error - No ha seleccionado un libro del carrito'.
		self triggerEvent: #errorHappened with: self].
	
	[amount := (itemAmount = '') ifTrue:[1] ifFalse:[itemAmount asNumber].]
	on: Error
	do: [	:error |
		errorMessage := 'Error - La cantidad de libros no es un numero'.
		self triggerEvent: #errorHappened with: self].
	
	huboError ifFalse: [
	[restInterface sendRemoveFromCartRequestWithCart: cartId bookISBN: isbn amount: amount]
	on: Error - MessageNotUnderstood
	do: [	:error |
		self registerErrorMessage: error.
		self triggerEvent: #errorHappened with: self.
		^self]
	].
	
	self triggerEvent: #itemRemovedFromCart with: self.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

----SNAPSHOT----(8 July 2021 16:26:22) CuisUniversity-4532.image priorSource: 19998460!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosServer allInstances do:[ :instance | instance destroy].!

LibrosClientLoginWindow open.!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!
!Cart class methodsFor: 'errors' stamp: 'G.L.S 7/8/2021 16:36:19' prior: 50945758!
errorCannotRemoveAnItemNotInCart
	^'Error - No se puede remover ese item, no esta dentro del carrito'.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:41:43' prior: 50956895!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [ :error | 
		self registerErrorMessage: error.
		"self triggerEvent: #checkoutFailed with: self."
		self triggerEvent: #errorHappened with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !
!LibrosClientModel methodsFor: 'requests' stamp: 'G.L.S 7/8/2021 16:46:05' prior: 50957403!
checkoutCart
	
	| listToDecode |
	
	[listToDecode := restInterface sendCheckOutRequestFor: cartId asString
							creditCardNumber: storeFactory createDefaultCreditCardNumber
							creditCardExpiration: storeFactory createDefaultCreditCardExpirationDate 
							creditCardOwner: storeFactory createDefaultCreditCardOwner]
	on: Error - MessageNotUnderstood
	do: [ :error | 
		self registerErrorMessage: error.
		self triggerEvent: #errorHappened with: self.
		^self].
	
	listToDecode := 	listToDecode copyFrom: 3 to: listToDecode size - 1.
	
	transactionId := listToDecode copyUpTo: $|.
	
	listToDecode := listToDecode copyAfter: $|.
	
	listToDecode := self decodeTicketCartList: listToDecode.
	
	purchases := listToDecode copyFrom: 1 to: listToDecode size - 1.
	
	totalAmount  := listToDecode at: listToDecode size.
	
	self triggerEvent: #checkoutSuccessful with: self.! !

librosServer destroy.!

LibrosServer allInstances do:[ :instance | instance destroy].!

librosServer := LibrosServer listeningOn: 8080.!

LibrosClientLoginWindow open.!

----SNAPSHOT----(8 July 2021 16:48:34) CuisUniversity-4532.image priorSource: 20022541!